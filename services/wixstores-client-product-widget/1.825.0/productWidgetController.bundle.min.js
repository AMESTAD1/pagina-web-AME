!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("lodash")):"function"==typeof define&&define.amd?define(["lodash"],e):"object"==typeof exports?exports.productWidgetController=e(require("lodash")):t.productWidgetController=e(t._)}("undefined"!=typeof self?self:this,(function(t){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="https://static.parastorage.com/services/wixstores-client-product-widget/1.825.0/",r(r.s=35)}({0:function(t,e,r){"use strict";r.r(e),r.d(e,"__extends",(function(){return i})),r.d(e,"__assign",(function(){return o})),r.d(e,"__rest",(function(){return a})),r.d(e,"__decorate",(function(){return s})),r.d(e,"__param",(function(){return u})),r.d(e,"__metadata",(function(){return c})),r.d(e,"__awaiter",(function(){return d})),r.d(e,"__generator",(function(){return l})),r.d(e,"__createBinding",(function(){return f})),r.d(e,"__exportStar",(function(){return p})),r.d(e,"__values",(function(){return g})),r.d(e,"__read",(function(){return h})),r.d(e,"__spread",(function(){return b})),r.d(e,"__spreadArrays",(function(){return _})),r.d(e,"__await",(function(){return v})),r.d(e,"__asyncGenerator",(function(){return S})),r.d(e,"__asyncDelegator",(function(){return T})),r.d(e,"__asyncValues",(function(){return y})),r.d(e,"__makeTemplateObject",(function(){return O})),r.d(e,"__importStar",(function(){return m})),r.d(e,"__importDefault",(function(){return P})),r.d(e,"__classPrivateFieldGet",(function(){return E})),r.d(e,"__classPrivateFieldSet",(function(){return I}));var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function i(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var o=function(){return(o=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function a(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]])}return r}function s(t,e,r,n){var i,o=arguments.length,a=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,r,a):i(e,r))||a);return o>3&&a&&Object.defineProperty(e,r,a),a}function u(t,e){return function(r,n){e(r,n,t)}}function c(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function d(t,e,r,n){return new(r||(r=Promise))((function(i,o){function a(t){try{u(n.next(t))}catch(t){o(t)}}function s(t){try{u(n.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))}function l(t,e){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function f(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}function p(t,e){for(var r in t)"default"===r||e.hasOwnProperty(r)||(e[r]=t[r])}function g(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function h(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a}function b(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(h(arguments[e]));return t}function _(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<r;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)n[i]=o[a];return n}function v(t){return this instanceof v?(this.v=t,this):new v(t)}function S(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(t,e||[]),o=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(t){i[t]&&(n[t]=function(e){return new Promise((function(r,n){o.push([t,e,r,n])>1||s(t,e)}))})}function s(t,e){try{(r=i[t](e)).value instanceof v?Promise.resolve(r.value.v).then(u,c):d(o[0][2],r)}catch(t){d(o[0][3],t)}var r}function u(t){s("next",t)}function c(t){s("throw",t)}function d(t,e){t(e),o.shift(),o.length&&s(o[0][0],o[0][1])}}function T(t){var e,r;return e={},n("next"),n("throw",(function(t){throw t})),n("return"),e[Symbol.iterator]=function(){return this},e;function n(n,i){e[n]=t[n]?function(e){return(r=!r)?{value:v(t[n](e)),done:"return"===n}:i?i(e):e}:i}}function y(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,r=t[Symbol.asyncIterator];return r?r.call(t):(t=g(t),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(r){e[r]=t[r]&&function(e){return new Promise((function(n,i){(function(t,e,r,n){Promise.resolve(n).then((function(e){t({value:e,done:r})}),e)})(n,i,(e=t[r](e)).done,e.value)}))}}}function O(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function m(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function P(t){return t&&t.__esModule?t:{default:t}}function E(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function I(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}},11:function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r(0),i=function(t){function e(e,r){var n=t.call(this,e)||this;return n.data=r,n.name="FetchError",n}return Object(n.__extends)(e,t),e}(Error)},12:function(t,e,r){"use strict";r.d(e,"a",(function(){return i})),r.d(e,"b",(function(){return o})),r.d(e,"c",(function(){return a}));var n=r(11);function i(t){return fetch(t,{method:"get"}).then((function(t){return t.json()})).catch((function(e){throw new n.a("Could not fetch translation",{originalError:e.message,path:t})}))}function o(){return"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope}function a(t){return t.replace(/(\r\n|\n|\r)/g,"").replace(/ +(?= )/g,"").replace(/: /g,":").replace(/, \$/g,",$").replace(/\{ /g,"{").replace(/ {/g,"{").replace(/ }/g,"}").replace(/} /g,"}").replace(/, /g,",").replace(/ /g,",")}},13:function(t,e,r){"use strict";var n,i,o,a;r.d(e,"b",(function(){return n})),r.d(e,"a",(function(){return i})),function(t){t.URL_CUSTOMIZE="specs.stores.EnableUrlCustomizeInProductPage",t.USE_LIGHTBOXES="specs.stores.UseLightboxes",t.TRACK_ADD_TO_CART_EVENT_IN_SDK="specs.stores.TrackAddToCartActionInSdk"}(n||(n={})),function(t){t.SITE="site",t.PREVIEW="preview",t.EDITOR="editor"}(i||(i={})),function(t){t.COLOR="color",t.LIST="list"}(o||(o={})),function(t){t.CHECKED="checked",t.UNCHECKED="unchecked"}(a||(a={}))},19:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getStyleParamsWithDefaults=void 0;var n=r(3);e.getStyleParamsWithDefaults=function(t,e){var r=e(),i=r.defaults,o=r.overrides;return n.defaultsDeep(n.merge(n.cloneDeep(t),o),i)}},2:function(t,e,r){"use strict";r.d(e,"a",(function(){return f})),r.d(e,"m",(function(){return n})),r.d(e,"n",(function(){return i})),r.d(e,"c",(function(){return o})),r.d(e,"j",(function(){return s})),r.d(e,"g",(function(){return u})),r.d(e,"d",(function(){return d})),r.d(e,"f",(function(){return g})),r.d(e,"i",(function(){return h})),r.d(e,"e",(function(){return b})),r.d(e,"o",(function(){return _})),r.d(e,"k",(function(){return v})),r.d(e,"b",(function(){return S})),r.d(e,"h",(function(){return T})),r.d(e,"l",(function(){return p}));var n,i,o,a,s,u,c,d,l,f="1380b703-ce81-ff05-f115-39571d94dfcd";!function(t){t.CART_ICON="1380bbc4-1485-9d44-4616-92e36b1ead6b",t.PRODUCT_PAGE="13a94f09-2766-3c40-4a32-8edb5acdd8bc",t.PRODUCT_WIDGET="13ec3e79-e668-cc0c-2d48-e99d53a213dd",t.GALLERY_PAGE="1380bba0-253e-a800-a235-88821cf3f8a4",t.GRID_GALLERY="13afb094-84f9-739f-44fd-78d036adb028",t.SLIDER_GALLERY="139a41fd-0b1d-975f-6f67-e8cbdf8ccc82",t.THANK_YOU_PAGE="1380bbb4-8df0-fd38-a235-88821cf3f8a4",t.ADD_TO_CART="14666402-0bc7-b763-e875-e99840d131bd",t.WISHLIST_PAGE="a63a5215-8aa6-42af-96b1-583bfd74cff5",t.CART="1380bbab-4da3-36b0-efb4-2e0599971d14"}(n||(n={})),function(t){t.CART_COMMANDS_URL="/_api/wix-ecommerce-renderer-web/store-front/cart/{commandName}",t.READ_WRITE_GRAPHQL_URL="_api/wix-ecommerce-graphql-web/api",t.STOREFRONT_GRAPHQL_URL="_api/wix-ecommerce-storefront-web/api",t.WISHLIST_BASE_URL="/_api/wishlist-server"}(i||(i={})),function(t){t[t.MINI_CART=1]="MINI_CART",t[t.CART=2]="CART",t[t.NONE=3]="NONE"}(o||(o={})),function(t){t[t.IDLE=0]="IDLE",t[t.SUCCESSFUL=1]="SUCCESSFUL",t[t.FAILED=2]="FAILED"}(a||(a={})),function(t){t.CART="shopping_cart",t.CHECKOUT="checkout",t.GALLERY="product_gallery",t.THANKYOU="thank_you_page",t.PRODUCT="product_page",t.ORDER_HISTORY="order_history",t.WISHLIST="wishlist"}(s||(s={})),function(t){t.GET_CONFIG="getConfig",t.MULTI_LANG="multiLang",t.MINICART_OPEN="miniCartOpen"}(u||(u={})),function(t){t.RELATED_PRODUCTS="relatedProductIds"}(c||(c={})),function(t){t.AddToCart="add to cart",t.BuyNow="buy now",t.Subscribe="subscribe"}(d||(d={})),function(t){t.USE_LIGHTBOXES="specs.stores.UseLightboxes"}(l||(l={}));var p,g="x-wix-currency",h="x-wix-linguist",b="X-XSRF-TOKEN",_="https://8bc29fb6cd064a49a9945743de020bf2@sentry.io/1186457",v="wixstores-pagination-map",S="https://settings.parastorage.com",T="https://ecom.wix.com/storefront/cartwidgetPopup";!function(t){t.PRODUCT_PAGE="wix.stores.sub_pages.product"}(p||(p={}))},20:function(t,e,r){"use strict";r.d(e,"a",(function(){return o}));var n=r(0),i=r(2),o=function(){function t(t){this.buildCustomizedUrl=t}return t.prototype.init=function(){return Object(n.__awaiter)(this,void 0,void 0,(function(){var t,e,r,o;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return t=/abc/g,e="{stub}",r={pathPrefix:"product-page"},[4,this.buildCustomizedUrl(i.l.PRODUCT_PAGE,{slug:"abc"},r)];case 1:return(o=n.sent())?(this.stub=o.replace(t,e),[2,!0]):[2,!1]}}))}))},t.prototype.buildProductPageUrl=function(t){return this.getProductWithStub(t)},t.prototype.getProductWithStub=function(t){if(this.stub)return this.stub.replace(/{stub}/g,t.slug);throw new Error("init CustomUrlApi wasn`t called")},t}()},3:function(e,r){e.exports=t},33:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MultilingualService=void 0;var n=r(70),i=function(){function t(t,e,r,n){void 0===t&&(t={}),this.publicData=t,this.widgetSettings=e,this.multiLangFields=r,this.defaultLocale=n,r?(this.isPrimaryLanguage=this.multiLangFields.isPrimaryLanguage,this.lang=this.multiLangFields.lang):(this.isPrimaryLanguage=!0,this.lang=this.defaultLocale)}return t.prototype.get=function(t){if(this.isPrimaryLanguage)return this.publicData[t];var e=this.widgetSettings[n.getLocaleNamespace(this.lang)];return null==e?void 0:e[t]},t.prototype.getAll=function(){return this.isPrimaryLanguage?this.publicData:this.widgetSettings[n.getLocaleNamespace(this.lang)]},t.prototype.setWidgetSettings=function(t){this.widgetSettings=t},t.prototype.setPublicData=function(t){this.publicData=t},t}();e.MultilingualService=i},35:function(t,e,r){"use strict";r.r(e),r.d(e,"productWidgetController",(function(){return C}));var n,i,o,a=r(0),s=r(12),u=r(8),c=r(2),d=function(){function t(t){this.siteStore=t}return t.prototype.getData=function(t,e){return Object(a.__awaiter)(this,void 0,Promise,(function(){var r;return Object(a.__generator)(this,(function(n){return r={query:"query getData($externalId: String!, $compid: String!) {\n  appSettings(externalId: $externalId) {\n    widgetSettings\n  }\n  catalog {\n    product(compId: $compid, onlyVisible: true) {\n      id\n      name\n      urlPart\n      price\n      comparePrice\n      formattedPrice\n      formattedComparePrice\n      discount {\n        mode\n        value\n      }\n      hasOptions\n      media {\n        id\n        url\n        mediaType\n        width\n        height\n        index\n      }\n      ribbon\n      isInStock\n      productType\n      digitalProductFileItems {\n        fileType\n      }\n      productType\n      subscriptionPlans {\n        list {\n           id\n           visible\n        }\n      }\n    }\n  }\n}",source:"WixStoresWebClient",variables:{externalId:t,compid:e},operationName:"getProductWidgetData"},[2,this.siteStore.tryGetGqlAndFallbackToPost(this.siteStore.resolveAbsoluteUrl("/"+c.n.STOREFRONT_GRAPHQL_URL),r)]}))}))},t}(),l=r(33),f=r(13),p=function(){function t(t){this.siteStore=t}return t.prototype.getQuickViewUrl=function(t){var e=t.externalId,r=t.instance,n=t.origin,i=t.urlPart,o=t.selectionIds,a=t.quantity,s="https://ecom.wix.com/storefront/product/"+i,u={layout:"quickview",origin:n,instance:r};return e&&(u.externalId=e),(null==o?void 0:o.length)&&(u.selectionIds=encodeURIComponent(o.join(","))),a&&a>1&&(u.quantity=a.toString()),s+"?"+Object.keys(u).map((function(t){return t+"="+u[t]})).join("&")},t.prototype.openQuickViewLightbox=function(t){return this.siteStore.windowApis.openLightbox("Quick View",{productSlug:t})},t.prototype.quickViewProduct=function(t,e,r,n,i,o,a){if(this.siteStore.isMobile())return this.siteStore.navigate({sectionId:c.j.PRODUCT,state:r,queryParams:void 0},!0);var s=this.getQuickViewUrl({externalId:i,instance:this.siteStore.instanceManager.getInstance(),origin:e,urlPart:r,selectionIds:o,quantity:a});return this.siteStore.experiments.enabled(f.b.USE_LIGHTBOXES)?this.openQuickViewLightbox(r):this.siteStore.windowApis.openModal(s,{width:940,height:660,theme:"BARE"},n)},t}(),g=r(3),h={defaultQuantitiesRange:Object(g.range)(1,1e5),getQuantitiesRange:function(t,e){return void 0===e&&(e=[]),t.isManageProductItems?h.getFromUserSelections(t,e):h.getFromProduct(t)},getFromProduct:function(t){var e=h.defaultQuantitiesRange;return t.isTrackingInventory?e=Object(g.range)(1,t.inventory.quantity+1):"out_of_stock"===t.inventory.status&&(e=[]),e},getFromUserSelections:function(t,e){var r=h.defaultQuantitiesRange,n=h.getVariantsRepresentation(t,e);return n&&(t.isTrackingInventory?r=Object(g.range)(1,n.inventory.quantity+1):"out_of_stock"===n.inventory.status&&(r=[])),r},getVariantsRepresentation:function(t,e){var r;if(t.isManageProductItems&&t.productItems&&!Object(g.includes)(e,null)){var n=e.map((function(t){return t.id}));r=t.productItems.filter((function(t){return Object(g.isEqual)(t.optionsSelections,n)}))[0]}return r}};function b(t,e){return _(t)?(null==e?void 0:e.comparePrice)||t.comparePrice:(null==e?void 0:e.price)||t.price}function _(t){var e;return(null===(e=t.discount)||void 0===e?void 0:e.value)>0}function v(t,e){return(null==e?void 0:e.sku)||t.sku}!function(t){t.DIGITAL="digital",t.PHYSICAL="physical"}(n||(n={})),function(t){t.OUT_OF_STOCK="out_of_stock",t.IN_STOCK="in_stock"}(i||(i={})),function(t){t.SECURE_PICTURE="secure_picture",t.SECURE_VIDEO="secure_video",t.SECURE_DOCUMENT="secure_document",t.SECURE_MUSIC="secure_music",t.SECURE_ARCHIVE="secure_archive"}(o||(o={}));var S,T=function(){function t(t,e,r,n){this.siteStore=t,this.compId=e,this.externalId=r,this.fedopsLogger=n,this.productActions=new p(this.siteStore)}return t.prototype.trackAddToCartBI=function(t){return Object(a.__awaiter)(this,void 0,void 0,(function(){var e;return Object(a.__generator)(this,(function(r){return e={buttonType:c.d.AddToCart,appName:"productWidgetApp",hasOptions:!1,productId:t.id,isNavigateCart:this.siteStore.cartActions.shouldNavigateToCart(),navigationClick:this.siteStore.cartActions.shouldNavigateToCart()?"cart":"mini-cart",productType:t.productType,origin:u.d},[2,this.siteStore.biLogger.clickOnAddToCartSf(e)]}))}))},t.prototype.hasSubscriptions=function(t){return function(t){var e;return(null===(e=t.subscriptionPlans)||void 0===e?void 0:e.list.filter((function(t){return!0===t.visible})).length)>0}(t)},t.prototype.storeNavigationHistory=function(){var t={pageId:this.siteStore.siteApis.currentPage.id,paginationMap:[]};this.siteStore.storage.local.setItem(c.k,JSON.stringify(t))},t.prototype.trackParams=function(t){return{id:t.id,name:t.name,price:b(t),sku:v(t),type:t.productType}},t.prototype.handleClick=function(t,e){var r=this;return e?(this.storeNavigationHistory(),this.siteStore.navigate({sectionId:c.j.PRODUCT,state:t.urlPart,queryParams:void 0},!0)):t.hasOptions||this.hasSubscriptions(t)?(this.siteStore.biLogger.clickAddToCartWithOptionsSf({appName:"productWidgetApp",origin:u.d,hasOptions:!0,productId:t.id,productType:t.productType,navigationClick:this.siteStore.isMobile()?"product-page":"quick-view"}),this.productActions.quickViewProduct(t.id,"productwidget",t.urlPart,this.compId,this.externalId)):(this.trackAddToCartBI(t),this.fedopsLogger.interactionStarted("add-to-cart"),this.siteStore.cartActions.addToCart(t.id,void 0,1,void 0,c.c.MINI_CART,u.d,(function(){r.fedopsLogger.interactionEnded("add-to-cart")}),this.trackParams(t)))},t}(),y=r(7),O=r(4),m=r(11);!function(t){t.DISABLED="DISABLED",t.ENABLED="ENABLED",t.OUT_OF_STOCK="OUT_OF_STOCK"}(S||(S={}));var P="ALLOW_FREE_PRODUCTS",E=function(){function t(t,e){void 0===e&&(e={});var r=e.APP&&!1===e.APP[P];this.allowFreeProducts=!r}return t.prototype.getButtonState=function(t){var e=t.price;return t.inStock?0===e?this.allowFreeProducts?S.ENABLED:S.DISABLED:e<0?S.DISABLED:S.ENABLED:S.OUT_OF_STOCK},t}(),I=r(20),w=function(){function t(t,e,r,n,i,o,l){var f=this;this.styleParams=t,this.publicData=e,this.setProps=r,this.siteStore=n,this.externalId=i,this.compId=o,this.reportError=l,this.isStartReported=!1,this.isExternalRequestsValid=!0,this.isUrlWithOverrides=!1,this.onAppLoaded=function(){(!Object(s.b)()||f.siteStore.isInteractive()&&f.isStartReported)&&(f.fedopsLogger.appLoaded(f.getFedopsCustomParams()),f.siteStore.isSiteMode()&&f.reportBIOnAppLoaded()),f.isStartReported=!1},this.showButtonSetting=function(t){return!f.siteStore.isMobile()&&t.hoverButtonToggle?"hover":t.widgetButtonToggle?"always":"never"},this.handleAddToCart=function(){return Object(a.__awaiter)(f,void 0,Promise,(function(){var t,e=this;return Object(a.__generator)(this,(function(r){return t=this.siteStore.pubSubManager.subscribe("Minicart.DidClose",(function(){e.setProps({shouldFocusAddToCartButton:Math.random()}),e.siteStore.pubSubManager.unsubscribe("Minicart.DidClose",t)}),!0),[2,this.productService.handleClick(this.product,this.isActionNavigate())]}))}))},this.navigate=function(){return Object(a.__awaiter)(f,void 0,Promise,(function(){return Object(a.__generator)(this,(function(t){return[2,this.productService.handleClick(this.product,!0)]}))}))};var p=this.siteStore.platformServices.fedOpsLoggerFactory;this.fedopsLogger=p.getLoggerForWidget({appId:c.a,widgetId:c.m.PRODUCT_WIDGET}),Object(s.b)()&&(this.fedopsLogger.appLoadStarted(),this.isStartReported=!0),null!==this.publicData.COMPONENT&&void 0!==this.publicData.COMPONENT||(this.publicData.COMPONENT={}),this.productApi=new d(this.siteStore),this.productService=new T(n,o,i,this.fedopsLogger),this.addToCartService=new E(n,e),this.siteStore.experiments.enabled(u.c.URL_CUSTOMIZE)&&(this.customUrlApi=new I.a(this.siteStore.location.buildCustomizedUrl)),this.handleCurrencyChange()}return t.prototype.handleCurrencyChange=function(){var t=this,e=this.siteStore.location.query.currency;this.siteStore.location.onChange((function(){e!==t.siteStore.location.query.currency&&(e=t.siteStore.location.query.currency,t.setInitialState().catch(t.reportError))}))},t.prototype.getFedopsCustomParams=function(){var t=Object(y.a)(this.styleParams);return{customParams:JSON.stringify(this.product?{align_image:t.widgetDirection,align_text:t.alignment,image_resize:t.imageScaling,image_width:t.visualWidth.split("%")[0],is_stretch_to_full:t.fullWidth||null,is_zoom_on_hover:t.extendOnHoverToggle,on_click:this.isActionNavigate()?"navigate":"add-to-cart",on_hover:t.hoverState,product_guid:this.product.id,product_type:this.product.digitalProductFileItems.length?"digital":"physical",product_widget_type:this.getOrientation(),show_button:this.showButtonSetting(t),show_divider:t.separatorToggle,show_price:t.priceToggle,show_product_name:t.titleToggle,store_id:this.siteStore.storeId}:{product_guid:null,store_id:this.siteStore.storeId})}},t.prototype.isActionNavigate=function(){return this.styleParams.fonts.widgetAction.value===O.b.NAVIGATE||this.addToCartService.getButtonState({price:b(this.product),inStock:!0})===S.DISABLED},t.prototype.reportBIOnAppLoaded=function(){var t=Object(y.a)(this.styleParams),e={isMobileFriendly:this.siteStore.isMobileFriendly,testName:"product_widget_loaded",is_eligible:!0,type:JSON.stringify({orientation:this.getOrientation(),show_button:this.showButtonSetting(t),button:t.widgetAction,alignment:t.alignment,image_resize:t.imageScaling,show_title:t.titleToggle,show_price:t.priceToggle,show_divider:t.separatorToggle})};this.siteStore.biLogger.exposureEventForTests(e)},t.prototype.getOrientation=function(){return this.widgetPreset===O.f.HORIZONTAL?"horizontal":"vertical"},t.prototype.getTexts=function(){var t=this;return Object.keys(u.b).reduce((function(e,r){var n=u.b[r],i=t.multilingualService.get(n);return i&&(e[r]=i),e}),Object(a.__assign)({},this.translations))},t.prototype.getProductWidgetTranslations=function(){return Object(s.a)(Object(u.e)(this.siteStore.baseUrls.productWidgetBaseUrl,this.siteStore.locale))},t.prototype.getDefaultProps=function(){return{cssBaseUrl:this.siteStore.baseUrls.productWidgetBaseUrl,onAppLoaded:this.onAppLoaded,horizontalLayout:this.widgetPreset===O.f.HORIZONTAL&&!this.siteStore.isMobile(),isInteractive:this.siteStore.isInteractive(),widgetPreset:this.widgetPreset,isMobile:this.siteStore.isMobile(),experiments:{isEditableHeadingTags:this.siteStore.experiments.enabled(u.c.EDITABLE_HEADING_TAGS)},texts:this.getTexts(),htmlTags:this.getHtmlTags()}},t.prototype.getHtmlTags=function(){return{productNameHtmlTag:this.publicData.COMPONENT.nameHtmlTag||"h3"}},t.prototype.setEmptyStateProps=function(){this.setProps(Object(a.__assign)(Object(a.__assign)({},this.getDefaultProps()),{product:null,emptyState:!0}))},t.prototype.setInitialState=function(){var t;return Object(a.__awaiter)(this,void 0,Promise,(function(){var e,r,n,i,o,s,d,f,p,g=this;return Object(a.__generator)(this,(function(h){switch(h.label){case 0:return[4,Promise.all([this.getProductWidgetTranslations(),this.productApi.getData(this.externalId||"",this.compId),this.siteStore.getSectionUrl(c.j.PRODUCT)]).catch((function(t){g.reportError(t),g.isExternalRequestsValid=!1}))];case 1:return e=h.sent(),this.siteStore.experiments.enabled(u.c.URL_CUSTOMIZE)?(r=this,[4,this.customUrlApi.init()]):[3,3];case 2:r.isUrlWithOverrides=h.sent(),h.label=3;case 3:return this.isExternalRequestsValid?(n=Object(a.__read)(e,3),i=n[0],o=n[1],s=n[2].url,(d=o.data).appSettings||(f=new m.a("Got 200 from the server, but appSettings is undefined",{response:o,responseData:d}),this.reportError(f)),this.translations=i,this.multilingualService=new l.MultilingualService(this.publicData.COMPONENT||{},d.appSettings.widgetSettings,this.siteStore.getMultiLangFields(),this.siteStore.locale),this.product=null===(t=null==d?void 0:d.catalog)||void 0===t?void 0:t.product,this.product?(p=Object(a.__assign)(Object(a.__assign)({},this.getDefaultProps()),{emptyState:!1,handleAddToCart:this.handleAddToCart,hasDiscount:this.isDisabled?this.product.comparePrice>0:_(this.product),isDisabled:this.isDisabled,isSEO:this.siteStore.seo.isInSEO(),navigate:this.navigate,product:this.product,productPageUrl:this.product&&this.product.urlPart?this.getProductPageUrl(s,this.product.urlPart):"",ravenUserContextOverrides:{id:this.siteStore.storeId,uuid:this.siteStore.uuid},shouldFocusAddToCartButton:!1}),this.setProps(p),this.siteStore.isSSR()&&this.fedopsLogger.appLoaded(),[2]):(this.setEmptyStateProps(),[2])):[2]}}))}))},t.prototype.getProductPageUrl=function(t,e){return this.siteStore.experiments.enabled(u.c.URL_CUSTOMIZE)&&this.isUrlWithOverrides?this.customUrlApi.buildProductPageUrl({slug:e}):t+"/"+this.product.urlPart},Object.defineProperty(t.prototype,"isDisabled",{get:function(){return this.addToCartService.getButtonState({price:b(this.product),inStock:!0})===S.DISABLED},enumerable:!1,configurable:!0}),t.prototype.updatePublicData=function(t){var e=this;Object.keys(t.COMPONENT).forEach((function(r){e.publicData.COMPONENT[r]=t.COMPONENT[r]}))},t.prototype.updateState=function(t,e){this.updatePublicData(e),this.styleParams=t,this.multilingualService.setWidgetSettings(e.appSettings),this.setProps({texts:this.getTexts(),htmlTags:this.getHtmlTags()})},Object.defineProperty(t.prototype,"widgetPreset",{get:function(){return this.publicData.COMPONENT.presetId||O.f.VERTICAL},enumerable:!1,configurable:!0}),t}();function C(t){var e,r=t.context,n=t.config,i=t.compId,o=t.setProps,a=t.reportError,s=r.siteStore,u=n.style.styleParams,c=n.publicData,d=n.externalId,l=void 0===d?"":d,f=function(t){return Object(y.c)(t||u,{formFactor:s.formFactor,widgetPreset:c.COMPONENT&&c.COMPONENT.presetId})};return{pageReady:function(){return(e=new w(f(),c,o,s,l,i,a)).setInitialState().catch(a)},updateConfig:function(t,r){var n=r.style.styleParams,i=r.publicData;e.updateState(f(n),i)}}}},4:function(t,e,r){"use strict";var n,i,o,a,s,u;r.d(e,"b",(function(){return n})),r.d(e,"a",(function(){return i})),r.d(e,"e",(function(){return o})),r.d(e,"c",(function(){return a})),r.d(e,"f",(function(){return s})),r.d(e,"d",(function(){return u})),function(t){t.NAVIGATE="navigate",t.ADDTOCART="addToCart"}(n||(n={})),function(t){t.CROP="crop",t.FIT="fit"}(i||(i={})),function(t){t.LEFT="left",t.RIGHT="right"}(o||(o={})),function(t){t.LEFT="left",t.CENTER="center",t.RIGHT="right"}(a||(a={})),function(t){t.VERTICAL="Wix_Store_Product_Widget_Vertical",t.HORIZONTAL="Wix_Store_Product_Widget_Horizontal"}(s||(s={})),function(t){t.CONTENT="content",t.VISUAL="visual",t.ALL="all"}(u||(u={}))},7:function(t,e,r){"use strict";r.d(e,"c",(function(){return c})),r.d(e,"a",(function(){return l})),r.d(e,"b",(function(){return f}));var n=r(0),i=r(8),o=r(19),a=r(4),s=function(t){return t===i.a.Mobile},u=function(t){return{value:t,fontStyleParam:!1}};function c(t,e){var r=e.formFactor,n=e.widgetPreset;return Object(o.getStyleParamsWithDefaults)(t,(function(){return{defaults:(t={isMobile:s(r),orientation:n},{booleans:{titleToggle:!0,priceToggle:!0,separatorToggle:t.orientation===a.f.HORIZONTAL,extendOnHoverToggle:!0,extendOnHolidayToggle:!1,extendFullImageOnHoverToggle:!1,hoverButtonToggle:!t.isMobile&&t.orientation===a.f.VERTICAL,widgetButtonToggle:!(t.isMobile&&t.orientation===a.f.VERTICAL)},numbers:{hoverBackgroundColorOpacity:0,hoverBorderSize:0,actionButton_borderSize:0,actionButton_cornersRadius:0},fonts:{imageScaling:u(a.a.CROP),widgetAction:u(a.b.NAVIGATE),layout:u(""),alignment:u(t.orientation===a.f.HORIZONTAL?a.c.CENTER:a.c.LEFT),widgetDirection:u(a.e.LEFT),hoverArea:u(a.d.CONTENT),hoverBorderArea:u(a.d.CONTENT),hoverButtonArea:u(a.d.CONTENT),visualWidth:u("50%"),hoverState:u("zoom")}})};var t}))}var d=["alignment","widgetAction","imageScaling","visualWidth","widgetDirection","hoverArea","hoverBorderArea","hoverButtonArea","hoverState"];function l(t){var e,r,i=t.numbers,o=i.hoverBackgroundColorOpacity,a=i.hoverBorderSize,s=i.actionButton_cornersRadius,u=t.booleans,c=u.widgetButtonToggle,l=u.titleToggle,f=u.full_width,p=u.priceToggle,g=u.separatorToggle,h=u.hoverButtonToggle,b=u.extendOnHoverToggle,_=u.extendOnHolidayToggle,v=u.extendFullImageOnHoverToggle,S=(e=t.fonts,r={},d.forEach((function(t){r[t]=e[t].value})),{fonts:r}).fonts;return Object(n.__assign)(Object(n.__assign)({},S),{fullWidth:f,hoverBackgroundColorOpacity:o,hoverBorderSize:a,actionButton_cornersRadius:s,widgetButtonToggle:c,titleToggle:l,priceToggle:p,separatorToggle:g,hoverButtonToggle:h,extendOnHoverToggle:b,extendOnHolidayToggle:_,extendFullImageOnHoverToggle:v})}function f(t){return l(t.globals.style.styleParams)}},70:function(t,e,r){"use strict";r.r(e),r.d(e,"MULTILINGUAL_NAMESPACE",(function(){return n})),r.d(e,"getLocaleNamespace",(function(){return i}));var n="multilingual";function i(t){return n+"_"+t}},8:function(t,e,r){"use strict";r.d(e,"e",(function(){return i})),r.d(e,"a",(function(){return n})),r.d(e,"d",(function(){return a})),r.d(e,"c",(function(){return o})),r.d(e,"b",(function(){return u}));var n,i=function(t,e){return t+"assets/locale/productWidget/productWidget_"+e+".json"};!function(t){t.Desktop="Desktop",t.Mobile="Mobile",t.Tablet="Tablet"}(n||(n={}));var o,a="product-widget";!function(t){t.URL_CUSTOMIZE="specs.stores.EnableUrlCustomizeInProductPage",t.EDITABLE_HEADING_TAGS="specs.stores.EditableHeadingTags"}(o||(o={}));var s,u={NAVIGATE_TO_PRODUCT_PAGE_BUTTON:"PRODUCT_WIDGET_BUTTON_TEXT",ADD_TO_CART_BUTTON:"PRODUCT_WIDGET_BUTTON_TEXT",OUT_OF_STOCK:"PRODUCT_WIDGET_BUTTON_OOS_TEXT"};s||(s={})}})}));
//# sourceMappingURL=productWidgetController.bundle.min.js.map