!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("_")):"function"==typeof define&&define.amd?define("dbsm-viewer-app",["_"],t):"object"==typeof exports?exports["dbsm-viewer-app"]=t(require("_")):e["dbsm-viewer-app"]=t(e._)}("undefined"!=typeof self?self:this,(e=>(()=>{var t,r,n={9025:(e,t,r)=>{e.exports={ITEM_TYPES:r(8834).iB}},8834:(e,t)=>{"use strict";t.iB=t._5=void 0,t._5="STATIC_PAGE_V2",t.iB={DEFAULT:"DEFAULT",STATIC_PAGE:"STATIC_PAGE",STATIC_PAGE_V2:t._5,STORES_PRODUCT:"STORES_PRODUCT",FORUM_POST:"FORUM_POST",FORUM_CATEGORY:"FORUM_CATEGORY",PRO_GALLERY_ITEM:"PRO_GALLERY_ITEM",BLOG_POST:"BLOG_POST",BLOG_CATEGORY:"BLOG_CATEGORY",BLOG_TAGS:"BLOG_TAGS",BLOG_ARCHIVE:"BLOG_ARCHIVE",GROUPS_PAGE:"GROUPS_PAGE",GROUPS_POST:"GROUPS_POST",EVENTS_PAGE:"EVENTS_PAGE",CHALLENGES_PAGE:"CHALLENGES_PAGE",SEARCH_PAGE:"SEARCH_PAGE",BOOKINGS_SERVICE:"BOOKINGS_SERVICE",BOOKINGS_CALENDAR:"BOOKINGS_CALENDAR",BOOKINGS_FORM:"BOOKINGS_FORM",BREADCRUMBS_COMPONENT:"BREADCRUMBS_COMPONENT",BLOG_HASHTAGS:"BLOG_HASHTAGS",RESTAURANTS_ORDER_PAGE:"RESTAURANTS_ORDER_PAGE",MEMBERS_AREA_PROFILE:"MEMBERS_AREA_PROFILE",VIDEO_COMPONENT:"VIDEO_COMPONENT",PORTFOLIO_COLLECTIONS:"PORTFOLIO_COLLECTIONS",PORTFOLIO_PROJECTS:"PORTFOLIO_PROJECTS",GIFT_CARD:"GIFT_CARD",SCHEDULE_PAGE:"SCHEDULE_PAGE",WIX_DATA_PAGE_ITEM:"WIX_DATA_PAGE_ITEM",REVIEWS_COMPONENT:"REVIEWS_COMPONENT",STORES_CATEGORY:"STORES_CATEGORY",STORES_GALLERY_COMPONENT:"STORES_GALLERY_COMPONENT",RESTAURANTS_MENU_PAGE:"RESTAURANTS_MENU_PAGE",RESTAURANTS_MENU_COMPONENT:"RESTAURANTS_MENU_COMPONENT",MEMBERS_AREA_PROFILE_TABS:"MEMBERS_AREA_PROFILE_TABS",PROGRAMS_COMPONENT:"PROGRAMS_COMPONENT",SERVICES_COMPONENT:"SERVICES_COMPONENT",PAYMENT_PAGE:"PAYMENT_PAGE",THANK_YOU_PAGE:"THANK_YOU_PAGE"}},5965:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WIX_FAQ=t.WIX_SITE_SEARCH=t.WIX_MUSIC=t.BANDSINTOWN=t.WIX_PORTFOLIO=t.WIX_PRO_GALLERY=t.WIX_PHOTO_ALBUMS=t.WIX_HOTELS_RUNNER=t.WIX_VIDEO=t.WIX_GET_SUBSCRIBERS=t.INSTAGRAM_FEED=t.DEVIANTART_FEED=t.WIX_CHAT=t.WIX_RESTAURANTS_TABLE_RESERVATIONS=t.WIX_RESTAURANTS_MENUS_NEW=t.WIX_RESTAURANTS_MENUS=t.WIX_RESTAURANTS_ORDERS_NEW=t.WIX_RESTAURANTS_ORDERS=t.WIX_RESERVATIONS=t.NOTIFICATIONS=t.META_SITE=t.MEMBERS=t.MEMBERS_AREA_V2=t.MEMBERS_AREA=t.WIX_NEW_STORES=t.WIX_STORES=t.WIX_ECOM=t.PRICING_PLANS=t.WIX_FORUM=t.WIX_BOOKINGS=t.WIX_EVENTS=t.WIX_BLOG=t.WIX_HOTELS=t.ADMIN_PAGES=t.DASHBOARD_SALES=t.DASHBOARD_SUGGESTIONS=t.DASHBOARD_SETUP=t.BUSINESS_DASHBOARD=t.WIX_CODE_PLATFORM_VISIBILITY=t.WIX_ACCESSIBILITY_WIZARD=t.WIX_CODE_SITE_MONITORING=t.WIX_CODE_SECRETS_MANAGER=t.WIX_CODE_RELEASE_MANAGER=t.CLOUD_DATA_SCHEMA_NOTIFIER=t.OLD_BLOG=t.SITE_MEMBERS=t.DATA_BINDING=t.WIX_CODE_DUPLEXER=t.WIX_CODE_SITE_EXTENSION=t.WIX_CODE=void 0,t.getAppDependencies=t.WIX_DONATIONS=t.PRODUCT_PAGE_ON_BLOCKS=t.WIX_CHECKOUT_REQUIREMENTS=t.FERA_REVIEWS=t.CMS=t.MULTILINGUAL=t.MEMBERS_ACCOUNT_INFO=t.MEMBERS_ABOUT=t.MY_SUBSCRIPTIONS=t.MAP_PLUGIN=t.WIX_REVIEWS=t.WISHLIST_BLOCKS=t.RESTAURANTS=t.WIX_FILE_SHARE=t.RICH_CONTENT=t.WIX_GROUPS=t.WIX_CHALLENGES=t.WIX_FORMS=void 0,t.WIX_CODE="wix-code",t.WIX_CODE_SITE_EXTENSION="CloudSiteExtension",t.WIX_CODE_DUPLEXER="af6d536e-0fc6-428b-a7f9-1d8cd6aa3703",t.DATA_BINDING="dataBinding",t.SITE_MEMBERS="SiteMembers",t.OLD_BLOG="79f391eb-7dfc-4adf-be6e-64434c4838d9",t.CLOUD_DATA_SCHEMA_NOTIFIER="f1fbeff1-05c3-4121-bdb5-75e74b6e9e51",t.WIX_CODE_RELEASE_MANAGER="8c41f3a6-47f7-40be-ad77-02a72cb2ddb3",t.WIX_CODE_SECRETS_MANAGER="4b10fcce-732d-4be3-9d46-801d271acda9",t.WIX_CODE_SITE_MONITORING="675bbcef-18d8-41f5-800e-131ec9e08762",t.WIX_ACCESSIBILITY_WIZARD="9699c03d-5c19-4a7c-a454-e8109a6e43fc",t.WIX_CODE_PLATFORM_VISIBILITY="8048f115-449b-4dab-b0e6-e09d5ffc8199",t.BUSINESS_DASHBOARD="a7597ab5-1ed4-458f-a5c1-5884d5e14281",t.DASHBOARD_SETUP="0750d046-d599-4cfc-9f6b-e9f4af169aa9",t.DASHBOARD_SUGGESTIONS="cead4297-02ee-4c0f-ae07-461f4ba71b3b",t.DASHBOARD_SALES="f95c72b1-84de-48ec-a61b-d96d61315ffe",t.ADMIN_PAGES="1514b01b-cb08-41b4-8582-0a88551ac769",t.WIX_HOTELS="135aad86-9125-6074-7346-29dc6a3c9bcf",t.WIX_BLOG="14bcded7-0066-7c35-14d7-466cb3f09103",t.WIX_EVENTS="140603ad-af8d-84a5-2c80-a0f60cb47351",t.WIX_BOOKINGS="13d21c63-b5ec-5912-8397-c3a5ddb27a97",t.WIX_FORUM="14724f35-6794-cd1a-0244-25fd138f9242",t.PRICING_PLANS="1522827f-c56c-a5c9-2ac9-00f9e6ae12d3",t.WIX_ECOM="1380b703-ce81-ff05-f115-39571d94dfcd",t.WIX_STORES="1380b703-ce81-ff05-f115-39571d94dfcd",t.WIX_NEW_STORES="215238eb-22a5-4c36-9e7b-e7c08025e04e",t.MEMBERS_AREA="14cc59bc-f0b7-15b8-e1c7-89ce41d0e0c9",t.MEMBERS_AREA_V2="b976560c-3122-4351-878f-453f337b7245",t.MEMBERS="14dbefd2-01b4-fb61-32a7-3abd44da4908",t.META_SITE="22bef345-3c5b-4c18-b782-74d4085112ff",t.NOTIFICATIONS="14f25924-5664-31b2-9568-f9c5ed98c9b1",t.WIX_RESERVATIONS="1475ab65-206b-d79a-856d-fa10bdb479ea",t.WIX_RESTAURANTS_ORDERS="13e8d036-5516-6104-b456-c8466db39542",t.WIX_RESTAURANTS_ORDERS_NEW="9a5d83fd-8570-482e-81ab-cfa88942ee60",t.WIX_RESTAURANTS_MENUS="13c1402c-27f2-d4ab-7463-ee7c89e07578",t.WIX_RESTAURANTS_MENUS_NEW="b278a256-2757-4f19-9313-c05c783bec92",t.WIX_RESTAURANTS_TABLE_RESERVATIONS="f9c07de2-5341-40c6-b096-8eb39de391fb",t.WIX_CHAT="14517e1a-3ff0-af98-408e-2bd6953c36a2",t.DEVIANTART_FEED="7d297b79-baed-46d7-ac58-4bd68dcb70d0",t.INSTAGRAM_FEED="14635256-b183-1c71-a4d2-f55179b80e8a",t.WIX_GET_SUBSCRIBERS="1375baa8-8eca-5659-ce9d-455b2009250d",t.WIX_VIDEO="14409595-f076-4753-8303-9a86f9f71469",t.WIX_HOTELS_RUNNER="826670ba-3a6b-4157-ac72-7c4fca9ce220",t.WIX_PHOTO_ALBUMS="13ff8629-c1fc-e289-e81f-bc8c8968e9d6",t.WIX_PRO_GALLERY="14271d6f-ba62-d045-549b-ab972ae1f70e",t.WIX_PORTFOLIO="d90652a2-f5a1-4c7c-84c4-d4cdcc41f130",t.BANDSINTOWN="1405ef82-0ee0-65fb-88a1-2f172aa3573c",t.WIX_MUSIC="13bb5d67-1add-e770-a71f-001277e17c57",t.WIX_SITE_SEARCH="1484cb44-49cd-5b39-9681-75188ab429de",t.WIX_FAQ="14c92d28-031e-7910-c9a8-a670011e062d",t.WIX_FORMS="14ce1214-b278-a7e4-1373-00cebd1bef7c",t.WIX_CHALLENGES="2936472a-a1ed-4ae5-9f71-614313a9f4e7",t.WIX_GROUPS="148c2287-c669-d849-d153-463c7486a694",t.RICH_CONTENT="949cfcc9-2a3f-4a96-bd6c-11d9d82763a4",t.WIX_FILE_SHARE="1537b24e-29d1-6d8f-b8e1-d6860f2f70b9",t.RESTAURANTS="9142e27e-2e30-4948-ad8f-7e128939efc4",t.WISHLIST_BLOCKS="a97c0203-062a-4dd5-97cf-a90f9800a13a",t.WIX_REVIEWS="a95a5fce-e370-4402-9ce4-96956acc747d",t.MAP_PLUGIN="c5fedde3-63c7-4041-a5fb-c77bbe6308dc",t.MY_SUBSCRIPTIONS="2bef2abe-7abe-43da-889c-53c1500a328c",t.MEMBERS_ABOUT="14dbef06-cc42-5583-32a7-3abd44da4908",t.MEMBERS_ACCOUNT_INFO="14cffd81-5215-0a7f-22f8-074b0e2401fb",t.MULTILINGUAL="14d84998-ae09-1abf-c6fc-3f3cace5bf19",t.CMS="1973457f-c021-4da5-941f-58444ff761d4",t.FERA_REVIEWS="c9064755-5cc8-4faf-a5a6-41a0150a6640",t.WIX_CHECKOUT_REQUIREMENTS="eeb6edab-5c38-4903-b070-58ac767a3389",t.PRODUCT_PAGE_ON_BLOCKS="a0c68605-c2e7-4c8d-9ea1-767f9770e087",t.WIX_DONATIONS="333b456e-dd48-4d6b-b32b-9fd48d74e163";var r={};t.getAppDependencies=function(e){return r[e]||[]}},9540:e=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}var r="User",n="Error",o="EDM",a=function(e,r){e&&"object"===t(e)&&(e.errorGroup=r)};e.exports={markUserError:function(e){return a(e,r)},isUserError:function(e){return e&&e.errorGroup===r},markAppError:function(e){return a(e,n)},isAppError:function(e){return e&&e.errorGroup===n},markEdmError:function(e){return a(e,o)},isEdmError:function(e){return e&&e.errorGroup===o},markError:a,isMarked:function(e){return!!e&&void 0!==e.errorGroup},USER_ERROR_GROUP:r,APP_ERROR_GROUP:n,EDM_ERROR_GROUP:o,UNKNOWN_ERROR_GROUP:"Unknown"}},3164:(e,t,r)=>{"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},a(e,t)}function i(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=c(e);if(t){var a=c(this).constructor;r=Reflect.construct(o,arguments,a)}else r=o.apply(this,arguments);return function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return s(e)}(this,r)}}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e){return c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},c(e)}var l=r(9540),d=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}(d,e);var t,r,n,c=i(d);function d(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return e=c.call.apply(c,[this].concat(r)),Error.captureStackTrace&&Error.captureStackTrace(s(e),e.constructor),e.name=d.name,l.markUserError(s(e)),e}return t=d,r&&o(t.prototype,r),n&&o(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(function(e){function t(){var t=Reflect.construct(e,Array.from(arguments));return Object.setPrototypeOf(t,Object.getPrototypeOf(this)),t}return t.prototype=Object.create(e.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e,t}(Error));e.exports={UserCodeError:d}},3065:(e,t,r)=>{"use strict";function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var i=r(9540),s=r(3164);e.exports=o(o({},s),i)},5882:(e,t,r)=>{"use strict";t.PL=t.ah=void 0;var n=r(4725);Object.defineProperty(t,"ah",{enumerable:!0,get:function(){return n.convertToCustomFormat}}),Object.defineProperty(t,"PL",{enumerable:!0,get:function(){return n.convertFromCustomFormat}});var o=r(6658)},4455:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConvertersComposer=void 0;var n=r(1561),o=function(e){return null!==e&&"object"==typeof e},a=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._converters=e}return e.prototype.convertToCustomFormat=function(e,t,r){var n;if(void 0===t&&(t=new Set),void 0===r&&(r=!1),o(e)){if(t.has(e))throw new TypeError("Converting circular structure to JSON");t.add(e)}if(Array.isArray(e))return this._convertArray(e,t);var a=null===(n=this._findConverterToCustomFormat(e))||void 0===n?void 0:n.convertToCustomFormat(e,r);return o(e)?this._convertObject(a,e,t):a},e.prototype.convertFromCustomFormat=function(e){var t,r=this,a=e;return Array.isArray(e)?a=e.map((function(e){return r.convertFromCustomFormat(e)})):o(e)&&(a=(0,n.mapValues)(e,this.convertFromCustomFormat.bind(this))),null===(t=this._findConverterFromCustomFormat(a))||void 0===t?void 0:t.convertFromCustomFormat(a)},e.prototype._convertObject=function(e,t,r){var o,a=this;return o="function"==typeof e.toJSON?(0,n.mapValues)(e.toJSON(),(function(e){return a.convertToCustomFormat(e,r)})):(0,n.mapValues)(e,(function(e){return a.convertToCustomFormat(e,r)})),r.delete(t),o},e.prototype._convertArray=function(e,t){var r=this,n=e.map((function(e){return r.convertToCustomFormat(e,t,!0)}));return t.delete(e),n},e.prototype._findConverterFromCustomFormat=function(e){return this._converters.find((function(t){return t.canConvertFromCustomFormat(e)}))},e.prototype._findConverterToCustomFormat=function(e){return this._converters.find((function(t){return t.canConvertToCustomFormat(e)}))},e}();t.ConvertersComposer=a},5362:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DateConverter=void 0;var r=function(){function e(){}return e.prototype.canConvertToCustomFormat=function(e){return e instanceof Date},e.prototype.convertToCustomFormat=function(e){return{$date:e.toISOString()}},e.prototype.canConvertFromCustomFormat=function(e){return this._isObjectWith$Date(e)&&"string"==typeof e.$date&&(t=e.$date,!Number.isNaN(Date.parse(t)));var t},e.prototype.convertFromCustomFormat=function(e){return new Date(e.$date)},e.prototype._isObjectWith$Date=function(e){return!!e&&"object"==typeof e&&"$date"in e},e}();t.DateConverter=r},5574:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultConverter=void 0;var r=function(){function e(){}return e.prototype.canConvertToCustomFormat=function(){return!0},e.prototype.convertToCustomFormat=function(e,t){return t&&void 0===e?null:e},e.prototype.canConvertFromCustomFormat=function(){return!0},e.prototype.convertFromCustomFormat=function(e){return e},e}();t.DefaultConverter=r},4725:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertFromCustomFormat=t.convertToCustomFormat=void 0;var n=r(4455),o=r(5362),a=r(5574),i=new n.ConvertersComposer(new o.DateConverter,new a.DefaultConverter);t.convertToCustomFormat=function(e){return i.convertToCustomFormat(e)};t.convertFromCustomFormat=function(e){return i.convertFromCustomFormat(e)}},1561:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mapValues=void 0,t.mapValues=function(e,t){var r={};return Object.keys(e).forEach((function(n){var o=t(e[n]);void 0!==o&&(r[n]=o)})),r}},6658:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBackendPackageNameFromImportName=t.generateBackendPackageWebMethodUrl=t.generatePackageWebMethodUrl=t.exceptionToWebMethodPayload=t.resultToWebMethodPayload=void 0;var n=r(4725);t.resultToWebMethodPayload=function(e,t){var r=t?JSON.parse(JSON.stringify(e,t)):(0,n.convertToCustomFormat)(e);return void 0===r?{}:{result:r}};t.exceptionToWebMethodPayload=function(e,t,r){return void 0===t&&(t=function(e){return e}),void 0===r&&(r=function(e){return""}),{result:e instanceof Error?{message:t(e.message),name:e.name,stack:r(e.stack),code:e.code,_elementoryError:!0}:e,exception:!0}};var o=function(e,t){return"/_webMethods/packages/".concat(encodeURIComponent(e),"/").concat(t,".ajax")};t.generatePackageWebMethodUrl=o;t.generateBackendPackageWebMethodUrl=function(e,t){return o("".concat(e,"-backend"),t)};t.getBackendPackageNameFromImportName=function(e){return"".concat(e,"-backend")}},4479:(e,t,r)=>{"use strict";const n=r(7030),o=r(1290),a="currentUser";e.exports.X=e=>n(e)&&e[o]===a},8031:(e,t,r)=>{"use strict";const n=r(7030),{DATA_BINDING:o}=r(5965),a=r(1290),i=o;e.exports.X=e=>n(e)&&e[a]===i},1290:e=>{"use strict";e.exports="@resolver"},3878:(e,t,r)=>{"use strict";const n=r(7030),o=r(1290),a="userInput";e.exports.X=e=>n(e)&&e[o]===a},8582:e=>{"use strict";e.exports=(e,t)=>t.reduce(((e,t)=>e.chain((e=>t.map((t=>Array.isArray(t)?e.concat([t]):e.concat(t)))))),e.of([]))},7538:e=>{e.exports.l={COMPONENT:"COMPONENT_SCOPE",GLOBAL:"GLOBAL_SCOPE"}},477:(e,t,r)=>{const n=r(4169),o=r(3297),a=r(6939);e.exports={union:n,Result:o,Maybe:a}},6939:e=>{"use strict";const t=e=>({map:r=>t(r(e)),chain:t=>t(e),fold:(t,r)=>r(e),getOrElse:()=>e,orElse:()=>t(e),filter:n=>n(e)?t(e):r()}),r=()=>({map:()=>r(),chain:()=>r(),fold:e=>e(),getOrElse:e=>e,orElse:e=>e(),filter:()=>r()}),n={Just:t,Nothing:r,fromNullable:e=>null!=e?t(e):r(),of:e=>t(e)};e.exports=n},3297:e=>{"use strict";const t=e=>({map:r=>t(r(e)),chain:t=>t(e),fold:(t,r)=>r(e),getOrElse:()=>e,merge:()=>e}),r=e=>({map:()=>r(e),chain:()=>r(e),fold:t=>t(e),getOrElse:e=>e,merge:()=>e}),n={Ok:t,Error:r,try:e=>{try{return t(e())}catch(e){return r(e)}},fromNullable:(e,n)=>null!=e?t(e):r(n),fromMaybe:(e,n)=>e.fold((()=>r(n)),(e=>t(e))),of:e=>t(e)};e.exports=n},4169:e=>{const t=Symbol.for("union-type-any-symbol"),r=e=>r=>{const n=Object.keys(r);for(const t of n)if(t===e.name)return r[t](e.payload);if(r[t])return r[t]();throw new Error(`Variant "${e.name}" not covered in pattern with keys [${n}].\nThis could mean you did not include all variants in your Union's matchWith function.`)},n=(e,t,n={})=>Object.keys(t).reduce(((o,a)=>(o[a]=((e,t,n,o)=>{const a=Symbol(`[${e}:${t}]`),i=(...e)=>{const i=n(...e),s={matchWith:r({name:t,payload:i}),toString:()=>t,[a]:!0};return Object.keys(o).forEach((e=>{s[e]=o[e](s)})),s};return i.hasInstance=e=>e&&!0===e[a],i})(e,a,t[a],n),o)),{});n.any=t,e.exports=n},5635:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},3121:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultMaxPageSize=void 0;const n=r(3810);t.DefaultMaxPageSize={[n.PagingMode.Offset]:1e3,[n.PagingMode.Cursor]:100}},2295:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AllowedFilterOperator=t.FieldType=void 0,function(e){e.number="number",e.text="text",e.image="image",e.boolean="boolean",e.document="document",e.url="url",e.richText="richtext",e.date="date",e.dateTime="datetime",e.video="video",e.reference="reference",e.multiReference="multi-reference",e.pageLink="pagelink",e.object="object",e.mediaGallery="media-gallery",e.address="address",e.stringArray="array<string>",e.color="color",e.audio="audio",e.time="time",e.array="array",e.richContent="rich-content",e.language="language",e.documentArray="array<document>",e.any="any",e.legacyBook="bookType",e.legacyExternalUrl="externalUrl",e.legacyBrokenRef="broken-reference",e.legacyExternalVideo="externalVideo",e.legacyImage="Image"}(t.FieldType||(t.FieldType={})),function(e){e.eq="eq",e.ne="ne",e.lt="lt",e.lte="lte",e.gt="gt",e.gte="gte",e.hasSome="hasSome",e.hasAll="hasAll",e.contains="contains",e.startsWith="startsWith",e.endsWith="endsWith",e.urlized="urlized",e.exists="exists"}(t.AllowedFilterOperator||(t.AllowedFilterOperator={}))},9347:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CMS_FIELD_PLUGIN_ID=void 0,t.CMS_FIELD_PLUGIN_ID="cms"},2722:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Operator=void 0,function(e){e.and="$and",e.or="$or",e.not="$not",e.eq="$eq",e.ne="$ne",e.lt="$lt",e.lte="$lte",e.gt="$gt",e.gte="$gte",e.hasSome="$hasSome",e.hasAll="$hasAll",e.contains="$contains",e.startsWith="$startsWith",e.endsWith="$endsWith",e.urlized="$urlized"}(t.Operator||(t.Operator={}))},4361:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(9166),t),o(r(2722),t),o(r(2295),t),o(r(3530),t),o(r(3810),t),o(r(47),t),o(r(3121),t),o(r(9347),t),o(r(5635),t)},9166:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Direction=void 0,function(e){e.asc="asc",e.desc="desc"}(t.Direction||(t.Direction={}))},3810:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PagingMode=void 0,function(e){e.Offset="OFFSET",e.Cursor="CURSOR"}(t.PagingMode||(t.PagingMode={}))},47:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CMS_PLUGIN_ID=t.PAGE_LINK_PLUGIN_ID=t.SHARED_PLUGIN_ID=t.MULTILINGUAL_PLUGIN_ID=t.UrlizedFormat=t.URLIZED_PLUGIN_ID=t.SINGLES_PLUGIN_ID=t.GRID_APPLESS_PLUGIN_ID=t.PublishingStatus=t.DRAFT_DATE_FIELD_KEY=t.PUBLISH_DATE_FIELD_KEY=t.PUBLISH_STATUS_FIELD_KEY=t.PUBLISHING_PLUGIN_ID=void 0,t.PUBLISHING_PLUGIN_ID="publishing",t.PUBLISH_STATUS_FIELD_KEY="_publishStatus",t.PUBLISH_DATE_FIELD_KEY="_publishDate",t.DRAFT_DATE_FIELD_KEY="_draftDate",function(e){e.DRAFT="DRAFT",e.PUBLISHED="PUBLISHED"}(t.PublishingStatus||(t.PublishingStatus={})),t.GRID_APPLESS_PLUGIN_ID="gridAppless",t.SINGLES_PLUGIN_ID="singleItem",t.URLIZED_PLUGIN_ID="urlized",function(e){e.PLAIN="plain",e.ORIGINAL="original"}(t.UrlizedFormat||(t.UrlizedFormat={})),t.MULTILINGUAL_PLUGIN_ID="multilingual",t.SHARED_PLUGIN_ID="shared",t.PAGE_LINK_PLUGIN_ID="persistentPageLink",t.CMS_PLUGIN_ID="cms"},3530:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Storage=t.PermissionRole=t.CollectionOperation=t.DataOperation=void 0,function(e){e.aggregate="aggregate",e.bulkInsert="bulkInsert",e.bulkRemove="bulkRemove",e.bulkSave="bulkSave",e.bulkUpdate="bulkUpdate",e.count="count",e.distinct="distinct",e.find="find",e.get="get",e.insert="insert",e.insertReference="insertReference",e.isReferenced="isReferenced",e.queryReferenced="queryReferenced",e.remove="remove",e.removeReference="removeReference",e.replaceReferences="replaceReferences",e.save="save",e.truncate="truncate",e.update="update"}(t.DataOperation||(t.DataOperation={})),function(e){e.UPDATE="update",e.REMOVE="remove"}(t.CollectionOperation||(t.CollectionOperation={})),function(e){e.anyone="anyone",e.siteMember="siteMember",e.siteMemberAuthor="siteMemberAuthor",e.admin="admin"}(t.PermissionRole||(t.PermissionRole={})),function(e){e.driver="driver",e.docstore="docstore",e.app="app",e.external="external",e.dynamicApplication="dynamicApplication",e.staticAppSchema="staticAppSchema"}(t.Storage||(t.Storage={}))},5675:e=>{var t=Object.prototype.toString;e.exports=function(e){var r=typeof e;return"undefined"===r?"undefined":null===e?"null":!0===e||!1===e||e instanceof Boolean?"boolean":"string"===r||e instanceof String?"string":"number"===r||e instanceof Number?"number":"function"===r||e instanceof Function?void 0!==e.constructor.name&&"Generator"===e.constructor.name.slice(0,9)?"generatorfunction":"function":void 0!==Array.isArray&&Array.isArray(e)?"array":e instanceof RegExp?"regexp":e instanceof Date?"date":"[object RegExp]"===(r=t.call(e))?"regexp":"[object Date]"===r?"date":"[object Arguments]"===r?"arguments":"[object Error]"===r?"error":"[object Promise]"===r?"promise":function(e){return e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}(e)?"buffer":"[object Set]"===r?"set":"[object WeakSet]"===r?"weakset":"[object Map]"===r?"map":"[object WeakMap]"===r?"weakmap":"[object Symbol]"===r?"symbol":"[object Map Iterator]"===r?"mapiterator":"[object Set Iterator]"===r?"setiterator":"[object String Iterator]"===r?"stringiterator":"[object Array Iterator]"===r?"arrayiterator":"[object Int8Array]"===r?"int8array":"[object Uint8Array]"===r?"uint8array":"[object Uint8ClampedArray]"===r?"uint8clampedarray":"[object Int16Array]"===r?"int16array":"[object Uint16Array]"===r?"uint16array":"[object Int32Array]"===r?"int32array":"[object Uint32Array]"===r?"uint32array":"[object Float32Array]"===r?"float32array":"[object Float64Array]"===r?"float64array":"object"}},3741:()=>{if("function"!=typeof self.queueMicrotask&&(self.queueMicrotask=function(e){Promise.resolve().then(e).catch((e=>setTimeout((()=>{throw e}))))}),"function"!=typeof Array.prototype.at){const e=Reflect.getPrototypeOf(Int8Array);for(const t of[Array,String,e])Object.defineProperty(t.prototype,"at",{value:function(e){if((e=Math.trunc(e)||0)<0&&(e+=this.length),!(e<0||e>=this.length))return this[e]},writable:!0,enumerable:!1,configurable:!0})}},5554:e=>{"use strict";var t="%[a-f0-9]{2}",r=new RegExp("("+t+")|([^%]+?)","gi"),n=new RegExp("("+t+")+","gi");function o(e,t){try{return[decodeURIComponent(e.join(""))]}catch(e){}if(1===e.length)return e;t=t||1;var r=e.slice(0,t),n=e.slice(t);return Array.prototype.concat.call([],o(r),o(n))}function a(e){try{return decodeURIComponent(e)}catch(a){for(var t=e.match(r)||[],n=1;n<t.length;n++)t=(e=o(t,n).join("")).match(r)||[];return e}}e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"\ufffd\ufffd","%FF%FE":"\ufffd\ufffd"},r=n.exec(e);r;){try{t[r[0]]=decodeURIComponent(r[0])}catch(e){var o=a(r[0]);o!==r[0]&&(t[r[0]]=o)}r=n.exec(e)}t["%C2"]="\ufffd";for(var i=Object.keys(t),s=0;s<i.length;s++){var c=i[s];e=e.replace(new RegExp(c,"g"),t[c])}return e}(e)}}},857:(e,t,r)=>{var n=r(7772).Symbol;e.exports=n},3366:(e,t,r)=>{var n=r(857),o=r(2107),a=r(7157),i=n?n.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":i&&i in Object(e)?o(e):a(e)}},1242:(e,t,r)=>{var n="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g;e.exports=n},7353:(e,t,r)=>{var n=r(241)(Object.getPrototypeOf,Object);e.exports=n},2107:(e,t,r)=>{var n=r(857),o=Object.prototype,a=o.hasOwnProperty,i=o.toString,s=n?n.toStringTag:void 0;e.exports=function(e){var t=a.call(e,s),r=e[s];try{e[s]=void 0;var n=!0}catch(e){}var o=i.call(e);return n&&(t?e[s]=r:delete e[s]),o}},7157:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},241:e=>{e.exports=function(e,t){return function(r){return e(t(r))}}},7772:(e,t,r)=>{var n=r(1242),o="object"==typeof self&&self&&self.Object===Object&&self,a=n||o||Function("return this")();e.exports=a},5125:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},7030:(e,t,r)=>{var n=r(3366),o=r(7353),a=r(5125),i=Function.prototype,s=Object.prototype,c=i.toString,l=s.hasOwnProperty,d=c.call(Object);e.exports=function(e){if(!a(e)||"[object Object]"!=n(e))return!1;var t=o(e);if(null===t)return!0;var r=l.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&c.call(r)==d}},7320:e=>{"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach((function(e){n[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(e){return!1}}()?Object.assign:function(e,o){for(var a,i,s=function(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),c=1;c<arguments.length;c++){for(var l in a=Object(arguments[c]))r.call(a,l)&&(s[l]=a[l]);if(t){i=t(a);for(var d=0;d<i.length;d++)n.call(a,i[d])&&(s[i[d]]=a[i[d]])}}return s}},4126:(e,t,r)=>{"use strict";var n=r(2938),o=r(7320),a=r(5554);function i(e,t){return t.encode?t.strict?n(e):encodeURIComponent(e):e}function s(e){return Array.isArray(e)?e.sort():"object"==typeof e?s(Object.keys(e)).sort((function(e,t){return Number(e)-Number(t)})).map((function(t){return e[t]})):e}function c(e){var t=e.indexOf("?");return-1===t?"":e.slice(t+1)}function l(e,t){var r=function(e){var t;switch(e.arrayFormat){case"index":return function(e,r,n){/\[(\d*)\]$/.exec(e),e.replace(/\[\d*\]$/,""),t?(void 0===n[e]&&(n[e]={}),n[e][t[1]]=r):n[e]=r};case"bracket":return function(e,r,n){/(\[\])$/.exec(e),e.replace(/\[\]$/,""),t?void 0!==n[e]?n[e]=[].concat(n[e],r):n[e]=[r]:n[e]=r};default:return function(e,t,r){void 0!==r[e]?r[e]=[].concat(r[e],t):r[e]=t}}}(o({arrayFormat:"none"},t)),n=Object.create(null);return"string"!=typeof e?n:e.trim().replace(/^[?#&]/,"")?(e.split("&").forEach((function(e){var t=e.replace(/\+/g," ").split("="),o=t.shift(),i=t.length>0?t.join("="):void 0;void 0===i?null:a(i),r(a(o),i,n)})),Object.keys(n).sort().reduce((function(e,t){var r=n[t];return Boolean(r)&&"object"==typeof r&&!Array.isArray(r)?e[t]=s(r):e[t]=r,e}),Object.create(null))):n}t.Pz=function(e,t){!1===(t=o({encode:!0,strict:!0,arrayFormat:"none"},t)).sort&&(t.sort=function(){});var r=function(e){switch(e.arrayFormat){case"index":return function(t,r,n){return null===r?[i(t,e),"[",n,"]"].join(""):[i(t,e),"[",i(n,e),"]=",i(r,e)].join("")};case"bracket":return function(t,r){return null===r?i(t,e):[i(t,e),"[]=",i(r,e)].join("")};default:return function(t,r){return null===r?i(t,e):[i(t,e),"=",i(r,e)].join("")}}}(t);return e?Object.keys(e).sort(t.sort).map((function(n){var o=e[n];if(void 0===o)return"";if(null===o)return i(n,t);if(Array.isArray(o)){var a=[];return o.slice().forEach((function(e){void 0!==e&&a.push(r(n,e,a.length))})),a.join("&")}return i(n,t)+"="+i(o,t)})).filter((function(e){return e.length>0})).join("&"):""}},2938:e=>{"use strict";e.exports=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}))}},7375:(e,t)=>{"use strict";var r=Object.prototype.hasOwnProperty;function n(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(e){return null}}function o(e){try{return encodeURIComponent(e)}catch(e){return null}}t.stringify=function(e,t){t=t||"";var n,a,i=[];for(a in"string"!=typeof t&&(t="?"),e)if(r.call(e,a)){if((n=e[a])||null!=n&&!isNaN(n)||(n=""),a=o(a),n=o(n),null===a||null===n)continue;i.push(a+"="+n)}return i.length?t+i.join("&"):""},t.parse=function(e){for(var t,r=/([^=?#&]+)=?([^&]*)/g,o={};t=r.exec(e);){var a=n(t[1]),i=n(t[2]);null===a||null===i||a in o||(o[a]=i)}return o}},4438:e=>{"use strict";var t=function(e){return null!=e&&"function"==typeof e.run&&"boolean"==typeof e.isQueued&&(!e.resultActionCreator||"function"==typeof e.resultActionCreator)};e.exports={isEffect:t,isImmediateEffect:function(e){return t(e)&&!e.isQueued},isQueuedEffect:function(e){return t(e)&&e.isQueued}}},6286:(e,t,r)=>{"use strict";var n=r(6356);e.exports={createMiddleware:n}},6356:(e,t,r)=>{"use strict";var n=r(4520).isPromise,o=r(8620),a=o.sequence,i=o.try_,s=r(5676),c=r(4438),l=c.isEffect,d=c.isImmediateEffect,u=c.isQueuedEffect,p=function(e){return function(t){return e.push(t),function(){var r=e.indexOf(t);r>=0&&e.splice(r,1)}}};e.exports=function(){var e=[],t=[],r=Promise.resolve();return{middleware:function(o){return function(c){return function(p){var f=function(e){var t=i((function(){return e.run()}));return t.fold((function(r){var n=e.resultActionCreator?o.dispatch(e.resultActionCreator(!0,r)):Promise.resolve();return[t,n]}),(function(r){if(n(r)){var a=r.then((function(t){return e.resultActionCreator?o.dispatch(e.resultActionCreator(!1,t)):Promise.resolve()}),(function(t){throw e.resultActionCreator&&o.dispatch(e.resultActionCreator(!0,t)).catch((function(){})),t}));return[t,a]}var i=e.resultActionCreator?o.dispatch(e.resultActionCreator(!1,r)):Promise.resolve();return[t,i]}))},h=function(){var e=void 0,n=new Promise((function(t){return e=t})),o=new Promise((function(e,o){var a=r=r.then((function(){return n})).then(function(e,t){return function(r){if(r.length>0){var n=r.filter(u).map(f);return Promise.all(n.map((function(e){return e[1]}))).then((function(){return e()}),t),Promise.all(n.map((function(e){return e[0]})).map((function(e){return e.fold((function(e){return Promise.reject(e)}),(function(e){return e}))}))).catch(t)}return e(),Promise.resolve()}}(e,o),o).catch(o).then((function(){a===r&&t.slice().forEach((function(e){return e()}))}))}));return{promise:o,trigger:e}},m=function(e){var t=h(),r=t.promise,n=t.trigger;return i((function(){return function(e){var t=e.filter(d).map(f);return t.map((function(e){return e[0]})).map((function(e){return e.fold((function(e){throw e}),(function(e){return e}))})),t.map((function(e){return e[1]})).map((function(e){return e.catch((function(){}))})),e.filter(u)}(e)})).fold((function(e){throw n([]),e}),(function(e){return n(e),r}))},g=o.getState(),y=c(p),v=o.getState();if(g!==v){var _=s(g,v);return a(e.slice().map((function(e){return i((function(){return e(_)||[]}))}))).fold((function(e){throw e}),(function(e){return m(e.filter(l))}))}return Promise.resolve(y)}}},subscribe:p(e),onIdle:p(t)}}},8620:e=>{"use strict";var t=function(){},r=function(e,r){return e.fold(r.Error||t,r.Ok||t)},n=function(e){return{map:function(e){return this},fold:function(t,r){return t(e)},chain:function(e){return this},match:function(e){return r(this,e)},value:e}},o=function e(t){return{map:function(r){return e(r(t))},fold:function(e,r){return r(t)},chain:function(e){return e(t)},match:function(e){return r(this,e)},value:t}},a={Left:n,Right:o};e.exports={Either:a,sequence:function(e){return e.reduce((function(e,t){return e.chain((function(e){return t.map((function(t){return e.concat(t)}))}))}),o([]))},try_:function(e){try{return o(e())}catch(e){return n(e)}}}},4520:e=>{"use strict";e.exports.isPromise=function(e){return null!=e&&"function"==typeof e.then}},5676:e=>{"use strict";e.exports=function(e,t){var r={from:e,to:t,hasChanged:function(r){return r(e)!==r(t)},hasChangedToMatch:function(e,n){return r.hasChanged(e)&&n(e(t))},hasChangedToTrue:function(e){return r.hasChangedToMatch(e,(function(e){return!0===e}))},hasChangedToFalse:function(e){return r.hasChangedToMatch(e,(function(e){return!1===e}))},hasChangedToNull:function(e){return r.hasChangedToMatch(e,(function(e){return null===e}))},hasChangedToNotNull:function(e){return r.hasChangedToMatch(e,(function(e){return null!==e}))}};return r}},7245:e=>{"use strict";e.exports=function(e,t){if(t=t.split(":")[0],!(e=+e))return!1;switch(t){case"http":case"ws":return 80!==e;case"https":case"wss":return 443!==e;case"ftp":return 21!==e;case"gopher":return 70!==e;case"file":return!1}return 0!==e}},5174:e=>{var t=Object.prototype.hasOwnProperty;function r(e){return"[Throws: "+(e?e.message:"?")+"]"}function n(e){var n=[];return function e(o){if(null===o||"object"!=typeof o)return o;if(-1!==n.indexOf(o))return"[Circular]";if(n.push(o),"function"==typeof o.toJSON)try{var a=e(o.toJSON());return n.pop(),a}catch(e){return r(e)}if(Array.isArray(o)){var i=o.map(e);return n.pop(),i}var s=Object.keys(o).reduce((function(n,a){return n[a]=e(function(e,n){if(t.call(e,n))try{return e[n]}catch(e){return r(e)}return e[n]}(o,a)),n}),{});return n.pop(),s}(e)}e.exports=function(e,t,r){return JSON.stringify(n(e),t,r)},e.exports.ensureProperties=n},4846:(e,t,r)=>{"use strict";var n=r(7245),o=r(7375),a=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,i=/[\n\r\t]/g,s=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,c=/:\d+$/,l=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,d=/^[a-zA-Z]:/;function u(e){return(e||"").toString().replace(a,"")}var p=[["#","hash"],["?","query"],function(e,t){return m(t.protocol)?e.replace(/\\/g,"/"):e},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],f={hash:1,query:1};function h(e){var t,n=("undefined"!=typeof window?window:void 0!==r.g?r.g:"undefined"!=typeof self?self:{}).location||{},o={},a=typeof(e=e||n);if("blob:"===e.protocol)o=new y(unescape(e.pathname),{});else if("string"===a)for(t in o=new y(e,{}),f)delete o[t];else if("object"===a){for(t in e)t in f||(o[t]=e[t]);void 0===o.slashes&&(o.slashes=s.test(e.href))}return o}function m(e){return"file:"===e||"ftp:"===e||"http:"===e||"https:"===e||"ws:"===e||"wss:"===e}function g(e,t){e=(e=u(e)).replace(i,""),t=t||{};var r,n=l.exec(e),o=n[1]?n[1].toLowerCase():"",a=!!n[2],s=!!n[3],c=0;return a?s?(r=n[2]+n[3]+n[4],c=n[2].length+n[3].length):(r=n[2]+n[4],c=n[2].length):s?(r=n[3]+n[4],c=n[3].length):r=n[4],"file:"===o?c>=2&&(r=r.slice(2)):m(o)?r=n[4]:o?a&&(r=r.slice(2)):c>=2&&m(t.protocol)&&(r=n[4]),{protocol:o,slashes:a||m(o),slashesCount:c,rest:r}}function y(e,t,r){if(e=(e=u(e)).replace(i,""),!(this instanceof y))return new y(e,t,r);var a,s,c,l,f,v,_=p.slice(),I=typeof t,E=this,T=0;for("object"!==I&&"string"!==I&&(r=t,t=null),r&&"function"!=typeof r&&(r=o.parse),a=!(s=g(e||"",t=h(t))).protocol&&!s.slashes,E.slashes=s.slashes||a&&t.slashes,E.protocol=s.protocol||t.protocol||"",e=s.rest,("file:"===s.protocol&&(2!==s.slashesCount||d.test(e))||!s.slashes&&(s.protocol||s.slashesCount<2||!m(E.protocol)))&&(_[3]=[/(.*)/,"pathname"]);T<_.length;T++)"function"!=typeof(l=_[T])?(c=l[0],v=l[1],c!=c?E[v]=e:"string"==typeof c?~(f="@"===c?e.lastIndexOf(c):e.indexOf(c))&&("number"==typeof l[2]?(E[v]=e.slice(0,f),e=e.slice(f+l[2])):(E[v]=e.slice(f),e=e.slice(0,f))):(f=c.exec(e))&&(E[v]=f[1],e=e.slice(0,f.index)),E[v]=E[v]||a&&l[3]&&t[v]||"",l[4]&&(E[v]=E[v].toLowerCase())):e=l(e,E);r&&(E.query=r(E.query)),a&&t.slashes&&"/"!==E.pathname.charAt(0)&&(""!==E.pathname||""!==t.pathname)&&(E.pathname=function(e,t){if(""===e)return t;for(var r=(t||"/").split("/").slice(0,-1).concat(e.split("/")),n=r.length,o=r[n-1],a=!1,i=0;n--;)"."===r[n]?r.splice(n,1):".."===r[n]?(r.splice(n,1),i++):i&&(0===n&&(a=!0),r.splice(n,1),i--);return a&&r.unshift(""),"."!==o&&".."!==o||r.push(""),r.join("/")}(E.pathname,t.pathname)),"/"!==E.pathname.charAt(0)&&m(E.protocol)&&(E.pathname="/"+E.pathname),n(E.port,E.protocol)||(E.host=E.hostname,E.port=""),E.username=E.password="",E.auth&&(~(f=E.auth.indexOf(":"))?(E.username=E.auth.slice(0,f),E.username=encodeURIComponent(decodeURIComponent(E.username)),E.password=E.auth.slice(f+1),E.password=encodeURIComponent(decodeURIComponent(E.password))):E.username=encodeURIComponent(decodeURIComponent(E.auth)),E.auth=E.password?E.username+":"+E.password:E.username),E.origin="file:"!==E.protocol&&m(E.protocol)&&E.host?E.protocol+"//"+E.host:"null",E.href=E.toString()}y.prototype={set:function(e,t,r){var a=this;switch(e){case"query":"string"==typeof t&&t.length&&(t=(r||o.parse)(t)),a[e]=t;break;case"port":a[e]=t,n(t,a.protocol)?t&&(a.host=a.hostname+":"+t):(a.host=a.hostname,a[e]="");break;case"hostname":a[e]=t,a.port&&(t+=":"+a.port),a.host=t;break;case"host":a[e]=t,c.test(t)?(t=t.split(":"),a.port=t.pop(),a.hostname=t.join(":")):(a.hostname=t,a.port="");break;case"protocol":a.protocol=t.toLowerCase(),a.slashes=!r;break;case"pathname":case"hash":if(t){var i="pathname"===e?"/":"#";a[e]=t.charAt(0)!==i?i+t:t}else a[e]=t;break;case"username":case"password":a[e]=encodeURIComponent(t);break;case"auth":var s=t.indexOf(":");~s?(a.username=t.slice(0,s),a.username=encodeURIComponent(decodeURIComponent(a.username)),a.password=t.slice(s+1),a.password=encodeURIComponent(decodeURIComponent(a.password))):a.username=encodeURIComponent(decodeURIComponent(t))}for(var l=0;l<p.length;l++){var d=p[l];d[4]&&(a[d[1]]=a[d[1]].toLowerCase())}return a.auth=a.password?a.username+":"+a.password:a.username,a.origin="file:"!==a.protocol&&m(a.protocol)&&a.host?a.protocol+"//"+a.host:"null",a.href=a.toString(),a},toString:function(e){e&&"function"==typeof e||(e=o.stringify);var t,r=this,n=r.host,a=r.protocol;a&&":"!==a.charAt(a.length-1)&&(a+=":");var i=a+(r.protocol&&r.slashes||m(r.protocol)?"//":"");return r.username?(i+=r.username,r.password&&(i+=":"+r.password),i+="@"):r.password?(i+=":"+r.password,i+="@"):"file:"!==r.protocol&&m(r.protocol)&&!n&&"/"!==r.pathname&&(i+="@"),(":"===n[n.length-1]||c.test(r.hostname)&&!r.port)&&(n+=":"),i+=n+r.pathname,(t="object"==typeof r.query?e(r.query):r.query)&&(i+="?"!==t.charAt(0)?"?"+t:t),r.hash&&(i+=r.hash),i}},y.extractProtocol=g,y.location=h,y.trimLeft=u,y.qs=o,e.exports=y},8022:(e,t,r)=>{var n=r(4481),o=r(6426),a=o;a.v1=n,a.v4=o,e.exports=a},8725:e=>{for(var t=[],r=0;r<256;++r)t[r]=(r+256).toString(16).substr(1);e.exports=function(e,r){var n=r||0,o=t;return[o[e[n++]],o[e[n++]],o[e[n++]],o[e[n++]],"-",o[e[n++]],o[e[n++]],"-",o[e[n++]],o[e[n++]],"-",o[e[n++]],o[e[n++]],"-",o[e[n++]],o[e[n++]],o[e[n++]],o[e[n++]],o[e[n++]],o[e[n++]]].join("")}},9157:e=>{var t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(t){var r=new Uint8Array(16);e.exports=function(){return t(r),r}}else{var n=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),n[t]=e>>>((3&t)<<3)&255;return n}}},4481:(e,t,r)=>{var n,o,a=r(9157),i=r(8725),s=0,c=0;e.exports=function(e,t,r){var l=t&&r||0,d=t||[],u=(e=e||{}).node||n,p=void 0!==e.clockseq?e.clockseq:o;if(null==u||null==p){var f=a();null==u&&(u=n=[1|f[0],f[1],f[2],f[3],f[4],f[5]]),null==p&&(p=o=16383&(f[6]<<8|f[7]))}var h=void 0!==e.msecs?e.msecs:(new Date).getTime(),m=void 0!==e.nsecs?e.nsecs:c+1,g=h-s+(m-c)/1e4;if(g<0&&void 0===e.clockseq&&(p=p+1&16383),(g<0||h>s)&&void 0===e.nsecs&&(m=0),m>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=h,c=m,o=p;var y=(1e4*(268435455&(h+=122192928e5))+m)%4294967296;d[l++]=y>>>24&255,d[l++]=y>>>16&255,d[l++]=y>>>8&255,d[l++]=255&y;var v=h/4294967296*1e4&268435455;d[l++]=v>>>8&255,d[l++]=255&v,d[l++]=v>>>24&15|16,d[l++]=v>>>16&255,d[l++]=p>>>8|128,d[l++]=255&p;for(var _=0;_<6;++_)d[l+_]=u[_];return t||i(d)}},6426:(e,t,r)=>{var n=r(9157),o=r(8725);e.exports=function(e,t,r){var a=t&&r||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var i=(e=e||{}).random||(e.rng||n)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t)for(var s=0;s<16;++s)t[a+s]=i[s];return t||o(i)}},9479:t=>{"use strict";t.exports=e},7544:e=>{e.exports=function(e,t){return t.get?t.get.call(e):t.value},e.exports.__esModule=!0,e.exports.default=e.exports},2440:e=>{e.exports=function(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}},e.exports.__esModule=!0,e.exports.default=e.exports},2132:e=>{e.exports=function(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)},e.exports.__esModule=!0,e.exports.default=e.exports},7481:(e,t,r)=>{var n=r(7544),o=r(2132);e.exports=function(e,t){var r=o(e,t,"get");return n(e,r)},e.exports.__esModule=!0,e.exports.default=e.exports},4070:(e,t,r)=>{var n=r(2440),o=r(2132);e.exports=function(e,t,r){var a=o(e,t,"set");return n(e,a,r),r},e.exports.__esModule=!0,e.exports.default=e.exports},6290:(e,t,r)=>{var n=r(7739);e.exports=function(e,t,r){return(t=n(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e},e.exports.__esModule=!0,e.exports.default=e.exports},8064:(e,t,r)=>{var n=r(7425).default;e.exports=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports},7739:(e,t,r)=>{var n=r(7425).default,o=r(8064);e.exports=function(e){var t=o(e,"string");return"symbol"==n(t)?t:String(t)},e.exports.__esModule=!0,e.exports.default=e.exports},7425:e=>{function t(r){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}},o={};function a(e){var t=o[e];if(void 0!==t)return t.exports;var r=o[e]={exports:{}};return n[e].call(r.exports,r,r.exports,a),r.exports}a.m=n,a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},r=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,a.t=function(e,n){if(1&n&&(e=this(e)),8&n)return e;if("object"==typeof e&&e){if(4&n&&e.__esModule)return e;if(16&n&&"function"==typeof e.then)return e}var o=Object.create(null);a.r(o);var i={};t=t||[null,r({}),r([]),r(r)];for(var s=2&n&&e;"object"==typeof s&&!~t.indexOf(s);s=r(s))Object.getOwnPropertyNames(s).forEach((t=>i[t]=()=>e[t]));return i.default=()=>e,a.d(o,i),o},a.d=(e,t)=>{for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},a.f={},a.e=e=>Promise.all(Object.keys(a.f).reduce(((t,r)=>(a.f[r](e,t),t)),[])),a.u=e=>"formulajs.chunk.min.js",a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.p="https://static.parastorage.com/services/dbsm-viewer-app/cf52e35d048750a5808856603057ab255661d6d16f74d95970a5636d/webworker/",(()=>{var e={143:1};a.f.i=(t,r)=>{e[t]||importScripts(a.p+a.u(t))};var t=("undefined"!=typeof self?self:this).webpackJsonp__wix_dbsm_viewer_app=("undefined"!=typeof self?self:this).webpackJsonp__wix_dbsm_viewer_app||[],r=t.push.bind(t);t.push=t=>{var[n,o,i]=t;for(var s in o)a.o(o,s)&&(a.m[s]=o[s]);for(i&&i(a);n.length;)e[n.pop()]=1;r(t)}})();var i={};return(()=>{"use strict";a.r(i),a.d(i,{createControllers:()=>bm,initAppForPage:()=>Om});var e={};a.r(e),a.d(e,{READ:()=>Ue,READ_WRITE:()=>Me,WRITE:()=>ke});var t={};a.r(t),a.d(t,{t:()=>hr,ROUTER_DATASET:()=>mr});var r={};a.r(r),a.d(r,{DBSMViewer:()=>co,DBSMViewerNext:()=>po,UserErrors:()=>lo,WixData:()=>uo});var n=a(5965);const o={"tpa/addVariantToCart":async({wixSdk:e,currentItem:t})=>{var r;const{window:o,location:a,site:i}=e,s=await i.getPublicAPI(n.WIX_STORES),c="Mobile"===o.formFactor;if(t.managedVariant)await s.cart.addProducts([{productId:t.productId,quantity:1,options:{choices:t.choices}}]),c?await s.navigate.toCart():s.cart.showMinicart();else if(c){const e=await s.product.getRelativeProductUrl({id:t.productId});null===(r=a.to)||void 0===r||r.call(a,e)}else await s.product.openQuickView(t.productId)},"tpa/addProductToCart":async({wixSdk:e,currentItem:t})=>{var r;const{window:o,location:a,site:i}=e,s=await i.getPublicAPI(n.WIX_STORES),c="Mobile"===o.formFactor;var l;(l=t).customFields&&l.customFields.length>0||Object.keys(l.productOptions||{}).length>0?c?null===(r=a.to)||void 0===r||r.call(a,t.productPageUrl):await s.product.openQuickView(t._id):(await s.cart.addProducts([{productId:t._id,quantity:1}]),c?await s.navigate.toCart():s.cart.showMinicart())},"tpa/quicklyViewProduct":async({wixSdk:e,currentItem:t})=>{const r=await e.site.getPublicAPI(n.WIX_STORES);await r.product.openQuickView(t._id)},"tpa/purchasePricingPlan":async({wixSdk:e,currentItem:t})=>{await e["pricing-plans"].checkout.startOnlinePurchase(t._id)},"tpa/pricingPlansNavigateToCheckout":async({wixSdk:e,currentItem:t})=>{await e["pricing-plans"].customPurchaseFlow.navigateToCheckout({planId:t._id})}};a(3741);var s=a(4846),c=a.n(s);var l=a(4361);const{text:d,boolean:u,number:p,dateTime:f,date:h,richText:m,url:g,reference:y,stringArray:v}=l.FieldType,_=[d,m,u,f,h,y,p,g,v];var I=a(8022);const E=({httpClient:e})=>({reportFormEventToAutomationCreator:()=>async({detailedEventPayload:t,eventUTCTime:r})=>{const n={eventIdentifier:{eventUniqueId:(0,I.v4)(),eventType:"form/form/code",sourceUniqueId:"675bbcef-18d8-41f5-800e-131ec9e08762"},eventUTCTime:r,detailedEventPayload:t};await e.post("/_api/action-triggers-server/v1/report-event",n)}});var T=a(6290),S=a.n(T);class R extends Error{static withMessage(e){return class extends(this){constructor(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];super(e,...r)}}}static with(e){let{message:t,options:r}=e;return class extends(this){constructor(e){super(t||e instanceof String&&e,{...r,...e instanceof Object?e:{}})}}}constructor(e,t,r){void 0===r&&(r="DataBindingError"),super(e,t);const{cause:n,...o}=t||{};this.name=r,this.options=o,this.cause||(this.cause=n)}toString(){return this.cause?super.toString()+"\nCaused by "+this.cause.toString():super.toString()}}S()(R,"scopes",{USER_SCOPE:"userCodeZone",APPLICATION_SCOPE:"applicationCodeZone",SERVER_SCOPE:"wixDataCodeZone"});class w extends R{constructor(e,t){super(e,t,"AppError"),this.scope=R.scopes.APPLICATION_SCOPE}}class O extends R{constructor(e,t,r){void 0===r&&(r="UserError"),super(e,t,r),this.scope=R.scopes.USER_SCOPE}}class b extends O{constructor(e,t){const{code:r,...n}=t;super(e,n,"DatasetError"),this.code=r}}class C extends O{constructor(e,t){super(e,t,"ServerValidationError")}}S()(C,"codes",["WD_SITE_IN_TEMPLATE_MODE","WD_PERMISSION_DENIED","WD_COLLECTION_DELETED","WD_VALIDATION_FAILED"]);class P extends R{constructor(e,t){const{code:r,...n}=t;super(e,n,"ServerError"),this.scope=R.scopes.SERVER_SCOPE,this.code=r}}class N extends R{constructor(e){super("Async operation error wasn't handled",e,"UnhandledPromiseRejection")}}var D=a(9479),A=a(7481),x=a.n(A);function L(e,t,r){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,r)}var F=new WeakMap;const M=new class{constructor(){L(this,F,{writable:!0,value:new Proxy({},{get(e,t){if(e[t])return e[t];throw new ReferenceError("There is no "+t+" in context. Check if the context has been already set")}})})}set(e){Object.entries(e).forEach((e=>{let[t,r]=e;x()(this,F)[t]=r}))}get(){return x()(this,F)}},U=M.get(),k=M.set.bind(M);class G{constructor(e){this._context=e,this._eventToListener=new W}dispatch(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return this._eventToListener.has(e)?this._eventToListener.get(e).reduce(((t,n)=>[...t,U.errorReporting(n,w.with({message:e+" listener failed",options:{extra:this._context}}))(this._context,...r)]),[]):void 0}subscribe(e,t){return e.constructor===Object?Object.entries(e).reduce(((e,t)=>{let[r,n]=t;return[...e,this.subscribe(r,n)]}),[]):(this._eventToListener.getOrDefault(e,new q).add(t),()=>this.unsubscribe(e,t))}unsubscribe(e,t){return this._eventToListener.has(e)&&this._eventToListener.get(e).delete(t)}}class j{constructor(){var e=this;this.promise=new Promise(((t,r)=>{this.resolve=function(){return t(...arguments),e.promise},this.reject=function(){return r(...arguments),e.promise}}))}}const B=(e,t)=>function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];try{const r=e(...n);return(null==r?void 0:r.catch)instanceof Function?r.catch((e=>t(e,...n))):r}catch(e){return t(e,...n)}},V=e=>null!=e&&e.then?e:{then:t=>t(e)};class W extends Map{getOrDefault(e,t){return this.has(e)?this.get(e):this.set(e,t).get(e)}find(e){const[,t]=Array.from(this).find((t=>{let[r,n]=t;return e(n,r,this)}))||[];return t}}class q extends Set{reduce(e,t){return Array.from(this).reduce(((t,r,n)=>e(t,r,n,this)),t)}}const H="unknown",$=e=>{const t=e.split("/"),r=t[t.length-3],n=t[t.length-2];if(!/^\d+\.\d+\.\d+$/.test(n))throw new Error(`Invalid version string ${n}`);return{appName:r,version:n}},z=e=>{try{const{appName:t,version:r}=$(e);return`${t}@${r}`}catch(e){return H}},Y=()=>{const e=new Error;return e.stack?e.stack.toString():""},X=e=>{const t=Y().match(new RegExp(`https?://.*?${e}.*?.js`));return t?t[0]:""},J="detailsRepeaterRole",K="detailsDatasetRole",Q="filterInputRole",Z="textRole",ee="galleryRole",te="mediaGalleryRole",re="ratingsDisplayRole",ne="dropdownOptionsRole",oe="MobuiPickerOptionsRole",ae="gridRole",ie="datepickerRole",se="radioGroupRole",ce="uploadButtonRole",le="repeaterRole",de="pageRole",ue="paginationRole",pe="addressInputRole",fe="googleMapRole",he="timePickerRole",me="progressBarRole",ge="selectionTagsOptionsRole",ye="signatureInputRole",ve="richContentRole",_e="userInputFilterDropdownRole",Ie="userInputFilterCheckboxRole",Ee="userInputFilterRadioGroupRole",Te="userInputFilterCheckboxGroupRole",Se="userInputFilterSelectionTagsRole",Re="userInputFilterRangeSliderRole",we=[_e,Ie,Ee,Te,Se,Re],Oe="RESET_ALL",be=[_e,Ee,Te,Se],Ce=new Map([["new","add"]]),Pe="dbsm-viewer-app";class Ne{constructor(e){let{collectionId:t,collectionName:r,componentType:o,datasetId:a,datasetMode:i,datasetType:s,fieldType:c,filteredBy:l,id:d,numberOfResults:u,pageId:p,pageUrl:f,viewMode:h}=e;this.type=Ne.types.EVENT,this.event={pageId:p,src:79,ver:z(X(Pe)),app_name:Pe,app_id:n.DATA_BINDING,evid:d,ds_id:a,ds_type:s,mode:i,collection_name:r,collection_id:t,component_type:o,filtered_by:l,field_type:c,number_of_results:u,viewmode:h,page_url:f}}}S()(Ne,"types",{EVENT:"event",ERROR:"error"});class De extends Ne{constructor(e){let{message:t,code:r}=e;super({}),this.type=Ne.types.ERROR;const n=(e=>{if((0,D.isString)(e)){const t=e.replace(/\D/g,""),r=parseInt(t);if(Number.isNaN(r))return 1}return(0,D.isNumber)(e)?Number.isNaN(e)?1:e:1})(r);this.event={evid:10,src:79,dsc:t,errn:t,errc:n}}}class Ae{constructor(e,t,r){const{type:n,fn:o}=t instanceof Function?{type:Ae.types.TRACE,fn:t}:{type:t};this.name=e,this.params=r,this.run=()=>this._handlerByType[n](o),this.onStart=e=>this._start=e,this.onEnd=e=>this._end=e,this._start=()=>{},this._end=()=>{},this._handlerByType={[Ae.types.TRACE]:e=>(this._start(),V(e()).then((e=>(this._end(),e)))),[Ae.types.START]:()=>this._start(),[Ae.types.END]:()=>this._end()}}}S()(Ae,"types",{START:"START",END:"END",TRACE:"TRACE"});class xe{static with(e){let{category:t,message:r,level:n,data:o}=e;return class extends(this){constructor(e){let{category:a=t,message:i=r,level:s=n,data:c}=e;super({category:a,message:i,level:s,data:c||o?{...c,...o}:void 0})}}}constructor(e){let{category:t,message:r,level:n="info",data:o}=e;this.event={category:t,message:r,level:n,data:o}}}class Le{static with(e){return class extends(this){constructor(t,r){void 0===r&&(r={}),super(t,{...e,...r})}}}constructor(e,t){this._builderByType={[Le.types.DS_API.CALLED]:e=>{let{methodName:t,args:r}=e;return 0===r.length?["[wix-dataset."+t+"] called"]:["[wix-dataset."+t+"] called with (",JSON.stringify(r),")"]},[Le.types.DS_API.SUCCED]:e=>{let{methodName:t,result:r}=e;return void 0===r?["[wix-dataset."+t+"] returned"]:["[wix-dataset."+t+"] returned with (",JSON.stringify(r),")"]},[Le.types.DS_API.DEPRECATED]:e=>{let{methodName:t,replacementMethodName:r}=e;return["[wix-dataset."+t+"] is deprecated"+(r?"; use [wix-dataset."+r+"] instead":"")]},[Le.types.DS_API.REGISTERED]:e=>{let{methodName:t}=e;return["["+t+" callback registered] on wix-dataset"]},[Le.types.DS_API.TRIGGERED]:e=>{let{eventName:t,eventArgs:r=[]}=e;if(r.length){const e=r.map((e=>e instanceof Error?e.toString():e));return["["+t+" event] triggered on wix-dataset with (",JSON.stringify(e),")"]}return["["+t+" event] triggered on wix-dataset"]}},this._context=t,this.messages=this._builderByType[e](t)}_getComponentPresentation(){const{component:{nickname:e,parentRepeater:t}}=this._context;return t?"#"+t.nickname+".#"+e:"#"+e}}S()(Le,"types",{DS_API:{CALLED:"DS_API_CALLED",SUCCED:"DS_API_SUCCED",DEPRECATED:"DS_API_DEPRECATED",REGISTERED:"DS_API_REGISTERED",TRIGGERED:"DS_API_TRIGGERED"}});class Fe{constructor(e,t){void 0===t&&(t="log"),this.message=e,this.level=t}}const Me="READ_WRITE",Ue="READ",ke="WRITE",Ge=(e,t)=>[ae,ue].includes(e)||t&&t.properties&&Object.keys(t.properties).length>0;var je=a(477);const Be=Object.keys,Ve=(Object.values,Object.entries),We=e=>null!=e,qe={AddressInput:{viewerType:["wixui.AddressInput"],sdkType:"$w.AddressInput"},Text:{viewerType:["wysiwyg.viewer.components.WRichText"],sdkType:"$w.Text"},Image:{viewerType:["wysiwyg.viewer.components.WPhoto","wixui.ImageX"],sdkType:"$w.Image"},TextInput:{viewerType:["wysiwyg.viewer.components.inputs.TextInput"],sdkType:"$w.TextInput"},TimePicker:{viewerType:["wixui.TimePicker"],sdkType:"$w.TimePicker"},Button:{viewerType:["wysiwyg.viewer.components.SiteButton"],sdkType:"$w.Button"},IconButton:{viewerType:["wysiwyg.common.components.imagebutton.viewer.ImageButton"],sdkType:"$w.IconButton"},RatingsDisplay:{viewerType:["wixui.RatingsDisplay"],sdkType:"$w.RatingsDisplay"},RatingsInput:{viewerType:["wixui.RatingsInput"],sdkType:"$w.RatingsInput"},VerticalMenu:{viewerType:["wysiwyg.common.components.verticalmenu.viewer.VerticalMenu"],sdkType:"$w.VerticalMenu"},Checkbox:{viewerType:["wysiwyg.viewer.components.inputs.Checkbox"],sdkType:"$w.Checkbox"},Gallery:{viewerType:["wysiwyg.viewer.components.MatrixGallery","wysiwyg.viewer.components.SliderGallery","wysiwyg.viewer.components.SlideShowGallery","wysiwyg.viewer.components.PaginatedGridGallery","wysiwyg.viewer.components.tpapps.TPAWidget"],sdkType:"$w.Gallery"},Dropdown:{viewerType:["wysiwyg.viewer.components.inputs.ComboBoxInput","wixui.Dropdown"],sdkType:"$w.Dropdown"},TextBox:{viewerType:["wysiwyg.viewer.components.inputs.TextAreaInput"],sdkType:"$w.TextBox"},RichTextBox:{viewerType:["wixui.RichTextBox"],sdkType:"$w.RichTextBox"},Table:{viewerType:["wysiwyg.viewer.components.Grid"],sdkType:"$w.Table"},DatePicker:{viewerType:["wysiwyg.viewer.components.inputs.DatePicker"],sdkType:"$w.DatePicker"},RadioButtonGroup:{viewerType:["wysiwyg.viewer.components.inputs.RadioGroup"],sdkType:"$w.RadioButtonGroup"},UploadButton:{viewerType:["wysiwyg.viewer.components.inputs.UploadButton","wixui.FileUploaderNew","wysiwyg.viewer.components.inputs.FileUploader"],sdkType:"$w.UploadButton"},ClassicSection:{viewerType:["wysiwyg.viewer.components.ClassicSection"],sdkType:"$w.Section"},Column:{viewerType:["wysiwyg.viewer.components.Column"],sdkType:"$w.Column"},Video:{viewerType:["wysiwyg.viewer.components.Video"],sdkType:"$w.Video"},VideoPlayer:{viewerType:["wixui.VideoPlayer"],sdkType:"$w.VideoPlayer"},VideoBox:{viewerType:["wysiwyg.viewer.components.MediaPlayer"],sdkType:"$w.VideoBox"},MusicPlayer:{viewerType:["wixui.MusicPlayer"],sdkType:"$w.AudioPlayer"},Repeater:{viewerType:["wysiwyg.viewer.components.Repeater"],sdkType:"$w.Repeater"},Pagination:{viewerType:["wixui.Pagination"],sdkType:"$w.Pagination"},Page:{viewerType:["mobile.core.components.Page"],sdkType:"$w.Page"},Document:{viewerType:["fake-document-type"],sdkType:"$w.Document"},MediaContainer:{viewerType:["wysiwyg.viewer.components.MediaContainer"],sdkType:"$w.Container"},StripColumnsContainer:{viewerType:["wysiwyg.viewer.components.StripColumnsContainer"],sdkType:"$w.ColumnStrip"},ToggleSwitch:{viewerType:["wixui.ToggleSwitch"],sdkType:"$w.Switch"},Slider:{viewerType:["wixui.Slider"],sdkType:"$w.Slider"},RangeSlider:{viewerType:["wixui.RangeSlider"],sdkType:"$w.RangeSlider"},StylableButton:{viewerType:["wixui.StylableButton"],sdkType:"$w.StylableButton"},GoogleMap:{viewerType:["wysiwyg.viewer.components.GoogleMap"],sdkType:"$w.GoogleMap"},CheckboxGroup:{viewerType:["wysiwyg.viewer.components.inputs.CheckboxGroup"],sdkType:"$w.CheckboxGroup"},ProgressBar:{viewerType:["wixui.ProgressBar"],sdkType:"$w.ProgressBar"},VectorImage:{viewerType:["wysiwyg.viewer.components.VectorImage","wysiwyg.viewer.components.svgshape.SvgShape"],sdkType:"$w.VectorImage"},SelectionTags:{viewerType:["wixui.SelectionTagsList"],sdkType:"$w.SelectionTags"},Section:{viewerType:["responsive.components.Section"],sdkType:"$w.Section"},SignatureInput:{viewerType:["wixui.SignatureInput"],sdkType:"$w.SignatureInput"},RefComponent:{viewerType:["wysiwyg.viewer.components.RefComponent"],sdkType:"$w.RefComponent"},RichContent:{viewerType:["wysiwyg.viewer.components.tpapps.TPAWidget"],sdkType:"$w.RichContent"},AppController:{viewerType:["platform.components.AppController"],sdkType:"$w.AppController"},SlideshowRepeater:{viewerType:["wixui.Slideshow"],sdkType:"$w.Slideshow"}},He=(0,D.mapValues)(qe,(({sdkType:e})=>e)),{AddressInput:$e,RatingsInput:ze,TextInput:Ye,TextBox:Xe,RichTextBox:Je,Checkbox:Ke,DatePicker:Qe,RadioButtonGroup:Ze,Dropdown:et,UploadButton:tt,ToggleSwitch:rt,Slider:nt,TimePicker:ot,CheckboxGroup:at,SelectionTags:it,SignatureInput:st}=(Be(qe).reduce(((e,t)=>(e.concat(qe[t].viewerType),e)),[]),Be(qe).map((e=>qe[e].viewerType)).reduce(((e,t)=>e.concat(t)),[]).reduce(((e,t)=>(e[t.split(".").reverse()[0]]=t,e)),{}),Be(qe).map((e=>qe[e].sdkType)),He),ct=[{type:$e,role:pe},{type:ze,role:"ratingsInputRole"},{type:Ye,role:"textInputRole"},{type:Xe,role:"textAreaRole"},{type:Je,role:"richTextBoxRole"},{type:Ke,role:"checkboxRole"},{type:Qe,role:ie},{type:Ze,role:se},{type:et,role:"dropdownRole"},{type:tt,role:ce},{type:rt,role:"toggleSwitchRole"},{type:nt,role:"sliderRole"},{type:ot,role:he},{type:at,role:"checkboxGroupRole"},{type:it,role:"selectionTagsRole"},{type:st,role:ye}],lt=(ct.map((e=>e.type)),ct.map((e=>e.role))),dt=e=>e.some((e=>{return t=(0,D.get)(e,"role"),lt.includes(t);var t})),ut=(e,t)=>(e=>[ke,Me].includes(e))(e)&&(e=>e.some((e=>"save"===(0,D.get)(e,"config.events.onClick.action"))))(t)&&dt(t);function pt(e){return pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pt(e)}function ft(e){var t=function(e,t){if("object"!=pt(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=pt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==pt(t)?t:String(t)}function ht(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function mt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ht(Object(r),!0).forEach((function(t){var n,o,a;n=e,o=t,a=r[t],(o=ft(o))in n?Object.defineProperty(n,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[o]=a})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ht(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function gt(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var yt="function"==typeof Symbol&&Symbol.observable||"@@observable",vt=function(){return Math.random().toString(36).substring(7).split("").join(".")},_t={INIT:"@@redux/INIT"+vt(),REPLACE:"@@redux/REPLACE"+vt(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+vt()}};function It(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function Et(e,t,r){var n;if("function"==typeof t&&"function"==typeof r||"function"==typeof r&&"function"==typeof arguments[3])throw new Error(gt(0));if("function"==typeof t&&void 0===r&&(r=t,t=void 0),void 0!==r){if("function"!=typeof r)throw new Error(gt(1));return r(Et)(e,t)}if("function"!=typeof e)throw new Error(gt(2));var o=e,a=t,i=[],s=i,c=!1;function l(){s===i&&(s=i.slice())}function d(){if(c)throw new Error(gt(3));return a}function u(e){if("function"!=typeof e)throw new Error(gt(4));if(c)throw new Error(gt(5));var t=!0;return l(),s.push(e),function(){if(t){if(c)throw new Error(gt(6));t=!1,l();var r=s.indexOf(e);s.splice(r,1),i=null}}}function p(e){if(!It(e))throw new Error(gt(7));if(void 0===e.type)throw new Error(gt(8));if(c)throw new Error(gt(9));try{c=!0,a=o(a,e)}finally{c=!1}for(var t=i=s,r=0;r<t.length;r++){(0,t[r])()}return e}return p({type:_t.INIT}),(n={dispatch:p,subscribe:u,getState:d,replaceReducer:function(e){if("function"!=typeof e)throw new Error(gt(10));o=e,p({type:_t.REPLACE})}})[yt]=function(){var e,t=u;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new Error(gt(11));function r(){e.next&&e.next(d())}return r(),{unsubscribe:t(r)}}})[yt]=function(){return this},e},n}function Tt(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}function St(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){return function(){var r=e.apply(void 0,arguments),n=function(){throw new Error(gt(15))},o={getState:r.getState,dispatch:function(){return n.apply(void 0,arguments)}},a=t.map((function(e){return e(o)}));return n=Tt.apply(void 0,a)(r.dispatch),mt(mt({},r),{},{dispatch:n})}}}const Rt={collectionName:null,readWriteType:Ue,filter:null,sort:null,includes:null,nested:[],pageSize:12,deferred:!1},wt="SET_CURRENT_RECORD",Ot="UPDATE_FIELDS",bt="REFRESH_CURRENT_RECORD",Ct="REFRESH_CURRENT_VIEW",Pt="INCREMENT_NUM_PAGES_TO_SHOW",Nt="SET_DEFAULT_RECORD",Dt="GO_TO_INDEX",At="GO_TO_NEXT_PAGE",xt="GO_TO_PREVIOUS_PAGE",Lt="LOAD_PAGE",Ft="GET_RECORD_BY_INDEX_RESULT",Mt="CURRENT_VIEW_UPDATED",Ut="REVERT_CHANGES",kt="RECORD_REVERTED",Gt="SAVE_RECORD",jt="SAVE_RECORD_RESULT",Bt="REMOVE_CURRENT_RECORD",Vt="REMOVE_CURRENT_RECORD_RESULT",Wt="NEW_RECORD",qt="NEW_RECORD_RESULT",Ht="REFRESH",$t="SET_USER_INPUT_OPTION_VALUES",zt={INIT:"INIT",SET_PAGINATION_DATA:"SET_PAGINATION_DATA"},Yt=zt,Xt=e=>{let{controllerConfig:t={},connections:r=[],isScoped:n=!1,datasetType:o}=e;return{type:zt.INIT,datasetConfig:t.dataset||{},connections:r,isScoped:n,datasetType:o}},Jt=e=>({type:zt.SET_PAGINATION_DATA,paginationData:e}),Kt="SET_FILTER",Qt="SET_SORT",Zt="SET_IS_DATASET_READY",er="SET_FIXED_FILTER_ITEM",tr=e=>null==e?void 0:e.readWriteType,rr=e=>null==e?void 0:e.pageSize,nr=tr,or=e=>{let{error:t,payload:r}=e;return t?je.Result.Error(r):je.Result.Ok(r)},ar={currentRecord:{index:void 0,data:void 0,fieldsToUpdate:void 0,updateSource:void 0},lastSavedRecord:{index:void 0,data:void 0},desiredIndex:void 0,refreshCurrentRecord:!1,removeCurrentRecord:!1,newRecordIndex:null,refreshCurrentView:!1,refreshController:!1,setFilterCalled:!1,revertChanges:!1,saveRecord:!1,defaultRecord:void 0,isForm:void 0,page:{numPagesToShow:1,offset:0,size:Rt.pageSize},schema:void 0,userFilterInitialData:null,isApplyUserInputFiltersActionBindingPresent:!1},ir=e=>((e,t)=>(0,D.inRange)(e,ur(t).offset,ur(t).offset+ur(t).size))(pr(e),e),sr=e=>e.some((e=>"applyUserInputFilters"===(0,D.get)(e,"config.events.onClick.action"))),cr=(e,t,r,n)=>{const o={...e,currentRecord:{index:t,data:r,updateSource:n},desiredIndex:t,refreshCurrentRecord:!1,refreshController:!1};return ir(o)?o:{...o,page:{...o.page,offset:Math.floor(o.currentRecord.index/o.page.size)*o.page.size,numPagesToShow:1}}},lr=e=>e.page.size,dr=e=>e.currentRecord.data,ur=e=>e.page,pr=e=>e.currentRecord.index,fr={reducer:function(e,t){switch(void 0===e&&(e=ar),t.type){case wt:{const{recordIndex:r,record:n,updateSource:o}=t;return cr(e,r,n,o)}case Wt:return{...e,newRecordIndex:t.atIndex};case qt:return or(t).fold((()=>({...e,newRecordIndex:null})),(t=>({...cr(e,e.newRecordIndex,t),newRecordIndex:null})));case Ot:{const{fieldsToUpdate:r,updateSource:n}=t;return{...e,currentRecord:{...e.currentRecord,fieldsToUpdate:r,updateSource:n}}}case Dt:return{...e,desiredIndex:t.index};case Ft:return or(t).fold((()=>({...e,desiredIndex:e.currentRecord.index,refreshCurrentRecord:!1,refreshController:!1})),(t=>t.matchWith({Record:t=>{let{index:r,record:n}=t;return cr(e,r,n)},InvalidIndex:()=>({...e,desiredIndex:e.currentRecord.index,refreshCurrentRecord:!1}),NoRecord:()=>cr(e,null,null)})));case bt:return{...e,refreshCurrentRecord:!0};case Bt:return{...e,removeCurrentRecord:!0};case Vt:return or(t).fold((()=>({...e,removeCurrentRecord:!1})),(()=>({...e,removeCurrentRecord:!1,refreshCurrentRecord:!0})));case Ct:return{...e,refreshCurrentView:!0};case Mt:return{...e,refreshCurrentView:!1};case Ut:return{...e,revertChanges:!0};case kt:return{...e,revertChanges:!1};case Nt:{const{record:r}=t;return{...e,defaultRecord:r}}case Yt.INIT:{const{datasetConfig:r,connections:n}=t,o=rr(r),a=nr(r);return{...e,isForm:ut(a,n),page:{...e.page,size:o||e.page.size},isApplyUserInputFiltersActionBindingPresent:sr(n)}}case Yt.SET_PAGINATION_DATA:{const r={...e,page:{...e.page,...t.paginationData}};return ir(r)?r:{...r,desiredIndex:r.page.offset}}case At:{const t=ur(e),r=lr(e),n=t.offset+r,o={...e,page:{...e.page,numPagesToShow:1,offset:n}};return ir(o)?o:{...o,desiredIndex:o.page.offset}}case xt:{const t=ur(e),r=Math.max(0,t.offset-t.size),n={...e,page:{...e.page,numPagesToShow:1,offset:r}};return ir(n)?n:{...n,desiredIndex:n.page.offset}}case Lt:{const{size:r}=ur(e),n={...e,page:{...e.page,numPagesToShow:1,offset:r*(t.pageNumber-1)}};return ir(n)?n:{...n,desiredIndex:n.page.offset}}case Pt:return{...e,page:{...e.page,numPagesToShow:e.page.numPagesToShow+1}};case Gt:return{...e,saveRecord:!0,lastSavedRecord:{index:void 0,data:void 0}};case jt:return or(t).fold((()=>({...e,saveRecord:!1})),(t=>({...e,saveRecord:!1,lastSavedRecord:{index:e.currentRecord.index,data:t}})));case Kt:return{...e,setFilterCalled:!0,refreshController:!0};case Qt:case Ht:return{...e,refreshController:!0};case $t:return{...e,userFilterInitialData:t.userFilterInitialData};default:return e}},getPaginationData:ur,hasCurrentRecord:e=>!!dr(e),selectDefaultDraft:e=>({...e.defaultRecord}),selectCurrentRecord:dr,selectCurrentRecordIndex:pr,selectDesiredRecordIndex:e=>e.desiredIndex,selectFieldsToUpdate:e=>e.currentRecord.fieldsToUpdate,selectLastSavedRecord:e=>e.lastSavedRecord.data,selectLastSavedRecordIndex:e=>e.lastSavedRecord.index,selectRefreshCurrentRecord:e=>e.refreshCurrentRecord,selectRemoveCurrentRecord:e=>e.removeCurrentRecord,selectRefreshController:e=>e.refreshController,selectSetFilterCalled:e=>e.setFilterCalled,selectRefreshCurrentView:e=>e.refreshCurrentView,selectRevertChanges:e=>e.revertChanges,selectSaveRecord:e=>e.saveRecord,selectUpdateSource:e=>e.currentRecord.updateSource,selectNewRecordIndex:e=>e.newRecordIndex,isDuringSave:e=>e.saveRecord,isForm:e=>e.isForm,getUserFilterInitialData:e=>e.userFilterInitialData,selectIsApplyUserInputFiltersActionBindingPresent:e=>e.isApplyUserInputFiltersActionBindingPresent},hr="dataset",mr="router_dataset",gr=e=>{var t;const{prop:r,fieldName:n}=null!=(t=null==e?void 0:e.userInputFilter)?t:{};return!(!r||!n)},{WRITE:yr}=e,{ROUTER_DATASET:vr}=t,_r=["collectionName","readWriteType","includes","cursor"],Ir=["filter","sort"],Er=e=>(0,D.pick)(e,_r),Tr=e=>(0,D.pick)(e,Ir),Sr=e=>{let{datasetConfig:t,connections:r,isScoped:n,datasetType:o}=e;const a=o===vr,i=r.some((e=>{let{role:t}=e;return t===K})),s=n,c=!n,l=t.readWriteType===yr;return{datasetIsRouter:a,datasetIsMaster:i,datasetIsVirtual:s,datasetIsReal:c,datasetIsDeferred:Boolean(t.deferred)&&!(s||i||a||l),dynamicPageNavComponentsShouldBeLinked:a&&c,userFilterConnectionProps:r.filter((e=>{let{role:t,config:r}=e;return we.includes(t)&&gr(r)})).map((e=>{let{config:{userInputFilter:t},role:r}=e;return{...t,role:r}}))}},Rr=(e,t)=>({...e,transientData:{...e.transientData,...t}}),wr={canonicalData:Er(Rt),canonicalCalculatedData:{},transientData:{isDatasetReady:!1,...Tr(Rt)}},Or={reducer:function(e,t){switch(void 0===e&&(e=wr),t.type){case Yt.INIT:{const{datasetConfig:r,connections:n,isScoped:o,datasetType:a}=t;return{...e,canonicalData:{...e.canonicalData,...Er(t.datasetConfig)},canonicalCalculatedData:Sr({datasetConfig:r,connections:n,isScoped:o,datasetType:a}),transientData:{...e.transientData,...Tr(t.datasetConfig)}}}case Kt:{const{filter:r}=t;return Rr(e,{filter:r})}case Qt:{const{sort:r}=t;return Rr(e,{sort:r})}case Zt:{const{isDatasetReady:r}=t;return Rr(e,{isDatasetReady:r})}case er:{const{fixedFilterItem:r}=t;return Rr(e,{fixedFilterItem:r})}default:return e}},isWriteOnly:e=>(0,D.get)(e,["canonicalData","readWriteType"])===ke,isReadOnly:e=>(0,D.get)(e,["canonicalData","readWriteType"])===Ue,getReadWriteMode:e=>(0,D.get)(e,["canonicalData","readWriteType"]),isDatasetReady:e=>(0,D.get)(e,["transientData","isDatasetReady"]),isDatasetConfigured:e=>!!(0,D.get)(e,["canonicalData","collectionName"]),isCursorPagingRequired:e=>!!(0,D.get)(e,["canonicalData","cursor"]),isDatasetRouter:e=>{let{canonicalCalculatedData:{datasetIsRouter:t}}=e;return t},isDatasetMaster:e=>{let{canonicalCalculatedData:{datasetIsMaster:t}}=e;return t},isDatasetVirtual:e=>{let{canonicalCalculatedData:{datasetIsVirtual:t}}=e;return t},isDatasetReal:e=>{let{canonicalCalculatedData:{datasetIsReal:t}}=e;return t},isDatasetDeferred:e=>{let{canonicalCalculatedData:{datasetIsDeferred:t}}=e;return t},shouldLinkDynamicPageNavComponents:e=>{let{canonicalCalculatedData:{dynamicPageNavComponentsShouldBeLinked:t}}=e;return t},getUserFilterConnectionProps:e=>{let{canonicalCalculatedData:{userFilterConnectionProps:t}}=e;return t},getFixedFilterItem:e=>(0,D.get)(e,["transientData","fixedFilterItem"]),getFilter:e=>(0,D.get)(e,["transientData","filter"]),getSort:e=>(0,D.get)(e,["transientData","sort"]),getIncludes:e=>(0,D.get)(e,["canonicalData","includes"])||[],getCollectionName:e=>(0,D.get)(e,["canonicalData","collectionName"])},br="NEXT_DYNAMIC_PAGE_URL_RESULT",Cr="PREVIOUS_DYNAMIC_PAGE_URL_RESULT",Pr="INITIALIZE",Nr=(0,je.union)("DynamicPageUrlLoadState",{Empty(){},Loading(){},Loaded:e=>{if(!e)throw new Error("url must exist");return{url:e}}},{hasUrl:e=>()=>e.matchWith({Empty:()=>!1,Loading:()=>!1,Loaded:()=>!0}),shouldLoadUrl:e=>()=>e.matchWith({Empty:()=>!1,Loading:()=>!0,Loaded:()=>!1})});Nr.fromUrl=e=>e?Nr.Loaded(e):Nr.Empty();const Dr=Nr,{fromUrl:Ar}=Nr,xr={nextDynamicPageUrl:Dr.Empty(),previousDynamicPageUrl:Dr.Empty()},Lr=e=>{const t=(e=>{const t=e.filter((e=>!!(0,D.get)(e,"config.events.onClick.action")));return new Set(t.map((e=>(0,D.get)(e,"config.events.onClick.action"))))})(e),r=e=>e?Dr.Loading():Dr.Empty();return{nextDynamicPageUrl:r(t.has("nextDynamicPage")),previousDynamicPageUrl:r(t.has("previousDynamicPage"))}},Fr={reducer:function(e,t){switch(void 0===e&&(e=xr),t.type){case Pr:return{...e,...Lr(t.connections)};case br:return{...e,nextDynamicPageUrl:Dr.fromUrl(t.payload)};case Cr:return{...e,previousDynamicPageUrl:Dr.fromUrl(t.payload)};default:return e}},selectNextDynamicPageUrl:e=>e.nextDynamicPageUrl,selectPreviousDynamicPageUrl:e=>e.previousDynamicPageUrl},Mr=function(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++){var o=t[n];0,"function"==typeof e[o]&&(r[o]=e[o])}var a,i=Object.keys(r);try{!function(e){Object.keys(e).forEach((function(t){var r=e[t];if(void 0===r(void 0,{type:_t.INIT}))throw new Error(gt(12));if(void 0===r(void 0,{type:_t.PROBE_UNKNOWN_ACTION()}))throw new Error(gt(13))}))}(r)}catch(e){a=e}return function(e,t){if(void 0===e&&(e={}),a)throw a;for(var n=!1,o={},s=0;s<i.length;s++){var c=i[s],l=r[c],d=e[c],u=l(d,t);if(void 0===u){t&&t.type;throw new Error(gt(14))}o[c]=u,n=n||u!==d}return(n=n||i.length!==Object.keys(e).length)?o:e}}({records:fr.reducer,config:Or.reducer,dynamicPages:Fr.reducer}),Ur=e=>Or.getCollectionName(e.config),kr=e=>Or.getFilter(e.config),Gr=e=>Or.getSort(e.config),jr=e=>fr.getPaginationData(e.records),Br=e=>Or.getReadWriteMode(e.config),Vr=e=>Or.isDatasetConfigured(e.config),Wr=e=>Or.isDatasetReady(e.config),qr=e=>Or.isReadOnly(e.config),Hr=e=>Or.isWriteOnly(e.config),$r=e=>(e=>fr.hasCurrentRecord(e.records))(e)&&!qr(e),zr=e=>Or.isDatasetRouter(e.config),Yr=e=>Or.isDatasetMaster(e.config),Xr=e=>Or.isDatasetVirtual(e.config),Jr=e=>Or.isDatasetReal(e.config),Kr=e=>Or.isDatasetDeferred(e.config),Qr=e=>Or.shouldLinkDynamicPageNavComponents(e.config),Zr=e=>fr.selectCurrentRecord(e.records),en=e=>fr.selectCurrentRecordIndex(e.records),tn=e=>fr.selectDefaultDraft(e.records),rn=e=>fr.selectDesiredRecordIndex(e.records),nn=e=>fr.selectFieldsToUpdate(e.records),on=e=>fr.selectUpdateSource(e.records),an=e=>fr.selectNewRecordIndex(e.records),sn=e=>Fr.selectNextDynamicPageUrl(e.dynamicPages),cn=e=>Fr.selectPreviousDynamicPageUrl(e.dynamicPages),ln=e=>fr.selectRefreshController(e.records),dn=e=>fr.selectSetFilterCalled(e.records),un=e=>fr.selectRefreshCurrentRecord(e.records),pn=e=>fr.selectRefreshCurrentView(e.records),fn=e=>fr.selectRemoveCurrentRecord(e.records),hn=e=>fr.selectRevertChanges(e.records),mn=e=>fr.selectSaveRecord(e.records),gn=e=>fr.getUserFilterInitialData(e.records),{READ_WRITE:yn,READ:vn}=e;class _n{constructor(e,t){this._logger=e,this._listenToUnhandledErrors(t),this._predicateByEventType=new W([[Ne,e=>{let{mode:t,env:r}=e;return t.csr&&!r.dev}],[Le,e=>{let{mode:t,env:r}=e;return t.verbose&&r.preview}]])}log(e){if(this._shouldLogErrorBi(e)&&this._logger.log(e,new De(e.cause||e)),this._shouldLog(e))return this._logger.log(e)}logError(e,t,r){this.log(e instanceof R?e:new w(t,{cause:e,...r}))}_shouldLog(e){const t=this._predicateByEventType.find(((t,r)=>e instanceof r))||(()=>!0);return t(U.platform.settings)}_shouldLogErrorBi(e){return e instanceof R&&!(e instanceof O)&&this._predicateByEventType.get(Ne)(U.platform.settings)}_listenToUnhandledErrors(e){e.addEventListener("unhandledrejection",(e=>{e.reason instanceof R&&(e.preventDefault(),this._logger.log(new N({cause:e.reason})))}))}}const In=e=>(t,r)=>B(t,(t=>e.log(new r({cause:t})))),En=e=>(t,r)=>B((function(){for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];const i=t(...o);return e.log(new r({data:{args:o,result:i}})),i}),(t=>{throw e.log(new r({data:{exception:t},level:"error"})),t})),Tn=e=>(t,r)=>function(){for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];if(r.startsWith("on"))return e.log(new Le(Le.types.DS_API.REGISTERED,{methodName:r})),t(...o);if(e.log(new Le(Le.types.DS_API.CALLED,{methodName:r,args:o})),Ce.has(r)){const t=Ce.get(r);e.log(new Le(Le.types.DS_API.DEPRECATED,{methodName:r,replacementMethodName:t}))}return V(t(...o)).then((t=>(e.log(new Le(Le.types.DS_API.SUCCED,{methodName:r,result:t})),t)))};class Sn extends Ne{constructor(e){let{id:t,collectionId:r,collectionName:n,datasetId:o,datasetType:a,datasetMode:i,numberOfResults:s,filteredBy:c,componentType:l,fieldType:d}=e;const{platform:{location:{pageId:u,pageUrl:p},settings:{env:f}}}=U;super({id:t,collectionId:r,collectionName:n,datasetId:o,datasetType:a,datasetMode:i,viewMode:f.name,pageId:u,pageUrl:p,numberOfResults:s,filteredBy:c,componentType:l,fieldType:d})}}var Rn=a(5882);const wn=e=>{let{message:t,code:r}=e;const n=new Error(t);return n.code=r,n};class On{constructor(e){let{getRequestParams:t,httpClient:r}=e;this.getRequestParams=t,this.httpClient=r}async _makeRequestTo(e,t){const{instance:r,gridAppId:n}=this.getRequestParams();return(await this.httpClient.post("/_serverless/data-binding-server/"+e,t,{params:{gridAppId:n},headers:{Authorization:r,"Content-Type":"application/json"}})).data}async fetchBulkData(e){const{recordsByCollectionId:t,recordsInfoByDataset:r}=await this._makeRequestTo("fetch-initial-data",e);return{recordsInfoByDataset:r.reduce(((e,t)=>{let{itemIds:r=[],totalCount:n=0,error:o}=t;return[...e,{itemIds:r,totalCount:n,error:o?wn(o):void 0}]}),[]),recordsByCollectionId:Object.entries(t).reduce(((e,t)=>{let[r,n]=t;return{...e,[r]:Object.entries(n).reduce(((e,t)=>{let[r,n]=t;return{...e,[r]:(0,Rn.PL)(n)}}),{})}}),{})}}async fetchData(e){const{items:t,...r}=await this._makeRequestTo("fetch-data",e);return{...r,items:t.map((e=>(0,Rn.PL)(e)))}}async remove(e){return this._makeRequestTo("remove",e)}async save(e){const{item:t}=await this._makeRequestTo("save",e);return(0,Rn.PL)(t)}}const bn=".",Cn=e=>(0,D.head)(e.split(bn)),Pn=e=>e.split(bn),Nn=e=>(0,D.isPlainObject)(e)&&(0,D.has)(e,"_id"),Dn=(e,t)=>e!==t&&Nn(e)&&!Nn(t)?e:t,An=function(e,t){void 0===t&&(t={});for(const r of e){const e=t[r._id];t[r._id]=(0,D.mergeWith)(e,r,Dn)}return t},xn=(e,t)=>{const r=t.flatMap((e=>["fields",e])).concat("type");return(0,D.get)(e,r)},Ln=(e,t)=>r=>{const n=Pn(r);if(((e,t)=>t.length>=2&&xn(e,[t[0]])===l.FieldType.reference)(e,n)){const[r,...o]=n,a=e&&e.fields[r]?e.fields[r].referencedCollection:null,i=t&&a?t[a]:null;return xn(i,o)}return xn(e,n)},Fn=(e,t)=>null!=t&&null!=t.fields[e]?t.fields[e].referencedCollection:null,Mn=e=>null!=e?e.displayField:null,Un=e=>null!=e?e.maxPageSize:void 0,kn=e=>(0,D.includes)(e,bn),Gn=e=>{var t;let{schema:r,defaultToDbDriverLimit:n}=e;const o=n?100:1e3;return null!=(t=Un(r))?t:o},jn=(e,t)=>async r=>{const{baseQuery:n,fieldName:o,schema:a}=r,i=((e,t,r)=>{var n;const o=null===(n=e.fields[t])||void 0===n?void 0:n.queryOperators;return!o||o.includes(r)})(a,o,l.AllowedFilterOperator.ne);if(i)return t({...r,baseQuery:n.ne(o,e)});const s=await t(r);return(0,D.filter)(s,(t=>((e=>(0,D.isObject)(e))(t)?t[o]:t)!==e))},Bn=e=>jn("",e),Vn=e=>jn(void 0,e),Wn=async e=>{let{baseQuery:t,schema:r,fieldName:n}=e;const o=Gn({schema:r,defaultToDbDriverLimit:!0}),{items:a}=await t.limit(o).find(),i=a.flatMap((e=>e[n]));return(0,D.uniq)(i)},qn=async e=>{let{baseQuery:t,fieldName:r,schema:n}=e;const o=Gn({schema:n,defaultToDbDriverLimit:!1}),{items:a}=await t.limit(o).distinct(r,null);return a},Hn=e=>{let{wixData:t,schema:r,sortModel:n,fieldName:o,filterModel:a}=e;const i=(e=>{let{wixData:t,schema:r,sortModel:n,fieldName:o}=e;const a=Cn(o);if(a){var i,s,c;const e=null==(i=null==(s=r.fields[a])?void 0:s.sortable)||i,o=r.defaultSort?[{[r.defaultSort.fieldName]:r.defaultSort.direction}]:null,l=(null==n?void 0:n.length)>0,d=!((null==n?void 0:n.find((e=>e[a])))||(null==r||null==(c=r.defaultSort)?void 0:c.fieldName)===a)&&e,u=t.sort().ascending(a).getSortModel();if(l)return d?[...n,...u]:n;if(o)return d?[...o,...u]:o;if(e)return u}return null})({wixData:t,schema:r,sortModel:n,fieldName:o});return t.query(r.id).setFilterModel(a).setSortModel(i)},$n=async e=>{let{baseQuery:t,schema:r,references:n}=e;const o=Gn({schema:r,defaultToDbDriverLimit:!0}),{items:a}=await t.hasSome("_id",n).limit(o).find();return a},zn=async e=>{let{baseQuery:t,schema:r,wixData:n,customSortExists:o,referencingFieldName:a,referencedFieldName:i,referencedSchema:s}=e;const c=Gn({schema:r,defaultToDbDriverLimit:!1}),{items:l}=await t.limit(c).distinct(a,null),d=Bn(Vn($n)),u=await d({baseQuery:n.query(s.id),schema:s,fieldName:i,references:l});return o?l.flatMap((e=>u.filter((t=>t._id===e)))):u},Yn=async e=>{let{baseQuery:t,schema:r,fieldName:n}=e;const o=Gn({schema:r,defaultToDbDriverLimit:!0}),{items:a}=await t.limit(o).include(n).find();return a},Xn=async e=>{let{baseQuery:t,schema:r,referencingFieldName:n,referencedFieldName:o}=e;const a=Vn(Yn),i=await a({baseQuery:t,schema:r,fieldName:n});return(0,D.uniqBy)(i.map((e=>e[n])).filter((e=>!["",void 0].includes(e[o]))),"_id")},Jn=async e=>{var t;let{schema:r,schemas:n,wixData:o,fieldName:a,role:i,sortModel:s,filterModel:c}=e;const d=Hn({wixData:o,schema:r,fieldName:a,sortModel:s,filterModel:c}),[u,p]=Pn(a),f=n[r.fields[u].referencedCollection];if(!f)return null;const h=(null==s?void 0:s.length)>0,m=(null==(t=r.allowedOperations)?void 0:t.includes(l.DataOperation.distinct))?zn:Xn,g=await m({baseQuery:d,schema:r,schemas:n,wixData:o,fieldName:a,customSortExists:h,referencingFieldName:u,referencedFieldName:p,referencedSchema:f}),y=(e=>{let{referencedItems:t,referencedSchema:r,referencedFieldName:n,customSortExists:o}=e;const a=(0,D.uniq)(t.flatMap((e=>e[n]))),i=r.fields[n].type;return o?a:i===l.FieldType.number?a.sort(((e,t)=>e-t)):a.sort()})({referencedItems:g,referencedSchema:f,referencedFieldName:p,customSortExists:h}),v=(e=>{let{referencedItems:t,referencedFieldName:r,options:n}=e;return Object.fromEntries(n.map((e=>[e,t.filter((t=>(0,D.isArray)(t[r])?t[r].includes(e):t[r]===e)).map((e=>e._id))])))})({referencedItems:g,options:y,referencedFieldName:p});return{fieldName:a,role:i,options:y,referencedItemIdsByOption:v}},Kn=async e=>{var t;let{schema:r,wixData:n,fieldName:o,role:a,filterModel:i}=e;const s={wixData:n,schema:r,filterModel:i,fieldName:o,role:a};return(null==(t=r.allowedOperations)?void 0:t.includes(l.DataOperation.aggregate))?(async e=>{var t;let{wixData:r,schema:n,filterModel:o,fieldName:a,role:i}=e;const s=r.filter().setFilterModel(o),{items:c}=await r.aggregate(n.id).filter(s).max(a,"max").min(a,"min").run(),{min:l,max:d}=null!=(t=c[0])?t:{};return{fieldName:a,role:i,min:l,max:d}})(s):(async e=>{let{wixData:t,schema:r,filterModel:n,fieldName:o,role:a}=e;const i=t.query(r.id).setFilterModel(n).limit(1),[{items:s},{items:c}]=await Promise.all([i.ascending(o).find(),i.descending(o).find()]),l=s.map((e=>e[o]))[0],d=c.map((e=>e[o]))[0];return{fieldName:o,role:a,min:l,max:d}})(s)};class Qn{constructor(e){let{wixData:t,wixDataSchemas:r}=e;this._wixData=Zn.reduce(((e,r)=>(e[r]=function(){const e=t[r](...arguments);return e.catch instanceof Function?e.catch((e=>{throw ao(e)})):e},e)),{...t}),this._wixDataSchemas=r}async fetchBulkData(e){const t=await Promise.all(e.map((e=>{let{collectionId:t,filter:r,sort:n,offset:o,cursor:a,length:i,includes:s,uniqueFieldValues:c}=e;return this.fetchData({collectionId:t,filter:r,sort:n,offset:o,cursor:a,length:i,includes:s,uniqueFieldValues:c}).catch((e=>({error:e})))})));return((e,t)=>t.reduce(((t,r,n)=>{let{items:o,nextCursor:a,totalCount:i,uniqueFieldValues:s,error:c}=r;if(c)return t.recordInfosInDatasetOrder.push({error:c}),t;t.recordInfosInDatasetOrder.push({itemIds:o.map((e=>{let{_id:t}=e;return t})),totalCount:i,nextCursor:a});const l=e[n].collectionId,d=t.recordsByCollectionId[l];return t.recordsByCollectionId[l]=An(o,d),t.uniqueFieldValuesByCollection[l]={...t.uniqueFieldValuesByCollection[l],...s},t}),{recordInfosInDatasetOrder:[],recordsByCollectionId:{},uniqueFieldValuesByCollection:{}}))(e,t)}async fetchData(e){let{collectionId:t,filter:r,sort:n,offset:o=0,includes:a,cursor:i,length:s,uniqueFieldValues:c}=e;const l=i?this._wixData.fetch(t,i,s):(()=>{let e=this._wixData.query(t).setFilterModel(r).setSortModel(n).skip(o).limit(s);return null==a||a.forEach((t=>{e=e.include(t)})),e.find()})(),d=c.length>0?this._fetchUniqueValues({collectionId:t,fieldKeys:c}):Promise.resolve({}),[u,p]=await Promise.all([l,d]),{items:f,totalCount:h,nextCursor:m}=u;return{items:f,nextCursor:m,totalCount:h||0,uniqueFieldValues:p}}async fetchUserFilterInitialData(e){let{filter:t,sort:r,userFilterConnectionProps:n,schema:o,schemas:a}=e;const i=[Re],s=(0,D.uniqBy)(n.filter((e=>{let{role:t}=e;return i.includes(t)})),"fieldName"),c=(0,D.uniqWith)(n.filter((e=>{let{role:t}=e;return be.includes(t)})),((e,t)=>e.fieldName===t.fieldName)),d=await Promise.all([...s.map((async e=>{let{fieldName:r,role:n}=e;const a={schema:o,wixData:this._wixData,fieldName:r,role:n,filterModel:t};return Kn(a)})),...c.map((async e=>{let{fieldName:n,role:i}=e;const s=kn(n),c={wixData:this._wixData,schema:o,schemas:a,fieldName:n,role:i,sortModel:r,filterModel:t};return s?Jn(c):(async e=>{var t;let{wixData:r,schema:n,fieldName:o,role:a,sortModel:i,filterModel:s}=e;const c=Hn({wixData:r,schema:n,fieldName:o,sortModel:i,filterModel:s}),d=null==(t=n.allowedOperations)?void 0:t.includes(l.DataOperation.distinct),u=Bn(d?qn:Vn(Wn));return{fieldName:o,role:a,options:await u({baseQuery:c,fieldName:o,schema:n})}})(c)}))]);return d.filter(We)}async remove(e){let{collectionId:t,recordId:r}=e;return this._wixData.remove(t,r)}async save(e){let{collectionId:t,record:r,includeReferences:n}=e;return this._wixData.save(t,r,{includeReferences:n})}async getSibling(e){let{collectionName:t,filter:r,sort:n,fieldValues:o,sortFields:a,directionTowardSibling:i}=e;const s=this._wixData.query(t).setFilterModel(r),{items:[c]}=await eo({sort:n,sortFields:a,fieldValues:o,baseQuery:s,directionTowardSibling:i}).find();return c}fetchSchemas(e){return this._wixDataSchemas.bulkGet(e,{referencedCollectionsDepth:1})}createSimpleFilter(e,t){return this._wixData.filter().eq(e,t).getFilterModel()}async _fetchUniqueValues(e){let{collectionId:t,fieldKeys:r}=e;return(await Promise.all(r.map((e=>this._wixData.query(t).distinct(e))))).reduce(((e,t,n)=>{let{_items:o}=t;return e[r[n]]=o,e}),{})}}const Zn=["save","remove","find","sort","filter","query","fetch","aggregate"],eo=e=>{let{sort:t,sortFields:r,directionTowardSibling:n,fieldValues:o,baseQuery:a}=e;return to({sort:t,sortFields:r,directionTowardSibling:n,fieldValues:o,baseQuery:a})(r.length-1).reduce(((e,t)=>e.or(t)))},to=e=>{let{baseQuery:t,sortFields:r,sort:n,directionTowardSibling:o,fieldValues:a}=e;return function e(i){if(-1===i)return[];const s=r[i];if(!a[s])return e(i-1);return[(0,D.flow)(ro(n,o),no(n[s],o,s,a[s]),oo(i,r,a))(t),...e(i-1)]}},ro=(e,t)=>r=>Object.entries(e).reduce(((e,r)=>{let[n,o]=r;return o===t?e.ascending(n):e.descending(n)}),r),no=(e,t,r,n)=>o=>e===t?o.gt(r,n):o.lt(r,n),oo=(e,t,r)=>n=>(0,D.range)(e).reduce(((e,n)=>e.eq(t[n],r[t[n]])),n).limit(1),ao=e=>{if(!e.stack){const{message:t,code:r}="string"==typeof e?{message:e,code:"WD_VALIDATION_FAILED"}:e,n=new Error(t);return n.code=r,n}return e};class io{constructor(e){S()(this,"warmupData",void 0),this.warmupData=e}getSchemas(){return this.warmupData.get("schemas")}setSchemas(e){this.warmupData.set("schemas",e)}getDataStore(){return this.warmupData.get("dataStore")}setDataStore(e){this.warmupData.set("dataStore",e)}getUserFilterInitialData(e){return this.warmupData.get("userFilterInitialData-"+e)}setUserFilterInitialData(e,t){this.warmupData.set("userFilterInitialData-"+e,t)}}class so{constructor(e){if(e&&e.config){this._collectionId=e.config.dataset.collectionName,this._items=e.items,this._schemas=e.schemas;const t=e.nextCursor||void 0,r=e.totalCount||0,n=(e.items||[]).length;this._datasetSize={cursor:t,total:r,loaded:n}}}getSchemas(){return this._schemas}getDataStore(){if(this._items)return(e=>{let{items:t,datasetSize:r,collectionId:n}=e;return{recordInfosInDatasetOrder:[{itemIds:t.map((e=>{let{_id:t}=e;return t})),datasetSize:r,collectionId:n}],recordsByCollectionId:{[n]:An(t,{})}}})({items:this._items,datasetSize:this._datasetSize,collectionId:this._collectionId})}getItems(){return this._items}}const co={dsn:"https://27180ecd50484e4eafe543b40d29866d@sentry.wixpress.com/89"},lo={dsn:"https://73a0410004ae41b7b60ca1c4b4684996@sentry.wixpress.com/183"},uo={dsn:"https://9653fbb3e48143d890dba8a09a5a98c6@sentry.wixpress.com/184"},po={dsn:"https://cef68e5a2fd04f08a7c2a02738dbc237@sentry-next.wixpress.com/2411"},fo=["ReactSource","EditorSource","experiments","petri_ovr","WixCodeRuntimeSource","js-wixcode-sdk-override","debug"],ho=e=>{try{const t=(e=>Array.from(new URL(e).searchParams.entries()).reduce(((e,[t,r])=>Object.assign(Object.assign({},e),{[t]:r})),{}))(e||"");return(e=>"true"===e.forceReportSentry)(t)||(e=>Object.keys(e).every((e=>!fo.includes(e))))(t)}catch(e){return!0}},mo=[e=>(e=>{var t,r,n;return[null===(r=null===(t=null==e?void 0:e.request)||void 0===t?void 0:t.headers)||void 0===r?void 0:r.Referer,null===(n=null==e?void 0:e.request)||void 0===n?void 0:n.url]})(e).every(ho)],go=(e,t)=>mo.concat(t||(e=>e)).every((t=>t(e))),yo=e=>{try{return e()}catch(e){return"unknown"}},vo=e=>{try{return e()}catch(e){return"object"==typeof e&&null!==e&&"message"in e?e.message:void 0}},_o=({Raven:e,globalScope:t,dsn:r,params:n={},appName:o})=>{/https?:\/\/localhost/.test(Y())||((({Raven:e,appName:t,browserUrlGetter:r,dsn:n,params:o})=>{const a=X(t),i=z(a);e.config(n,{maxUrlLength:1e3,captureUnhandledRejections:!1,autoBreadcrumbs:{dom:!1}}),e.setRelease(o.release||i),e.setShouldSendCallback(o.shouldSendCallback||go),e.setDataCallback(((e,t)=>(e.request=Object.assign(e.request||{},{url:r()}),(t||(e=>e))(e))))})({Raven:e,appName:o,browserUrlGetter:()=>yo((()=>{var e;return null===(e=null==t?void 0:t["wix-location"])||void 0===e?void 0:e.url})),dsn:r,params:n}),e.setDataCallback(((e,r=(e=>e))=>(e.extra=Object.assign(e.extra||{},(e=>({referrer:vo((()=>{var t;return null===(t=null==e?void 0:e["wix-window"])||void 0===t?void 0:t.referrer})),workerUrl:vo((()=>{var t;return null===(t=null==e?void 0:e.location)||void 0===t?void 0:t.href}))}))(t)),e.tags=Object.assign(e.tags||{},n.tags||{},(e=>({renderMode:yo((()=>{var t,r;return null===(r=null===(t=null==e?void 0:e["wix-window"])||void 0===t?void 0:t.rendering)||void 0===r?void 0:r.env})),viewMode:yo((()=>{var t;return null===(t=null==e?void 0:e["wix-window"])||void 0===t?void 0:t.viewMode})),santaVersion:yo((()=>{var t;return(e=>{const t=e.match(/santa\/([^/]*)/);return t?t[1]:"unknown"})((null===(t=null==e?void 0:e.location)||void 0===t?void 0:t.href)||"")}))}))(t)),r(e)))))},{USER_SCOPE:Io,APPLICATION_SCOPE:Eo,SERVER_SCOPE:To}=R.scopes,{DBSMViewer:{dsn:So},UserErrors:{dsn:Ro},WixData:{dsn:wo},DBSMViewerNext:{dsn:Oo}}=r,bo={[Eo]:So,[Io]:Ro,[To]:wo};let Co=function(e,t){return r=>this.mode.dev?(e===Error&&(this.console.error(r),r.cause&&this.console.error("Caused by:",r.cause)),null==r.run?void 0:r.run()):t(r)};class Po{constructor(e){let{fedops:t,bi:r,monitor:n,verbose:o,console:a,global:i,platform:s}=e;const c=a.factory();Co=Co.bind({mode:s.settings.mode,console:c}),this._eventToHandler=this._createEventToHandler(),this._fedOpsLogger=this._createFedopsLogger(t),this._bi=this._createBiLoggers({bi:r,settings:s.settings}),this._monitor=(e=>{let{createErrorMonitor:t,dsn:r,platform:n}=e;const o=X(Pe),a=z(o);return t({dsn:r,appName:Pe,version:a,environment:n.settings.mode.name,user:{id:n.user.id}})})({createErrorMonitor:n.createErrorMonitor,dsn:Oo,platform:s}),this._legacyMonitor=this._setupLegacyMonitor({monitor:n,global:i,platform:s}),this._verboseLogger=o.factory(),this._console=c,this._errorMonitorTags={msid:s.settings.metaSiteId,url:(s.location.pageUrl||"").slice(0,200),viewMode:s.settings.mode.name,renderMode:s.settings.env.name}}log(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(t.length>1)return t.map((e=>this.log(e)));const[n]=t,[,o]=Array.from(this._eventToHandler).find((e=>{let[t]=e;return t.prototype.isPrototypeOf(n)}))||[];return o?o(n):this._console.error("Oj-vej! This event is not supported by logger",n)}_createEventToHandler(){return new Map([[Error,Co(Error,(e=>{if(e instanceof N)this._console.warn("You have unhandled error in async operation. Consider catching it and handling accordingly.\n",e.cause);else{const{scope:t,cause:r,options:{extra:n,...o}={}}=e;if(e instanceof O)this._console.error(e),r&&this._console.error("Caused by:",r);else{const t=r instanceof Error;this._monitor.captureException(t?r:e,{tags:{...o,...this._errorMonitorTags,wrapperErrorMessage:t?(e.name+": "+e.message+"\n"+e.stack).slice(0,200):void 0},contexts:{...n,wrapperError:t?e:void 0}})}this._legacyMonitor[t].captureException(e,{zone:t,extra:{cause:r,...n},...o})}}))],[Ne,Co(Ne,(e=>{let{event:t,type:r}=e;return r===Ne.types.ERROR?this._bi.errorLogger.log(t):this._bi.logger.log(t)}))],[Ae,Co(Ae,(e=>{let{name:t,params:r,run:n,onStart:o,onEnd:a}=e;return o((()=>this._fedOpsLogger.interactionStarted(t,r))),a((()=>this._fedOpsLogger.interactionEnded(t,r))),n()}))],[xe,Co(xe,(e=>{let{event:t}=e;this._legacyMonitor[Eo].captureBreadcrumb(t),this._monitor.addBreadcrumb(t)}))],[Le,e=>{let{messages:t}=e;return this._verboseLogger.log(...t)}],[Fe,e=>{let{message:t,level:r}=e;return this._console[r](t)}]])}_createFedopsLogger(e){let{factory:t,hooks:{start:r,end:n}}=e;return t.getLoggerForWidget({appId:"databinding",appName:"databinding",startHook:r,endHook:n})}_createBiLoggers(e){let{bi:{factory:t},settings:{env:r}}=e;return{logger:t().logger({endpoint:r.editor?"platform":"platform-viewer"}),errorLogger:t().logger({endpoint:"trg"})}}_setupLegacyMonitor(e){let{monitor:{factory:t},global:r,platform:n}=e;const{metaSiteId:o,userId:a}=n.settings;return Object.entries(bo).reduce(((e,n)=>{let[i,s]=n;const c=t(s);return e[i]=c,_o({dsn:s,Raven:c,globalScope:r,appName:Pe,user:{id:a},params:{tags:{msid:o}}}),e}),{})}}class No{constructor(){this._recordInfosByDatasetId={},this._recordsByCollectionId={},this._uniqueFieldValuesByCollection={},this._schemas={},this._userFilterInitialData={}}getData(e){let{datasetId:t,collectionId:r,includes:n}=e;const o=this._recordInfosByDatasetId[t];return o?{datasetSize:o.datasetSize,items:o.itemIds.map((e=>Do(this._recordsByCollectionId[r][e],this.getSchema(r),n)))}:null}getRecord(e){var t;let{collectionId:r,recordId:n,includes:o}=e;const a=null==(t=this._recordsByCollectionId[r])?void 0:t[n];return a&&Do(a,this.getSchema(r),o)}updateCollectionData(e){let{collectionId:t,data:r}=e;const{[t]:n}=this._recordsByCollectionId,{[t]:o}=this._uniqueFieldValuesByCollection,{items:a,uniqueFieldValues:i}=r;this._recordsByCollectionId[t]=Ao(a,n),this._uniqueFieldValuesByCollection[t]=xo(i,o)}getSchema(e){return this._schemas[e]}updateStore(e){let{recordsByCollectionId:t={},recordInfosByDatasetId:r={},uniqueFieldValuesByCollection:n={}}=e;this._recordInfosByDatasetId={...this._recordInfosByDatasetId,...r};for(const[e,r]of Object.entries(t))this._recordsByCollectionId[e]={...this._recordsByCollectionId[e],...r};for(const[e,t]of Object.entries(n))this._uniqueFieldValuesByCollection[e]={...this._uniqueFieldValuesByCollection[e],...t}}getStore(){return{recordInfosByDatasetId:this._recordInfosByDatasetId,recordsByCollectionId:this._recordsByCollectionId,uniqueFieldValuesByCollection:this._uniqueFieldValuesByCollection}}hasDataset(e){return Boolean(this._recordInfosByDatasetId[e])}setUniqueFieldValues(e){let{collectionId:t,fieldKey:r,data:n}=e;this._uniqueFieldValuesByCollection[t]={...this._uniqueFieldValuesByCollection[t],[r]:n}}getUniqueFieldValues(e){var t;let{collectionId:r,fieldKey:n}=e;return null==(t=this._uniqueFieldValuesByCollection[r])?void 0:t[n]}updateSchemas(e){for(const[t,r]of Object.entries(e))this._schemas[t]={...this._schemas[t],...r}}getSchemas(){return this._schemas}getUserFilterInitialData(e){return this._userFilterInitialData[e]}setUserFilterInitialData(e,t){this._userFilterInitialData[e]=t}}const Do=(e,t,r)=>Object.entries(e).reduce(((e,n)=>{let[o,a]=n;return((e,t)=>{var r;return(null==t||null==(r=t.fields)||null==(r=r[e])?void 0:r.type)===l.FieldType.reference})(o,t)&&((e,t)=>!e||!e.includes(t))(r,o)&&Boolean(null==a?void 0:a._id)?e[o]=a._id:e[o]=a,e}),{}),Ao=function(e,t){return void 0===t&&(t={}),e.reduce(((e,t)=>{const r=e[t._id];return e[t._id]=r?(0,D.mergeWith)(r,t,Dn):t,e}),t)},xo=function(e,t){return void 0===e&&(e={}),void 0===t&&(t={}),{...t,...e}},Lo=e=>{var t,r,n;return null===(n=null===(r=null===(t=null==e?void 0:e.plugins)||void 0===t?void 0:t[l.CMS_PLUGIN_ID])||void 0===r?void 0:r.siteSort)||void 0===n?void 0:n.sort},Fo=async({datasetConfigSort:e,getSchema:t})=>{const r=e&&e.length>0?e:(n=await t(),(Lo(n)||[]).map((({fieldName:e,direction:t})=>({[e]:t}))));var n;return r.length>0?r:null};class Mo{constructor(){const{logger:e,dataFetcher:t}=U;this._dataFetcher=t,this._logger=e,this._dataStore=new No,this._dataFetchingBulk={},this._bulkDataFetching=Promise.resolve()}createInitialDataRequest(e){this._dataFetchingBulk=e.reduce(((e,t)=>{let{id:r,refresh:n}=t;return n||!this._dataStore.hasDataset(r)?{...e,[r]:new j}:e}),{});const t=Object.entries(this._dataFetchingBulk).map((e=>{let[,{promise:t}]=e;return t}));this._bulkDataFetching=this._waitForDataFetched(t).then((()=>this._dataFetchingBulk={}))}async getInitialData(e){let{datasetId:t,collectionId:r,cursorPaging:n,filter:o,sort:a,length:i,includes:s,uniqueFieldValues:c}=e;return this._dataFetchingBulk[t]&&(this._dataFetchingBulk[t].resolve({datasetId:t,collectionId:r,cursorPaging:n,filter:o,sort:a,length:i,includes:s,uniqueFieldValues:c}),await this._bulkDataFetching),this._dataStore.getData({datasetId:t,collectionId:r,includes:s})||this.getData({datasetId:t,collectionId:r,cursorPaging:n,filter:o,sort:a,offset:0,length:i,includes:s,uniqueFieldValues:c})}async getSort(e){let{sort:t,collectionId:r}=e;return await Fo({datasetConfigSort:t,getSchema:async()=>(await this.waitForSchemasLoaded(),this.getSchema(r))})}async getData(e){const{collectionId:t,cursorPaging:r,offset:n,filter:o,includes:a,length:i,datasetSize:s,uniqueFieldValues:c}=e,l=e=>!this.getUniqueFieldValues({collectionId:t,fieldKey:e}),d=await this.getSort(e),{items:u,totalCount:p,nextCursor:f,uniqueFieldValues:h}=await this._dataFetcher.fetchData({collectionId:t,offset:n,filter:o,sort:d,includes:a,cursor:r?null==s?void 0:s.cursor:void 0,length:i,uniqueFieldValues:c.filter((e=>l(e)))}).catch(ko("Data fetching failed",{datasetConfig:e}));return await this.waitForSchemasLoaded(),this._dataStore.updateCollectionData({collectionId:t,data:{items:u,uniqueFieldValues:h}}),{items:u,datasetSize:{total:p,loaded:((null==s?void 0:s.loaded)||0)+u.length,cursor:f},uniqueFieldValues:h}}async remove(e){let{collectionId:t,recordId:r}=e;return this._dataFetcher.remove({collectionId:t,recordId:r}).catch(ko("Record removing failed",{collectionId:t,recordId:r}))}async save(e){let{collectionId:t,record:r,includeReferences:n}=e;return this._dataFetcher.save({collectionId:t,record:r,includeReferences:n}).catch(ko("Record saving failed",{collectionId:t,record:r,includeReferences:n}))}async getSibling(e){return await this._dataFetcher.getSibling(e)}async loadSchemas(e){const t=this._dataStore.getSchemas(),r=e.filter((e=>!t[e]));this._schemasLoading=r.length?this._dataFetcher.fetchSchemas(r).catch(ko("Schema fetching failed",{collectionIds:r})):Promise.resolve({});const n=await this._schemasLoading;return this._dataStore.updateSchemas({...t,...n}),this._dataStore.getSchemas()}async setSchemas(e){this._dataStore.updateSchemas(e)}getSchemas(){return this._dataStore.getSchemas()}getRecord(e){let{collectionId:t,recordId:r,includes:n}=e;return this._dataStore.getRecord({collectionId:t,recordId:r,includes:n})}getSchema(e){return this._dataStore.getSchema(e)}hasSchema(e){return Boolean(this.getSchema(e))}getReferencedSchemas(e){const t=this.getSchema(e),r=this._dataStore.getSchemas();return(e=>e?(0,D.flow)((e=>(0,D.pickBy)(e,(e=>{let{referencedCollection:t}=e;return Boolean(t)}))),(e=>(0,D.map)(e,(e=>{let{referencedCollection:t}=e;return t}))),D.uniq,(e=>e.filter(Boolean)))(e.fields):[])(t).reduce(((e,t)=>({...e,[t]:r[t]})),{})}setCollectionData(e){let{collectionId:t,data:r}=e;r&&this._dataStore.updateCollectionData({collectionId:t,data:r})}setStore(e){e&&this._dataStore.updateStore(e)}setStaticStore(e){const{recordsByCollectionId:t,recordInfosInDatasetOrder:r,uniqueFieldValuesByCollectionId:n}=e,o=this._datasetConfigs.find((e=>{let{type:t}=e;return t===mr}));if(o){const{datasetId:e}=o,a={[e]:r[0]};this._dataStore.updateStore({recordsByCollectionId:t,recordInfosByDatasetId:a,uniqueFieldValuesByCollectionId:n})}}getStore(){return this._dataStore.getStore()}setUniqueFieldValues(e){let{collectionId:t,fieldKey:r,data:n}=e;return this._dataStore.setUniqueFieldValues({collectionId:t,fieldKey:r,data:n})}getUniqueFieldValues(e){let{collectionId:t,fieldKey:r}=e;return this._dataStore.getUniqueFieldValues({collectionId:t,fieldKey:r})}createSimpleFilter(e,t){return this._dataFetcher.createSimpleFilter(e,t)}setDatasetConfigs(e){this._datasetConfigs=e}getUserFilterInitialData(e){return this._dataStore.getUserFilterInitialData(e)}setUserFilterInitialData(e,t){this._dataStore.setUserFilterInitialData(e,t)}async _fetchInitialData(e){try{const{recordsByCollectionId:t,recordInfosInDatasetOrder:r,uniqueFieldValuesByCollection:n}=await this._logger.log(new Ae("dataset/fetchPrimaryInitialData",(async()=>this._dataFetcher.fetchBulkData(await Promise.all(e.map((async e=>({...e,sort:await this.getSort(e)}))))))));return{recordsByCollectionId:t,recordInfosByDatasetId:r.reduce(((t,r,n)=>{let{itemIds:o=[],error:a,nextCursor:i,totalCount:s}=r;const c=e[n];return a&&this._logger.log(Uo("Initial data fetching failed for one of the datasets",{cause:a,extra:{datasetConfig:c}})),t[c.datasetId]={itemIds:o,datasetSize:{total:s,loaded:o.length,cursor:i}},t}),{}),uniqueFieldValuesByCollection:n}}catch(t){throw new w("Initial data fetching failed",{cause:t,extra:{datasetConfigs:e}})}}async waitForSchemasLoaded(){await this._schemasLoading}async _waitForDataFetched(e){if(e.length){const t=await Promise.all(e),r=await this._fetchInitialData(t);await this.waitForSchemasLoaded(),this._dataStore.updateStore(r)}}}const Uo=(e,t)=>{let{cause:r,...n}=t;return new(C.codes.includes(r.code)?C:P)(e,{...n,cause:r,code:r.code})},ko=(e,t)=>r=>{throw Uo(e,{cause:r,extra:t})},Go="PRIMARY";var jo=a(8582),Bo=a.n(jo);const Vo=function(e,t,r){return void 0===r&&(r=[]),e(t)?[{path:(0,D.clone)(r),filterExpression:t}]:(n=t,Array.isArray(n)||(0,D.isPlainObject)(n)?(0,D.flatMap)(t,((t,n)=>Vo(e,t,r.concat(n)))):[]);var n},Wo=e=>t=>t.reduce(((e,t)=>{let{path:r,filterExpression:n}=t;return((e,t,r)=>(0,D.set)(e,t,r))(e,r,n)}),(0,D.cloneDeep)(e)),qo=(e,t,r)=>{const n=((e,t)=>Bo()(je.Maybe,t.map((t=>{let{path:r,filterExpression:n}=t;return e(n).map((e=>({path:r,filterExpression:e})))}))))(t,Vo(e,r));return n.map(Wo(r))},Ho=()=>()=>je.Maybe.fromNullable(U.platform.user).map((e=>{let{id:t,loggedIn:r}=e;return r?t:null})),$o=e=>t=>{let{filterId:r}=t;return je.Maybe.fromNullable(e(r)).chain((e=>{let t,{masterDataset:r,fieldName:n}=e;try{t=r.api.getCurrentItem()}catch(e){}return je.Maybe.fromNullable(t).map((e=>{const t=e[n];return void 0===t?null:t}))}))},zo=e=>Xo(e).chain((e=>{let[t,r]=e;return"$not"===t&&(0,D.isArray)(r)?Yo({positive:!1,filterExpression:r[0]}):je.Maybe.Nothing()})).orElse((()=>Yo({positive:!0,filterExpression:e}))),Yo=e=>{let{positive:t,filterExpression:r}=e;return Xo(r).chain((e=>{let[r,n]=e;return Xo(n).map((e=>{let[n,o]=e;return{field:r,condition:n,value:o,positive:t}}))}))},Xo=e=>{if(!(0,D.isPlainObject)(e))return je.Maybe.Nothing();const t=(0,D.entries)(e)[0];return je.Maybe.fromNullable(t)},{stringArray:Jo,number:Ko}=l.FieldType,Qo=(e,t)=>(0,D.get)(e,t),Zo=e=>{let{previousRecord:t,currentRecord:r,fieldName:n}=e;return!(0,D.isEqual)(Qo(t,n),Qo(r,n))},{mediaGallery:ea}=l.FieldType,ta="datetime",ra=e=>/^\d{2}:\d{2}:\d{2}\.\d{3}$/.test(e),na=e=>e instanceof Date&&!isNaN(e),oa=e=>{let{time:t,date:r}=e;const[n,o]=t.split(":");return r.setHours(n),r.setMinutes(o),r.setSeconds(0),r.setMilliseconds(0),r},aa=e=>e.toTimeString().split(" ")[0]+".000",ia=e=>{const t=new Date(e);return na(t)?t:(()=>{const e=new Date;return e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e})()},sa=e=>String(e).padStart(2,"0"),ca=e=>[e.getFullYear(),sa(e.getMonth()+1),sa(e.getDate())].join("-"),la=e=>{let{value:t,formatter:r,fieldType:n,format:o}=e;if(o.type===ta){const e=n===l.FieldType.date,a=((e,t)=>{switch(t){case l.FieldType.date:return new Date(e);case l.FieldType.time:return new Date("1970-01-01T"+e);default:return e}})(t,n);return na(a)?r?r.formatDateTime(a,o.params.dateFormat,{timeZone:e?"UTC":void 0}):e&&"string"==typeof t?t:"":t}return t},da=e=>null==e||"function"!=typeof e.toString?"":Array.isArray(e)?e.join(", "):e.toString(),{mediaGallery:ua,address:pa,date:fa}=l.FieldType,ha=(e,t)=>{let{fieldType:r,role:n,componentIsInput:o,propPath:a}=t;const i=[{converter:e=>{let{formatted:t}=e;return t},condition:e&&r===pa&&n!==pe},{converter:da,condition:n===Z||!o&&![re,te,me,ve].includes(n)&&r!==l.FieldType.boolean},{converter:e=>(e=>{let{value:t}=e;const{platform:{utils:{media:r}}}=U,n=r.parseMediaItemUri(t);if(n.error)return t;switch(n.type){case r.types.IMAGE:return r.getScaleToFillImageURL(n.mediaId,n.width,n.height,n.width,n.height,{name:n.title});case r.types.VIDEO:return"https://video.wixstatic.com/video/"+n.mediaId+"/file";case r.types.AUDIO:return"https://static.wixstatic.com/mp3/"+n.mediaId;default:return t}})({value:e}),condition:"link"===a&&n!==fe},{converter:()=>[],condition:!e&&r===ua},{converter:aa,condition:n===he&&na(e)},{converter:e=>{const t=new Date(e);return null!==e&&na(t)?t:""===e||null===e?void 0:e},condition:n===ie&&r===fa}],s=i.reduce(((e,t)=>{let{converter:r,condition:n}=t;return n&&e.push(r),e}),[]);return(0,D.flow)(s)(e)};var ma=function(e){var t=function(e){var t=0;if(void 0===e||0===e.length)return t;for(var r=0;r<e.length;r++){t=(t<<5)-t+e.charCodeAt(r),t|=0}return t*=Math.sign(t),t=Math.sqrt(t),t=Math.floor(1e6*(t-Math.floor(t)))}(e);return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e,r){var n=Math.ceil(t/(r+1))%16;return("x"===e?n:3&n|8).toString(16)}))},ga=function(e){return void 0===e&&(e=""),e?e.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w\-\.]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,""):""};function ya(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function va(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ya(Object(r),!0).forEach((function(t){_a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ya(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _a(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Ia=function(e,t){return e&&"object"==typeof e?"direct"===e.type?va(va({},e),{},{type:"web"}):{type:"wix",data:e}:"string"==typeof e?{type:"web",url:e,target:t,text:e}:{target:"_blank",type:"none"}},Ea=function(e){void 0===e&&(e={});var t={link:e.url};return e.url&&(t.target=e.target),t},Ta=function(e){return null!==/^(wix:)?(image|video)(:\/\/)/.exec(e)},Sa=function(e){return Ta(e)?e.split("/")[3]:e},Ra=function(e){try{return Ta(e)?e.split("/")[4].split("#").slice(0,-1).join("#"):"_.jpg"}catch(e){return"_.jpg"}},wa=function(e,t){return"wix:image://v1/"+(e||ga(t.name))+"/"+ga(t.fileName||t.name)+"#originWidth="+t.width+"&originHeight="+t.height},Oa=function(e,t){return"wix:video://v1/"+(e||ga(t.name))+"/"+ga(t.fileName||t.name)+"#posterUri="+t.posters[0].url+"&posterWidth="+t.width+"&posterHeight="+t.height},ba=function(e){var t={},r=!1;try{var n=/\/\d*_\d*\//.exec(e);if(n&&n[0]&&n[0].length>0){var o=n[0].replace(/\//g,"").split("_").map((function(e){return Number(e)})),a=o[0],i=o[1];a>0&&i>0&&(r=!0,t={originWidth:a,originHeight:i})}}catch(e){r=!1}if(!r)try{var s=/wm_(.*)\//.exec(e);if(s&&s[0]&&s[0].length>0){var c=s[1];c.length>0&&(t.watermark=c)}}catch(e){r=!1}if(!r)try{e.split("#").pop().split("&").map((function(e){return e.split("=")})).forEach((function(e){t[e[0]]=isNaN(Number(e[1]))?String(e[1]):Number(e[1])}))}catch(e){r=!1}return t},Ca=function(e,t){return void 0===t&&(t=0),function(e){return!!(e.src||e.type&&e.html)}(e)?function(e,t){var r,n,o,a=ba(e.src);"video"===(null==(r=e.type)?void 0:r.toLowerCase())&&(null!=(n=e.src)&&n.includes("youtube")||null!=(o=e.src)&&o.includes("vimeo"))&&(a.originWidth=1920,a.originHeight=1080),a.width=e.width||a.originWidth||a.originalWidth||a.posterWidth||1,a.height=e.height||a.originHeight||a.originalHeight||a.posterHeight||1;var i=e.settings&&e.settings.focalPoint,s=a.watermark,c=e.imageToken||e.token||a.token,l=(e.type||"image").toLowerCase(),d=va({itemId:ga(e.slug)||(ga(e.title||e.id)||ma(e.src||e.html||t))+"_"+t,mediaUrl:Sa(e.src),metaData:Object.assign(va({type:l,alt:e.alt||"",title:e.title||"",description:e.description||"",name:Ra(e.src),fileName:Ra(e.src),link:Ia(e.link,e.target),width:a.width,height:a.height,sourceName:"private"},"customButtonText"in e&&{customButtonText:e.customButtonText}),i?{focalPoint:i}:{},s?{watermarkStr:s}:{}),orderIndex:t},c&&{token:c});if("text"===l){var u=e.style;d.metaData.height=a.height||500,d.metaData.width=a.width||500*u.layoutRatio,d.metaData.textStyle={width:d.metaData.width,height:d.metaData.height,backgroundColor:u.fillColor},d.metaData.html=d.editorHtml=e.html}if("video"===l){var p={};e.thumbnail&&(p=ba(e.thumbnail));var f=function(e){return null!==/^.*\.(jpeg|jpg|webp|png|jpe).*$/.exec(e)}(Sa(e.thumbnail))?Sa(e.thumbnail):a.posterUri;d.metaData.posters=[{url:f,width:p.width||a.width,height:p.height||a.height}],d.isExternal=0===e.src.indexOf("http"),d.isExternal||Ta(e.src)?(d.metaData.source=e.src.indexOf("youtube.com")>0?"youtube":e.src.indexOf("vimeo.com")>0?"vimeo":"wix",d.metaData.videoUrl=e.src):d.metaData.qualities=[{width:a.width,height:a.height,quality:a.height+"p",formats:[Ta(e.src)?"wix":e.src.split(/#|\?/)[0].split(".").pop().trim()]}]}return d}(e,t):function(e,t){return{itemId:ma(t+"_"+(e.uri||e.alt||t)),mediaUrl:e.uri||"",metaData:{height:e.height||1,lastModified:Date.now(),link:Ia(e.link,e.target),title:e.title||"",description:e.description||"",alt:e.alt||"",sourceName:"private",tags:[],width:e.width||1},orderIndex:t}}(e,t)},Pa=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=!0),t?function(e){void 0===e&&(e={});var t=e.metaData||e.metadata||{},r=Ea(t.link)||{},n=va({type:t.type||"image",slug:e.itemId},r),o=n.type.toLowerCase();if("text"===o){var a=t.testStyle||{};Object.assign(n,{html:t.html,style:{width:a.width,height:a.height,bgColor:a.backgroundColor}})}else Object.assign(n,{title:t.title,description:t.description,alt:t.alt}),"image"===o?Object.assign(n,va(va({src:wa(e.mediaUrl,t),settings:Object.assign({},t.focalPoint?{focalPoint:t.focalPoint}:{})},"imageToken"in e&&{imageToken:e.imageToken}),"token"in e&&{token:e.token})):"video"===o&&Object.assign(n,{src:Oa(e.mediaUrl,t),thumbnail:t.posters[0].url});return n}(e):(n=(r=e).metaData||r.metadata||{},o=Ea(n.link)||{},va({uri:r.mediaUrl,description:n.description,alt:n.alt,title:n.title,height:n.height,width:n.width},o));var r,n,o};const{mediaGallery:Na,documentArray:Da}=l.FieldType,Aa=e=>{let{value:t,currentValue:r=[],fieldType:n}=e;switch(n){case Na:return[...r,...t.map((e=>{let{fileUrl:t,url:r}=e;return(e=>{let{uploadedFileUrl:t}=e;const{platform:{utils:{media:r}}}=U,n=r.parseMediaItemUri(t),o=r.createMediaItemUri(n).item,a=Ca({...n,src:o});return Pa(a)})({uploadedFileUrl:t||r})}))];case Da:return[...r,...t.map((e=>{let{fileUrl:t,url:r}=e;return t||r}))];default:return t[0].fileUrl||t[0].url}},{reference:xa,dateTime:La,date:Fa}=l.FieldType,Ma=e=>{let{value:t,currentValue:r,fieldType:n,fieldName:o,role:a,utils:{referenceFetcher:i}={}}=e;const s=[{converter:e=>i(e,o),condition:n===xa},{converter:e=>((e,t)=>{const r={},n={};if(ra(e))r.time=e,r.date=new Date;else{const t=ia(e);r.date=t,r.time=aa(t)}return ra(t)?n.time=t:n.date=ia(t),oa({...r,...n})})(r,e),condition:n===La&&[ie,he,se].includes(a)},{converter:ca,condition:n===Fa&&a===ie},{converter:e=>Aa({value:e,currentValue:r,fieldType:n}),condition:a===ce}],c=s.reduce(((e,t)=>{let{converter:r,condition:n}=t;return n&&e.push(r),e}),[]);return(0,D.flow)(c)(t)},Ua=e=>{let{value:t,role:r,fieldType:n,propPath:o,componentIsInput:a,format:i,utils:{formatter:s}={}}=e;return(0,D.flow)([e=>(e=>{let{value:t,formatter:r,fieldType:n,format:o}=e;return o?la({value:t,formatter:r,fieldType:n,format:o}):t})({value:e,formatter:s,fieldType:n,format:i}),e=>ha(e,{fieldType:n,role:r,componentIsInput:a,propPath:o})])(t)},ka={ALIGN:(e,t)=>t,SPACES:e=>"&nbsp;".repeat(Number(e)),STRIKE:e=>`<span style="text-decoration: line-through" class="wixui-rich-text__text">${e}</span>`,UNDERLINE:e=>`<span style="text-decoration: underline" class="wixui-rich-text__text">${e}</span>`,ITALIC:e=>`<span style="font-style: italic" class="wixui-rich-text__text">${e}</span>`,BOLD:e=>`<span style="font-weight: bold" class="wixui-rich-text__text">${e}</span>`,HIGHLIGHT:(e,t)=>`<span style="background-color: ${e}" class="wixui-rich-text__text">${t}</span>`,COLOR:(e,t)=>`<span style="color: ${e}" class="wixui-rich-text__text">${t}</span>`},Ga=(...e)=>[...e],ja=({expression:e,functions:t,variables:r,throwIfVariableUnknown:n})=>{if("integer"===e.type)return parseInt(e.value);if("float"===e.type)return parseFloat(e.value);if("string"===e.type)return e.value;if("function"===e.type){const o="function"==typeof e.name?e.name:t[e.name];if(o)return o(...e.arguments.map((e=>ja({expression:e,functions:t,variables:r,throwIfVariableUnknown:n}))));throw new Error("Unknown function "+e.name)}if("variable"===e.type){if("false"===e.name)return!1;if("true"===e.name)return!0;if("undefined"===e.name)return;if("null"===e.name)return null;if(n&&!(e.name in r))throw new Error("Unknown variable "+e.name);return r[e.name]}throw new Error("Unknown AST node "+JSON.stringify(e))},Ba=e=>new Error("Syntax error. "+e),Va=e=>{if(0===e.trim().length)return{type:"string",parentFunction:void 0,closed:!0,value:"",doubleQuoted:!1,startedAt:0};let t={type:"initial",parentFunction:void 0},r=0,n=e[r];const o=()=>{n=e[++r]},a=e=>{t={type:"initial",parentFunction:e},o()},i=()=>void 0===n||")"===n&&(t.parentFunction&&!t.parentFunction.closed||"function"===t.type&&!t.closed)||"]"===n&&(t.parentFunction&&t.parentFunction.name===Ga&&!t.parentFunction.closed||"function"===t.type&&t.name===Ga&&!t.closed),s=()=>{if(void 0===n){const r=t.parentFunction||t;if("function"===r.type&&!r.closed)throw Ba("Function was not closed. Started at index "+r.startedAt+" with: "+e.slice(r.startedAt))}if(t.parentFunction)return"function"!==t.type||t.closed?(t.parentFunction.closed=!0,t=t.parentFunction,t.parentFunction&&(t=t.parentFunction)):(t.closed=!0,t=t.parentFunction),void o();for(o();/^\s$/.test(n||"");)o();if(void 0!==n)throw Ba("Unexpected characters after a finished expression at index "+r+": "+e.slice(r));return t};for(;;){if("initial"===t.type){if("["===n){t={type:"function",parentFunction:t.parentFunction,closed:!1,name:Ga,startedAt:r,arguments:[]},t.parentFunction&&t.parentFunction.arguments.push(t),o();continue}if("-"===n){t={type:"integer",parentFunction:t.parentFunction,closed:!1,value:"-"},t.parentFunction&&t.parentFunction.arguments.push(t),o();continue}if(n>="0"&&n<="9"){t={type:"integer",parentFunction:t.parentFunction,closed:!1,value:n},t.parentFunction&&t.parentFunction.arguments.push(t),o();continue}if("_"===n||n>="a"&&n<="z"||n>="A"&&n<="Z"){t={type:"variable",parentFunction:t.parentFunction,closed:!1,name:n,startedAt:r},t.parentFunction&&t.parentFunction.arguments.push(t),o();continue}if('"'===n||"'"===n){t={type:"string",parentFunction:t.parentFunction,closed:!1,doubleQuoted:'"'===n,startedAt:r,value:""},t.parentFunction&&t.parentFunction.arguments.push(t),o();continue}if(/^\s$/.test(n)){o();continue}throw Ba(`Unexpected character "${n}" near: ${e.slice(r)}`)}if("function"!==t.type){if("integer"===t.type){if("."===n){t.parentFunction&&t.parentFunction.arguments.pop(),t={type:"float",parentFunction:t.parentFunction,closed:!1,value:t.value+n},t.parentFunction&&t.parentFunction.arguments.push(t),o();continue}if(n>="0"&&n<="9"){if(t.closed)throw Ba(`Integer has unexpected whitespace near: ${e.slice(r-1)}`);t.value+=n,o();continue}if(","===n&&t.parentFunction){a(t.parentFunction);continue}if(i()){const e=s();if(e)return e;continue}if(/^\s$/.test(n)){t.closed=!0,o();continue}throw Ba(`Unexpected character "${n}" after integer near: ${e.slice(r)}`)}if("float"===t.type){if(n>="0"&&n<="9"){if(t.closed)throw Ba(`Floating number has unexpected whitespace near: ${e.slice(r-1)}`);t.value+=n,o();continue}if(","===n&&t.parentFunction){a(t.parentFunction);continue}if(i()){const e=s();if(e)return e;continue}if(/^\s$/.test(n)){t.closed=!0,o();continue}throw Ba(`Floating number has an unexpected character "${n}" near: ${e.slice(r)}`)}if("string"!==t.type){if("variable"===t.type){if(n>="0"&&n<="9"||"_"===n||n>="a"&&n<="z"||n>="A"&&n<="Z"){if(t.closed)throw Ba(`Unexpected whitespace near: ${e.slice(r-1)}`);t.name+=n,o();continue}if("("===n){t.parentFunction&&t.parentFunction.arguments.pop(),t={type:"function",parentFunction:t.parentFunction,closed:!1,name:t.name,startedAt:t.startedAt,arguments:[]},t.parentFunction&&t.parentFunction.arguments.push(t),o();continue}if(","===n&&t.parentFunction){a(t.parentFunction);continue}if(i()){const e=s();if(e)return e;continue}if(/^\s$/.test(n)){t.closed=!0,o();continue}throw Ba(`Unexpected character "${n}" in an identifier near: ${e.slice(r-1)}`)}}else{if(t.closed){if(","===n&&t.parentFunction){a(t.parentFunction);continue}if(i()){const e=s();if(e)return e;continue}if(/^\s$/.test(n)){o();continue}throw Ba("Unexpected characters after a closed string at index "+r+": "+e.slice(r))}if(void 0===n)throw Ba(`${t.doubleQuoted?"Double":"Single"}-quoted string was not closed. Started with: ${e.slice(t.startedAt)}`);if("\\"===n){if("\\"!==e[r+1]&&'"'!==e[r+1]&&"'"!==e[r+1])throw Ba(`Backslash cannot escape character ${e[r+1]} near: ${e.slice(r)}`);t.value+=e[r+1],o()}else t.doubleQuoted&&'"'===n||!t.doubleQuoted&&"'"===n?t.closed=!0:t.value+=n;o()}}else{if(","===n){if(t.closed)throw Ba("Unexpected comma after a closed top-level function near: "+e.slice(r));if(0===t.arguments.length)throw Ba("Function was not closed or first argument missing. Started at index "+t.startedAt+" with: "+e.slice(t.startedAt));a(t);continue}if(i()){const e=s();if(e)return e;continue}if(/^\s$/.test(n)){o();continue}if(t.closed)throw Ba(`Unexpected character "${n}" near: ${e.slice(r)}`);t={type:"initial",parentFunction:t}}}},Wa=Object.keys(ka),qa=e=>"function"===e.type&&(!("string"!=typeof e.name||!Wa.includes(e.name))||e.arguments.some((e=>qa(e)))),Ha=({expression:e,functions:t,variables:r,throwIfVariableUnknown:n=!1})=>(({expression:e,functions:t,variables:r,throwIfVariableUnknown:n})=>{const o=ja({expression:e,functions:t,variables:r,throwIfVariableUnknown:n});return qa(e)?{html:String(o),alignment:"function"===e.type&&"ALIGN"===e.name&&e.arguments[0]?String(ja({expression:e.arguments[0],functions:t,variables:r,throwIfVariableUnknown:n})):"left"}:o})({expression:Va(e),functions:t,variables:r,throwIfVariableUnknown:n});var $a=function(e,t){return $a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},$a(e,t)};function za(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}$a(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function Ya(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}Object.create;Object.create;"function"==typeof SuppressedError&&SuppressedError;let Xa;const Ja=async()=>{if(Xa)return;const e=await a.e(901).then(a.bind(a,1333)),{utils:t}=e,r=Ya(e,["utils"]);Xa=Object.assign(Object.assign(Object.assign({},r),t.symbols),ka)},Ka=()=>Xa,Qa=e=>{let{expression:t,record:r,prop:n,role:o,componentIsInput:a,logger:i}=e;try{const e=Ha({expression:t,variables:r,functions:Ka()});if("object"==typeof e&&null!==e&&"html"in e&&"alignment"in e&&2===Object.keys(e).length){const{html:t,alignment:r}=e,i="$text"===n?"html":n;return{value:'<p class="wixui-rich-text__text" style="text-align: '+r+';">'+Ua({value:t,role:o,componentIsInput:a,propPath:i})+"</p>",propPath:i}}{const t="$text"===n?"text":n;return{value:Ua({value:e,role:o,componentIsInput:a,propPath:t}),propPath:t}}}catch(e){return i.log("Failed to evaluate expression: "+e),{propPath:"$text"===n?"text":n,value:""}}},Za=e=>{let{recordStore:t}=e;return t().fold((()=>null),(e=>e.isCursorPaging()))},ei=e=>{let{state:t}=e;const{size:r}=jr(t);return r},ti=e=>{let{state:t}=e;const{offset:r}=jr(t);return r},ri=e=>{let{state:t}=e;const{size:r,numPagesToShow:n}=jr(t);return r*n},ni=e=>{let{state:t}=e;const r=en(t);return null==r?null:r},oi=e=>{let{state:t}=e;if(null==ni({state:t}))return null;const{features:r}=U;if(r.newCurrentPageIndex){const{size:e,offset:r}=jr(t);return r/e+1}const{size:n,offset:o,numPagesToShow:a}=jr(t);return o/n+a},ai=e=>{let{recordStore:t}=e;return t().fold((()=>null),(e=>e.getDatasetSize()))},ii=e=>{let{state:t,recordStore:r}=e;const n=ai({recordStore:r});return n?Math.ceil(n.total/ei({state:t})):null},si=e=>{let{recordStore:t}=e;return t().fold((()=>!1),(e=>{const t=e.getDatasetSize();return e.isCursorPaging()&&!(null==t||!t.cursor)}))},ci=e=>{let{state:t}=e;const r=ni({state:t});return null!=r&&r>0},li=e=>{let{state:t,recordStore:r}=e;if(si({recordStore:r}))return!0;const n=ai({recordStore:r});if(!n)return!1;const o=ni({state:t});return null!=o&&o<n.total-1},di=e=>{let{state:t}=e;const{offset:r}=jr(t);return r>0},ui=e=>{let{state:t,recordStore:r}=e;if(si({recordStore:r}))return!0;const n=ai({recordStore:r});if(!n)return!1;const{offset:o,size:a}=jr(t);return o+a<n.total},pi=async e=>{let{index:t,recordStore:r}=e;await r().fold((()=>{}),(e=>e.getRecords(t,1)))},{Checkbox:fi,Dropdown:hi}=He,mi=e=>e.type===fi?"checked":"value",gi=e=>{let{component:t,connectionConfig:r,currentRecord:n,previousRecord:o,getFieldType:a,formatter:i,modeIsLivePreview:s,logger:c,recordStore:l,actions:d}=e;const{role:u,isInput:p}=t,{properties:f={},totalCount:h,expressions:m={}}=r,g={};if(h&&!d.isCursorPaging()){var y;const e=null==(y=ai({recordStore:l}))?void 0:y.total;if("number"==typeof e){const r=Ua({value:e,role:u});t.setValue(r,{propPath:h.prop})}}n&&(Ve(m).forEach((e=>{let[r,{expression:o}]=e;const{value:a,propPath:i}=Qa({expression:o,record:n,prop:r,role:u,componentIsInput:p,logger:c});g[i]=a,t.setValue(a,{propPath:i})})),Ve(f).forEach((e=>{let[r,l]=e;try{const{fieldName:e,format:c}=l,d=a(e).getOrElse(void 0),f=Ua({value:Qo(n,e),role:u,componentIsInput:p,fieldType:d,propPath:r,format:c,utils:{formatter:i}});if(g[r]=f,(e=>{let{previousRecord:t,currentRecord:r,fieldName:n}=e;return(e=>!e)(t)||Zo({previousRecord:t,currentRecord:r,fieldName:n})})({currentRecord:n,previousRecord:o,fieldName:e})){if(s&&(e=>void 0===e||""===e||Array.isArray(e)&&0===e.length)(f))return;t.setValue(f,{propPath:r,fieldType:d,binding:l})}}catch(e){c.log(new w("Failed setting "+r,{cause:e}))}})))},yi=e=>{let{getConnectedComponents:t,getFieldType:r}=e;return e=>{const n=t();if(!n)return je.Maybe.Nothing();const o=n.filter((e=>{let{role:t}=e;return t===Q}));return zo(e).map((e=>{let{field:t,condition:n,value:a,positive:i}=e;const s=((e,t)=>e.map((e=>e===Ko&&"string"==typeof t&&/^[+-]?(?:\d+\.?\d*|\d*\.?\d+)$/.test(t.trim())?Number(t):e===Jo&&0===(0,D.get)(t,"length",0)?null:t)).getOrElse(t))(r(t),((e,t)=>{const{filterId:r}=e,n=t.find((e=>e.connectionConfig.filters[r]));if(!n)return;const o=mi(n);return n.getValue({propPath:o})})(a,o));if(!s&&0!==s)return{$and:[]};const c={[t]:{[n]:s}};return i?c:{$not:[c]}}))}};var vi=a(4479),_i=a(8031),Ii=a(3878);const Ei=e=>(0,vi.X)(e)||(0,_i.X)(e)||Si(e),Ti=e=>{let{valueResolvers:t,getConnectedComponents:r,getFieldType:n,getUserFilterInitialData:o,wasSetFilterCalled:a}=e;return e=>{const i=qo(Ei,(e=>(0,vi.X)(e)?t.currentUser():(0,_i.X)(e)?t.dataBinding(e):Si(e)?t.userInput(e):void 0),e).map((e=>{if(a())return e;const t=r().filter((e=>{let{role:t}=e;return we.includes(t)})).map((e=>{const{userInputFilter:t}=e.connectionConfig,{prop:r,fieldName:a}=t,i=e.getValue({propPath:r}),s=kn(a)?Cn(a):a;if([Oe,"",!1].includes(i)||(0,D.isEqual)(i,[])||e.role===Re&&(0,D.isEqual)(i,e.getBounds()))return null;const c=(e=>{let{value:t,fieldType:r,fieldName:n,getUserFilterInitialData:o}=e;switch(r){case l.FieldType.reference:{var a;const e=null==(a=o())?void 0:a.find((e=>e.fieldName===n&&be.includes(e.role)));if(!e)return null;const{referencedItemIdsByOption:r}=e;return(0,D.isArray)(t)?t.flatMap((e=>r[e])):r[t]}case l.FieldType.number:return Array.isArray(t)?t.map(Number):Number(t);default:return t}})({value:i,fieldType:n(s).getOrElse(null),fieldName:a,getUserFilterInitialData:o});if(null===c)return null;return{[s]:e.role===Re?{$gte:c[0],$lte:c[1]}:Array.isArray(c)?{$hasSome:c}:c}})).filter(Boolean);return 0===t.length?e:{$and:[e].filter(Boolean).concat(t)}}));return i}},Si=e=>zo(e).map((e=>{let{value:t}=e;return(0,Ii.X)(t)})).getOrElse(!1),Ri=e=>Vo(_i.X,e),wi=e=>!(0,D.isEmpty)(Vo(Ii.X,e)),Oi=e=>wi(e)||(e=>!(0,D.isEmpty)(Vo(vi.X,e)))(e)||(e=>Ri(e).length>0)(e),{WRITE:bi}=e,Ci=(e,t,r)=>{const{readWriteType:n,deferred:o,filter:a,collectionName:i}=e,s=n===bi,c=r.some((e=>{let{role:t}=e;return t===K})),l=t===mr,d=Boolean(o)&&!(c||l||s),u=a&&Oi(a),p=(e=>{let{collectionId:t,datasetHasDynamicFilter:r,datasetIsDeferred:n,datasetIsRouter:o,datasetIsWriteOnly:a}=e;return t?r||n||o||a?"REGULAR":Go:"UNCONFIGURED"})({collectionId:i,datasetHasDynamicFilter:u,datasetIsDeferred:d,datasetIsRouter:l,datasetIsWriteOnly:s});return{sequenceType:p,datasetIsWriteOnly:s,datasetIsMaster:c,datasetIsRouter:l,datasetIsDeferred:d,datasetHasDynamicFilter:u}},Pi=e=>{const t=(0,D.values)({DATASET:hr,ROUTER_DATASET:mr});return e.map((e=>{const{id:r,type:n,collectionId:o,filter:a,sort:i,pageSize:s,readWriteType:c,includes:l,nested:d,deferred:u,connections:p,dataIsInvalidated:f,updatedCompIds:h,dynamicPageData:m,cursor:g}=e;t.includes(n)||U.logger.log(new w("type of controller MUST be one of "+t+" but is "+n));const y=(0,D.defaults)({collectionName:o,filter:a,sort:i,includes:l,nested:d,pageSize:s,readWriteType:c,cursor:g,deferred:u,uniqueFieldValues:[]},Rt);return{id:r,compId:r,type:n,livePreviewOptions:{shouldFetchData:f,compsIdsToReset:h},connections:p,dynamicPageData:m,config:{dataset:y,datasetStaticConfig:Ci(y,n,p)}}}))},Ni=Symbol("isPristine"),Di=e=>e._id,Ai=e=>({...e,[Ni]:!1}),xi=(e,t)=>({...e,_id:t||(0,I.v4)(),[Ni]:!0}),Li=(e,t)=>e&&t&&e._id===t._id,Fi=e=>(0,D.omit)(e,[Ni]),Mi=e=>{let{record:t,draft:r,includes:n,nestedFieldKeys:o,fieldKey:a}=e;return(e=>{let{includes:t,nestedFieldKeys:r,fieldKey:n}=e;const o=null==t?void 0:t.includes(n),a=r.includes(n);return o||a})({includes:n,nestedFieldKeys:o,fieldKey:a})&&(e=>{let{record:t,draft:r,fieldKey:n}=e;return(0,D.isPlainObject)(t[n])&&(0,D.isPlainObject)(r[n])})({record:t,draft:r,fieldKey:a})},Ui={chain:e=>t=>e.matchWith({Empty:()=>e,Results:e=>{let{items:r,datasetSize:n,offset:o}=e;return t({items:r,datasetSize:n,offset:o})}}),map:e=>t=>e.matchWith({Empty:()=>e,Results:e=>{let{items:r,datasetSize:n,offset:o}=e;const{items:a=r,datasetSize:i=n,offset:s=o}=t({items:r,datasetSize:n,offset:o});return ki.Results(a,i,s)}}),filter:e=>t=>e.matchWith({Empty:()=>e,Results:r=>{let{items:n,datasetSize:o,offset:a}=r;return t({items:n,datasetSize:o,offset:a})?e:ki.Empty()}}),orElse:e=>t=>e.matchWith({Empty:()=>t(),Results:()=>e}),get:e=>()=>e.matchWith({Empty:()=>({items:[],datasetSize:{total:0,loaded:0},offset:0}),Results:e=>e}),of:()=>Gi},ki=(0,je.union)("QueryResults",{Empty:()=>({}),Results:function(e,t,r){return void 0===r&&(r=0),{items:e,datasetSize:t,offset:r}}},Ui);function Gi(e){let{items:t,datasetSize:r,offset:n}=e;return r&&Math.max(r.total,r.loaded)>0&&Array.isArray(t)?ki.Results(t,r,n):ki.Empty()}const ji={Empty:ki.Empty,Results:ki.Results,fromWixDataQueryResults:function(e,t){return e?this.of({items:e.items,datasetSize:e.datasetSize,offset:t}):ki.Empty()},of:Gi},Bi=e=>t=>({...t,...e}),Vi=(e,t)=>r=>t(e(r))(r),Wi=(e,t,r)=>{const n=new Map;return function(){for(var o=arguments.length,a=new Array(o),i=0;i<o;i++)a[i]=arguments[i];const s=t(a),c=n.get(s);if(c&&r(a,c.args))return c.result;const l=e.apply(this,a);return n.set(s,{args:a,result:l}),l}},qi=e=>Bi({records:e}),Hi=e=>t=>{var r,n,o;return{...t,datasetSize:{cursor:null==(r=t.datasetSize)?void 0:r.cursor,total:((null==(n=t.datasetSize)?void 0:n.total)||0)+e,loaded:((null==(o=t.datasetSize)?void 0:o.loaded)||0)+e}}},$i=e=>{let{cursor:t,loaded:r,total:n}=e;return e=>({...e,datasetSize:{cursor:t,loaded:r+Ji(e),total:n+Ji(e)}})},zi=e=>({...e,numSeedRecords:e.records.length}),Yi=e=>e.matchWith({Empty:()=>$i({total:0,loaded:0}),Results:e=>{let{items:t,datasetSize:r}=e;return(0,D.flow)(qi(t.map((e=>Di(e)))),$i(r),zi)}}),Xi=e=>t=>({...t,newRecordMarkers:e(t.newRecordMarkers)}),Ji=(e,t)=>e.newRecordMarkers.filter((e=>null==t||e<=t)).length,Ki=function(e,t,r){let{overwrite:n=!0,fixIndex:o=!0}=void 0===r?{}:r;return Vi((r=>{const a=e+(o?Ji(r,e):0),i=Math.max(0,a-r.records.length),s=a+(n?t.length:0);return r.records.slice(0,a).concat(new Array(i)).concat(t.map((e=>Di(e)))).concat(r.records.slice(s))}),qi)},Qi=(e,t,r)=>n=>Object.assign({},e(n),...r.map((e=>({[t(e)]:e})))),Zi=(e,t,r)=>n=>({...e(n),[t]:r(e(n)[t])}),es=(e,t)=>r=>Object.assign({},...Object.keys(e(r)).filter((e=>e!==t)).map((t=>({[t]:e(r)[t]})))),ts=e=>Bi({records:e}),rs=e=>Bi({drafts:e}),ns=(0,D.curry)(((e,t,r)=>Bi({scopes:{...r.scopes,[e]:t}})(r))),os=e=>t=>t.scopes[e],as=e=>Vi(Qi((e=>{let{records:t}=e;return t}),Di,e),ts),is=e=>Vi(Qi((e=>{let{drafts:t}=e;return t}),Di,[e]),rs),ss=e=>Vi(es((e=>{let{drafts:t}=e;return t}),Di(e)),rs),cs=()=>rs({}),ls=e=>e.matchWith({Empty:()=>e=>e,Results:e=>{let{items:t}=e;return t.length>0?as(t):e=>e}}),ds=(e,t)=>Vi(Zi((e=>{let{drafts:t}=e;return t}),e,(0,D.flow)(Ai,(e=>t=>Object.entries(e).reduce(((e,t)=>{let[r,n]=t;return(0,D.set)(e,r,n)}),(0,D.cloneDeep)(t)))(t))),rs),us=(e,t,r,n)=>{const o=t.records[e],a=t.drafts[e],i=(0,D.isPlainObject)(o),s=(0,D.isPlainObject)(a);return i&&s?(e=>{let{record:t,draft:{_id:r,...n},includes:o,nestedFieldKeys:a}=e;const i=Object.keys(n).filter((e=>Mi({record:t,draft:n,includes:o,nestedFieldKeys:a,fieldKey:e}))),s={...t,...n};return i.reduce(((e,r)=>({...e,[r]:(0,D.merge)({},t[r],n[r])})),s)})({record:o,draft:a,includes:r,nestedFieldKeys:n}):i?{...o}:s?{...a}:null},ps=(0,D.curry)(((e,t,r)=>Object.keys(r.scopes).filter((e=>t(r.scopes[e],e))).map((t=>e(r.scopes[t],t))))),fs=(0,D.curry)((function(e,t,r,n,o,a,i){void 0===i&&(i=!1);const{records:s,datasetSize:c}=os(e)(a),l=r-t,d=s.slice(t,r).reduce(((e,t)=>{const r=us(t,a,n,o);return null!=r?e.concat(Fi(r)):e}),[]);return ji.of({items:d,datasetSize:c,offset:t}).filter((function(e){let{items:t}=e;return i||t.length>=l}))})),hs=(0,D.curry)(((e,t)=>Vi((0,D.flow)(os(e),t),ns(e)))),ms=(0,D.curry)(((e,t)=>Bi({[e]:t}))),gs=e=>t=>t[e],ys=(0,D.curry)(((e,t)=>Vi((0,D.flow)(gs(e),t),ms(e)))),vs=e=>e===ke,_s=e=>{let[{datasetId:t}]=e;return t},Is=(e,t)=>{let[r]=e,[n]=t;return(0,D.every)(r,((e,t)=>{return"filter"===t?(r=e,o=n[t],JSON.stringify(r)===JSON.stringify(o)):e===n[t];var r,o}))},Es=e=>{let{primaryDatasetId:t,recordStoreCache:r,refreshStoreCache:n,dataProvider:o,mainCollectionName:a,includes:i,nestedFieldKeys:s,uniqueFieldValues:c,readWriteType:d,cursorPagingRequired:u}=e;const{breadcrumbReporting:p}=U,f=()=>r[t],h=e=>{r[t]=e};((0,D.isEmpty)(f())||n||vs(d))&&h((e=>({[e]:{records:{},drafts:{},scopes:{}}}))(a));const m=[],g=Wi((e=>{let{pageSize:t,sort:r,filter:n,datasetId:g,referencedCollectionName:y,fixedRecordId:v}=e;const _=null!=y?y:a,I=JSON.stringify({filter:n,sort:r}),E=gs(_),T=ys(_),S=(0,D.flow)(E,os(I)),R=hs(I),w=()=>o.getSchema(_),O=e=>e-e%t,b=(0,D.memoize)((e=>{let{offset:t,length:a,datasetSize:s}=e;return o.getData({datasetId:g,length:a,collectionId:_,cursorPaging:U.isCursorPaging(),offset:t,filter:n,sort:r,includes:null!=y?void 0:i,uniqueFieldValues:c,datasetSize:s}).then((e=>({items:e.items,datasetSize:e.datasetSize,offset:t})))}),(e=>{let{offset:t,length:r,datasetSize:n}=e;return[t,r,null==n?void 0:n.cursor].join("-")})),C=e=>U.isCursorPaging()?(async e=>{const t=[];let{datasetSize:r}=S(f());for(const{offset:n,length:o}of e){const e=await b({offset:n,length:o,datasetSize:r});if(t.push(e),r=e.datasetSize,!r.cursor)break}return t})(e):Promise.all(e.map((e=>{let{offset:t,length:r}=e;return b({offset:t,length:r})}))),P=(e,r,n)=>{const o=U.isCursorPaging()?0:O(r),a=(i=r,s=n,Math.ceil((O(i)+(s-O(i)))/t)*t);var i,s;const c=Un(w())||l.DefaultMaxPageSize[U.getPaging()],d=((e,t,r)=>{const n=e.records.slice(t,r),o=n.findIndex(u),a=((e,t)=>{if(t.length>0)for(let r=t.length-1;r>=0;r-=1)if(e(t[r]))return r;return-1})(u,n),i=p(o,t),s=p(a,r),c=Ji(e,i),l=i-c,d=s-c-l;return 0===d?je.Maybe.Nothing():je.Maybe.Just({offset:l,length:d});function u(e){return"string"!=typeof e}function p(t,r){return-1===t?Math.max(e.records.length,r):o+r}})(e,o,a),u=d.map((e=>{let{offset:t,length:r}=e;return r<=c?[{offset:t,length:r}]:(0,D.flatten)((0,D.times)(Math.ceil(r/c),(e=>[{offset:t+e*c,length:Math.min(c,r-e*c)}])))})).getOrElse([]);return C(u)},N=(e,t,r)=>Bo()(je.Result,m.map((n=>je.Result.try((()=>n(null!=e?Fi(e):null,null!=t?Fi(t):null,r)))))),A=function(e,t,r){const n=S(f()).records[r],o=us(n,E(f()),i,s);if(null==o)return t();{const t=function(){h((0,D.flow)(...arguments)(f()))},d=e=>{const t=us(n,E(f()),i,s);return(0,D.isEqual)(o,t)?je.Result.Ok([]):N(o,t,e)};for(var a=arguments.length,c=new Array(a>3?a-3:0),l=3;l<a;l++)c[l-3]=arguments[l];return e({update:t,notifyIfChanged:d},o,r,...c)}},x=(e,t)=>function(r){for(var n=arguments.length,o=new Array(n>1?n-1:0),a=1;a<n;a++)o[a-1]=arguments[a];return A(e,t,r,...o)},L=(e,t)=>async function(r){for(var n=arguments.length,o=new Array(n>1?n-1:0),a=1;a<n;a++)o[a-1]=arguments[a];return A(e,t,r,...o)},F=(e,t)=>p(t,xe.with({category:"recordStore",message:e,data:{datasetId:g,scope:I}})),M=e=>{return e&&(t=Di(e),!E(f()).records[t]);var t},U={getRecords:F("getRecords",(async(e,t)=>{const{datasetSize:r}=S(f()),n=(e=>{let{from:t,length:r,datasetSize:n,cursorPaging:o}=e;if(!n)return t+r;const{total:a,loaded:i,cursor:s}=n,c=o?s?1/0:i:a;return Math.min(t+r,c)})({from:e,length:t,datasetSize:r,cursorPaging:U.isCursorPaging()}),o=fs(I,e,n,i,s),a=vs(d)||!r||(e=>{let{loaded:t,total:r,cursor:n}=e;return!t&&!r&&!n})(r);return o(E(f()),a).orElse((async()=>{const t=await P(S(f()),e,n),r=T((0,D.flow)(...t.map((e=>{let{items:t,datasetSize:r,offset:n}=e;return ji.fromWixDataQueryResults({items:t,datasetSize:r},n)})).map((e=>(0,D.flow)(ls(e),R(e.matchWith({Empty:()=>$i({total:0,loaded:0}),Results:e=>{let{items:t,datasetSize:r,offset:n}=e;return(0,D.flow)($i(r),t.length>0?Ki(n,t):e=>e)}}))))))),a=f();var i,s;return h(r(f())),i=E(a),s=E(f()),Object.keys(i.records).filter((e=>(0,D.isPlainObject)(s.records[e])&&s.records[e]._updatedDate>i.records[e]._updatedDate)).forEach((e=>N(i.records[e],s.records[e]))),o(E(f()),!0)}))})),getRecordsLimitedByMaxPageSize:(e,t)=>{const r=Math.min(t,Un(w())||t);return U.getRecords(e,r)},seed:F("seed",(()=>{if(0===S(f()).numSeedRecords){return(v?o.getData({datasetId:g,length:t,collectionId:_,cursorPaging:void 0,offset:0,filter:n,sort:r,includes:null!=y?void 0:i,uniqueFieldValues:c}):o.getInitialData({datasetId:g,collectionId:_,filter:n,sort:r,includes:i,length:t,uniqueFieldValues:c})).then((e=>{const t=ji.fromWixDataQueryResults(e,0),r=T((0,D.flow)(ls(t),R(Yi(t))));h(r(f()))}))}return Promise.resolve()})),getTheStore:f,getPaging:()=>(({schema:e,cursorPagingPreferred:t})=>{var r,n,o;const a=null===(r=null==e?void 0:e.pagingMode)||void 0===r?void 0:r.includes(l.PagingMode.Offset),i=null===(n=null==e?void 0:e.pagingMode)||void 0===n?void 0:n.includes(l.PagingMode.Cursor);return 1===(null===(o=null==e?void 0:e.pagingMode)||void 0===o?void 0:o.length)&&i||a&&i&&t?l.PagingMode.Cursor:l.PagingMode.Offset})({schema:w(),cursorPagingPreferred:u}),isCursorPaging:()=>U.getPaging()===l.PagingMode.Cursor,getSeedRecords:F("getSeedRecords",(()=>fs(I,0,S(f()).numSeedRecords,i,s,E(f()),!0))),getDatasetSize:F("getDatasetSize",(()=>S(f()).datasetSize)),getRecordById:F("getRecordById",(e=>je.Maybe.fromNullable(E(f()).records[e]))),removeRecord:F("removeRecord",L((async(e,t)=>{let{update:r,notifyIfChanged:n}=e;const a=Di(t);!M(t)&&a&&await o.remove({collectionId:_,recordId:a}),b.cache.clear();const i=ps(((e,t)=>{return hs(t,(0,D.flow)((n=a,Vi((e=>e.records.filter((e=>e!==n))),qi)),Hi(-1),Xi((r=((e,t)=>t.records.indexOf(e))(a,e),e=>e.filter((e=>e!==r))))));var r,n}),(s=a,e=>e.records.includes(s)),E(f()));var s;return r(T((0,D.flow)((0,D.flow)(ss(t),(e=>Vi(es((e=>{let{records:t}=e;return t}),e),ts))(a)),...i))),n()}),(()=>Promise.resolve(je.Result.Error("cannot remove record: index not found"))))),reset:F("reset",(()=>{b.cache.clear(),h(T((0,D.flow)(ns(I,{records:[],numSeedRecords:0,newRecordMarkers:[]}),cs()))(f()))})),newRecord:F("newRecord",((e,t)=>{const r=xi(t),n=T((0,D.flow)(is(r),R((0,D.flow)(Hi(1),Bi({newRecordMarkers:[e]}),Ki(e,[r],{overwrite:!1,fixIndex:!1})))));return h(n(f())),N(null,r),Fi(r)})),saveRecord:F("saveRecord",L((async(e,t,r)=>{let{update:n,notifyIfChanged:a}=e;const i=await o.save({collectionId:_,record:Fi(t),includeReferences:!0});return n(T((0,D.flow)((e=>as([e]))(i),ss(t),R((0,D.flow)(((e,t)=>Ki(e,[t],{fixIndex:!1}))(r,i),Xi((e=>e.filter((e=>e!==r))))))))),a(),Fi(i)}),(()=>Promise.reject(new Error("cannot save record: index not found"))))),setFieldsValues:F("setFieldsValues",x(((e,t,r,n,o)=>{let{update:a,notifyIfChanged:i}=e;return Object.keys(n).length&&a(T(ds(Di(t),n))),i(o)}),(()=>je.Result.Error("cannot update field values: index not found")))),isPristine:F("isPristine",x(((e,t)=>(e=>"boolean"!=typeof e[Ni]||e[Ni])(t)),(()=>!0))),hasDraft:F("hasDraft",x(((e,t)=>(e=>"boolean"==typeof e[Ni])(t)),(()=>!1))),isNewRecord:F("isNewRecord",x(((e,t)=>M(t)),(()=>!0))),clearDrafts:F("clearDrafts",(()=>{h(T(cs())(f()))})),resetDraft:F("resetDraft",x(((e,t,r,n)=>{let{update:o,notifyIfChanged:a}=e;return o(T(M(t)?((e,t)=>Vi(Zi((e=>{let{drafts:t}=e;return t}),Di(e),(e=>xi(t,e._id))),rs))(t,n):ss(t))),a()}),(()=>je.Result.Error("cannot reset draft: index not found")))),hasSeedData:F("hasSeedData",(()=>S(f()).numSeedRecords>0)),getUniqueFieldValues:F("getUniqueFieldValues",(e=>o.getUniqueFieldValues({collectionId:_,fieldKey:e})))};if(E(f())||h(ms(_,{records:{},drafts:{},scopes:{}})(f())),!E(f()).scopes[I]){const e=[];if(v){const t=o.getRecord({collectionId:_,recordId:v,includes:i})||us(v,E(f()),i,s),r=t?[t]:[],n=r.length>0?ji.of({items:r,offset:0,datasetSize:{loaded:r.length,total:r.length}}):ji.Empty(),a=n.matchWith({Empty:je.Maybe.Nothing,Results:(0,D.flow)(ji.of,je.Maybe.Just)});(0,D.some)(r,M)&&e.push(ls(n)),a.fold((()=>{e.push(ns(I,{records:[],numSeedRecords:0,newRecordMarkers:[]}))}),(t=>{e.push(ns(I,Yi(t)({records:[],numSeedRecords:0,newRecordMarkers:[]})))}))}else e.push(ns(I,{records:[],numSeedRecords:0,newRecordMarkers:[]}));h(T((0,D.flow)(...e))(f()))}return U.externalApi={getRecords:async(e,t)=>(await U.getRecords(e,t)).map((e=>{let{items:t,...r}=e;return{items:(0,D.cloneDeep)(t),...r}})),getSeedRecords:()=>U.getSeedRecords().map((e=>{let{items:t,...r}=e;return{items:(0,D.cloneDeep)(t),...r}})),getRecordsLimitedByMaxPageSize:async(e,t)=>(await U.getRecordsLimitedByMaxPageSize(e,t)).map((e=>{let{items:t,...r}=e;return{items:(0,D.cloneDeep)(t),...r}}))},U}),_s,Is);var y;return g.onChange=(y=m,e=>(y.push(e),()=>{const t=y.indexOf(e);t>=0&&y.splice(t,1)})),g},Ts=e=>{const t={};return{setController:(r,n)=>{let{repeaterId:o,itemId:a}=r;e.log(new xe({category:"scopeStore",message:"adding scope",data:{componentId:o,itemId:a}})),t[o]=t[o]||{},t[o][a]=n},getController:e=>{let{repeaterId:r,itemId:n}=e;const o=t[r];return o&&o[n]},removeController:r=>{let{repeaterId:n,itemId:o}=r;e.log(new xe({category:"scopeStore",message:"removing scope",data:{componentId:n,itemId:o}}));const a=t[n];(0,D.get)(a,o)&&(a[o].dispose(),(0,D.unset)(a,o))},getAll:()=>Object.values(t).reduce(((e,t)=>e.concat(Object.values(t))),[])}};var Ss=a(7538);const Rs=(0,je.union)("GoToIndexResult",{Record:(e,t)=>({index:e,record:t}),InvalidIndex:()=>({}),NoRecord:()=>({})}),ws=function(e,t){return void 0===t&&(t=!1),{type:Dt,index:e,suppressRefreshView:t}},Os=(e,t)=>({type:Ot,fieldsToUpdate:e,updateSource:t}),bs=e=>({type:Wt,atIndex:e}),Cs=()=>({type:Ht}),Ps=async(e,t,r,n)=>{const o=await e(n).fold((()=>ji.Empty()),(e=>e.externalApi.getRecords(t,r)));return o.get()},Ns=(e,t)=>Ps(e,ti({state:t}),ri({state:t})),Ds=e=>({type:$t,userFilterInitialData:e}),As={doFetch:Ps,fetchCurrentPage:Ns,flushDraft:()=>({type:Gt}),goToRecordByIndexResult:(e,t)=>({type:Ft,error:e,payload:t}),incrementNumOfPagesToShow:()=>({type:Pt}),initWriteOnly:e=>e?ws(0):bs(0),loadPage:e=>({type:Lt,pageNumber:e}),newRecord:bs,newRecordResult:(e,t)=>({type:qt,error:e,payload:t}),nextPage:()=>({type:At}),previousPage:()=>({type:xt}),reInitWriteOnly:()=>bs(0),refresh:Cs,refreshCurrentRecord:()=>({type:bt}),refreshCurrentView:()=>({type:Ct}),refreshResult:(e,t)=>({type:Ft,error:e,payload:t}),remove:()=>({type:Bt}),removeCurrentRecordResult:(e,t)=>({type:Vt,error:e,payload:t}),revert:()=>({type:Ut}),revertResult:(e,t)=>({type:kt,error:e,payload:t}),saveRecordResult:(e,t)=>({type:jt,error:e,payload:t}),setCurrentIndex:ws,setCurrentRecord:(e,t,r)=>({type:wt,record:e,recordIndex:t,updateSource:r}),setDefaultRecord:e=>({type:Nt,record:e}),updateCurrentViewResult:(e,t)=>({type:Mt,error:e,payload:t}),updateFields:Os,GoToIndexResult:Rs},xs=e=>({type:Pr,connections:e}),Ls=e=>({type:Kt,filter:e}),Fs=e=>({type:Qt,sort:e}),Ms=e=>({type:Zt,isDatasetReady:e});var Us=a(6286),ks=a.n(Us);const Gs=(e,t)=>{const{middleware:r,subscribe:n,onIdle:o}=ks().createMiddleware(),a=Et(Mr,void 0,St(r,((e,t)=>()=>r=>n=>(e.log(new xe({category:"redux",message:n.type+" (dataset: "+t+")",data:(0,D.omit)(n,"type","record")})),r(n)))(e,t)));return{store:a,subscribe:n,onIdle:o}},{READ:js,WRITE:Bs,READ_WRITE:Vs}=e,Ws={[js]:"read-only",[Bs]:"write-only",[Vs]:"read-write"},qs=(e,t)=>{if(e)throw new b("Operation ("+t+") not allowed on a dataset with non-offset paging mode",{code:"OPERATION_NOT_ALLOWED"})},Hs=(e,t)=>{if(r=e(),fr.isDuringSave(r.records))throw new b("Operation ("+t+") not allowed during save",{code:"OPERATION_NOT_ALLOWED"});var r},$s=function(e,t,r,n,o){void 0===t&&(t=""),void 0===o&&(o=!0),((e,t,r)=>{if(!Vr(e()))throw new b(r===mr?"Operation ("+t+") is not allowed because the field used to build this page's URL is empty":"Operation ("+t+") not allowed on an unconfigured dataset",{code:"OPERATION_NOT_ALLOWED"})})(e,t,n),function(e,t,r){void 0===r&&(r=[]);const n=Br(e());if(!(0,D.includes)(r,n))throw new b("Operation ("+t+") not allowed on "+Ws[n]+" dataset",{code:"OPERATION_NOT_ALLOWED"})}(e,t,r),o||Hs(e,t)},zs=(e,t)=>{if(!(0,D.isNumber)(t))throw new b("Parameter ("+e+") must be a number",{code:"DS_INVALID_ARGUMENT"})},Ys=(e,t)=>{if(!(0,D.isInteger)(t)||t<1)throw new b("Parameter ("+e+") must be a positive integer number",{code:"DS_INVALID_ARGUMENT"})},Xs=(e,t)=>{if(!(0,D.isFunction)(t))throw new b("The callback passed to ("+e+") must be a function",{code:"DS_INVALID_ARGUMENT"})},Js=(e,t)=>{if(!Wr(e()))throw new b("The dataset didn't load yet. You need to call "+t+" inside the onReady for the dataset.",{code:"DS_NOT_LOADED"})},Ks=e=>{if(null==ni({state:e()}))throw new b("There is no current item",{code:"DS_NO_CURRENT_ITEM"})},Qs=(e,t)=>{if(e)throw new b('The "'+t+'" function cannot be called on the dataset because the dataset was selected using a repeated item scope selector.\nRead more about repeated item scope selectors: http://wix.to/94BuAAs/$w.Repeater.html#repeated-item-scope',{code:"OPERATION_NOT_ALLOWED"})},Zs=e=>{let{datasetType:t,siblingDynamicPageUrlGetter:r}=e;const n={getNextDynamicPage:async()=>null!=r?r.getNextDynamicPageUrl():null,getPreviousDynamicPage:async()=>r?r.getPreviousDynamicPageUrl():null};return(0,D.mapValues)(n,((e,r)=>function(){return((e,t)=>{if(e!==mr)throw new b('"'+t+'" function on the dataset is not allowed. "'+t+'" can only be called on a Dynamic Page Dataset.',{code:"OPERATION_NOT_ALLOWED"})})(t,r),e(...arguments)}))},{READ:ec,WRITE:tc,READ_WRITE:rc}=e,nc=e=>{let{store:{dispatch:t,getState:r},recordStore:n,eventListeners:{fireEvent:o,register:a},controllerStore:i,datasetId:s,datasetType:c,isFixedItem:l,siblingDynamicPageUrlGetter:d,onIdle:u,dispatcher:p,onReadyAsync:f}=e;const{logger:h,errorReporting:m,breadcrumbReporting:g,verboseReporting:y}=U,v=async function(){try{await t(As.flushDraft());const n=(e=r(),fr.selectLastSavedRecord(e.records)||Zr(r()));return(0,D.cloneDeep)(n)}catch(e){throw p.dispatch("datasetSaveError"),e}var e},_=async function(e,o){void 0===e&&(e=(e=>{let{state:t}=e;const r=ni({state:t});return null==r?0:r+1})({state:r()})),Js(r,o),$s(r,o,[tc,rc],c,!1),zs("atIndex",e),await v(),Za({recordStore:n})&&await pi({index:e,recordStore:n}),(e=>{let{index:t,datasetSize:{total:r,loaded:n}}=e;if(t<0||t>Math.max(r,n))throw new b("Invalid index",{code:"DS_INDEX_OUT_OF_RANGE"})})({index:e,datasetSize:ai({recordStore:n})}),await t(As.newRecord(e))};return e=>{const p=e?(e,t)=>m(e,O.withMessage("An error occurred in one of "+t+" callbacks")):D.identity,I={async isIdle(){await new Promise((e=>{const t=u((()=>{t(),e()}))}))},onBeforeSave:e=>(Xs("onBeforeSave",e),$s(r,"onBeforeSave",[tc,rc],c,!1),a("beforeSave",p(e,"beforeSave"))),onAfterSave:e=>(Xs("onAfterSave",e),$s(r,"onAfterSave",[tc,rc],c,!1),a("afterSave",p(e,"afterSave"))),async save(){$s(r,"save",[tc,rc],c,!1);const e=await v();return Hr(r())&&await t(As.reInitWriteOnly()),e},async getItems(e,t){$s(r,"getItems",[ec,rc],c,!1),zs("fromIndex",e),zs("numberOfItems",t);const{items:o,offset:a,datasetSize:i}=await As.doFetch(n,e,t);return{items:o,totalCount:Za({recordStore:n})?void 0:i.total,offset:a}},getTotalCount:()=>($s(r,"getTotalCount",[ec,rc],c,!1),Wr(r())?(qs(Za({recordStore:n}),"getTotalCount"),ai({recordStore:n}).total):null),getCurrentItem:()=>{$s(r,"getCurrentItem",[ec,tc,rc],c);const e=Zr(r());return e?(0,D.cloneDeep)(e):null},getCurrentItemIndex:()=>($s(r,"getCurrentItemIndex",[ec,rc],c),ni({state:r()})),async setCurrentItemIndex(e){Qs(l,"setCurrentItemIndex"),$s(r,"setCurrentItemIndex",[ec,rc],c,!1),(e=>{if(!(0,D.isInteger)(e))throw new b("Parameter ("+e+") must be a number",{code:"PARAMETER_NOT_ALLOWED"})})(e),await new Promise((e=>T.onReady(e))),qr(r())||await v(),await t(As.setCurrentIndex(e))},setFieldValue:(e,n)=>{Js(r,"setFieldValue"),$s(r,"setFieldValue",[tc,rc],c),Ks(r),t(As.updateFields({[e]:(0,D.cloneDeep)(n)}))},setFieldValues:e=>{Js(r,"setFieldValues"),$s(r,"setFieldValues",[tc,rc],c),Ks(r),t(As.updateFields((0,D.mapValues)(e,D.cloneDeep)))},async next(){if(Qs(l,"next"),Js(r,"next"),$s(r,"next",[ec,rc],c,!1),qr(r())||await v(),!T.hasNext())throw new b("There are no more items in the dataset",{code:"NO_SUCH_ITEM"});const e=ni({state:r()});return await t(As.setCurrentIndex(e+1)),T.getCurrentItem()},async previous(){if(Qs(l,"previous"),Js(r,"previous"),$s(r,"previous",[ec,rc],c,!1),qr(r())||await v(),!T.hasPrevious())throw new b("This is the first item in the dataset",{code:"NO_SUCH_ITEM"});const e=ni({state:r()});return await t(As.setCurrentIndex(e-1)),T.getCurrentItem()},hasNext:()=>($s(r,"hasNext",[ec,rc],c),li({state:r(),recordStore:n})),hasPrevious:()=>($s(r,"hasPrevious",[ec,rc],c),ci({state:r()})),new:async e=>_(e,"new"),add:async e=>_(e,"add"),async remove(){Js(r,"remove"),$s(r,"remove",[rc],c,!1);if(null==ni({state:r()}))throw new b("Invalid index",{code:"DS_INDEX_OUT_OF_RANGE"});await t(As.remove())},revert:async()=>(Js(r,"revert"),$s(r,"revert",[tc,rc],c,!1),Ks(r),t(As.revert())),async refresh(){Js(r,"refresh"),$s(r,"refresh",[ec,tc,rc],c,!1),await t(As.refresh())},onCurrentIndexChanged:e=>(Xs("onCurrentIndexChanged",e),$s(r,"onCurrentIndexChanged",[rc,ec],c,!1),a("currentIndexChanged",p(e,"currentIndexChanged"))),onItemValuesChanged:e=>(Xs("onItemValuesChanged",e),$s(r,"onItemValuesChanged",[rc,tc],c,!1),a("itemValuesChanged",p(e,"itemValuesChanged"))),onError:e=>(Xs("onError",e),$s(r,"onError",[rc,ec,tc],c,!1),a("datasetError",p(e,"datasetError"))),onReady:e=>(Xs("onReady",e),$s(r,"onReady",[ec,tc,rc],c,!1),Wr(r())?(Promise.resolve(p(e)()),D.noop):a("datasetReady",p(e,"datasetReady"))),onReadyAsync:f,async setSort(e){Qs(l,"setSort"),$s(r,"setSort",[ec,rc],c,!1),(e=>{if(!e||!(0,D.isFunction)(e._build))throw new b("The given sort object is invalid",{code:"DS_INVALID_ARGUMENT"})})(e),await new Promise((e=>T.onReady(e))),qr(r())||await v();const n=m((()=>e._build()),O.withMessage("Sort building failed"));await t(Fs((0,D.cloneDeep)(n())))},async setFilter(e){Qs(l,"setFilter"),$s(r,"setFilter",[ec,rc],c,!1),(e=>{if(!e||!(0,D.isFunction)(e._build))throw new b("The given filter object is invalid",{code:"DS_INVALID_ARGUMENT"})})(e),await new Promise((e=>T.onReady(e))),qr(r())||await v();const n=m((()=>e._build()),O.withMessage("Filter building failed"));await t(Ls((0,D.cloneDeep)(n())))},loadMore:async()=>{Qs(l,"loadMore"),Js(r,"loadMore"),$s(r,"loadMore",[ec,rc],c,!1),await t(As.incrementNumOfPagesToShow())},async nextPage(){if(Qs(l,"nextPage"),Js(r,"nextPage"),$s(r,"nextPage",[ec,rc],c,!1),qr(r())||await v(),!T.hasNextPage())throw new b("There are no more pages in the dataset",{code:"NO_SUCH_PAGE"});await t(As.nextPage());const{items:e}=await As.fetchCurrentPage(n,r());return e},async previousPage(){if(Qs(l,"previousPage"),Js(r,"previousPage"),$s(r,"previousPage",[ec,rc],c,!1),qr(r())||await v(),!T.hasPreviousPage())throw new b("This is the first page in the dataset",{code:"NO_SUCH_PAGE"});await t(As.previousPage());const{items:e}=await As.fetchCurrentPage(n,r());return e},hasNextPage:()=>($s(r,"hasNextPage",[ec,rc],c),ui({state:r(),recordStore:n})),hasPreviousPage:()=>($s(r,"hasPreviousPage",[ec,rc],c),di({state:r()})),getTotalPageCount:()=>($s(r,"getTotalPageCount",[ec,rc],c),Wr(r())?(qs(Za({recordStore:n}),"getTotalPageCount"),ii({state:r(),recordStore:n})):null),getCurrentPageIndex:()=>($s(r,"getCurrentPageIndex",[ec,rc],c),oi({state:r()})),async loadPage(e){$s(r,"loadPage",[ec,rc],c,!1),Qs(l,"loadPage"),Js(r,"loadPage"),qs(Za({recordStore:n}),"loadPage"),((e,t)=>{if(Ys("pageNumber",e),e>t)throw new b("Page "+e+" does not exist",{code:"NO_SUCH_PAGE"})})(e,T.getTotalPageCount()),qr(r())||await v(),await t(As.loadPage(e));const{items:o}=await As.fetchCurrentPage(n,r());return o},inScope:(e,t)=>{$s(r,"inScope",[ec,tc,rc],c,!1);const n=i.getController({repeaterId:e,itemId:t});return n?n.staticExports:T},getPageSize:()=>($s(r,"getPageSize",[ec,rc],c),ei({state:r()})),async setPageSize(e){$s(r,"setPageSize",[ec,rc],c,!1),Ys("size",e),await new Promise((e=>T.onReady(e))),qr(r())||await v(),await t(Jt({size:e}))}},E=Zs({datasetType:c,siblingDynamicPageUrlGetter:d}),T=Object.assign(I,E),S={};for(const e in T)S[e]=(0,D.flow)((t=>g(t,xe.with({category:"datasetAPI",message:"method: "+e+" - datasetId:"+s}))),(t=>y(t,e)),(t=>{return B(t,(r=e,e=>{throw e instanceof O?h.log(new O("datasetApi '"+r+"' operation failed",{cause:e})):e instanceof P?h.log(e):h.log(new w("datasetApi '"+r+"' operation failed",{cause:e})),o("datasetError",r,e instanceof C?e.cause.message:e.cause||e),e.cause||e}));var r}))(T[e]);return S}},oc=function(e){void 0===e&&(e=D.noop);let t=!1,r={};const n=e=>r[e]?r[e]:r[e]=[],o=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];return Promise.all(n(e).map((e=>e(...r))))};return{register:(e,r)=>{if(t)return D.noop;const o=(e=>B((function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return Promise.resolve(e(t,...n))}),(e=>Promise.reject(e))))(r);return n(e).push(o),()=>{(0,D.remove)(n(e),(e=>e===o))}},executeHooks:o,fireEvent:function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return U.logger.log(new Le(Le.types.DS_API.TRIGGERED,{eventName:t,eventArgs:n})),e(t,...n),o(t,...n)},dispose:()=>{t=!0,r={}}}},ac=["siteButtonRole","imageButtonRole","stylableButtonRole"],ic=[ne,oe,Q,ge,...we],sc=e=>e.filter((e=>{let{role:t,isInput:r}=e;return r&&!ic.includes(t)})),cc=(e,t)=>e.filter((e=>{let{role:t}=e;return(0,D.includes)(ac,t)})).filter((e=>{let{connectionConfig:r}=e;return(0,D.includes)(t,(0,D.get)(r,"events.onClick.action"))})),lc=(e,t,r,n)=>{e.enabled!==t&&(t?e.enable():e.disable(),r.log(new xe({category:"components",message:e.id+" changed to "+(t?"enabled":"disabled")+" (dataset: "+n+")"})))},dc=(e,t,r,n,o)=>{let{getState:a,subscribe:i}=e;const s={new:()=>!qr(a()),save:()=>$r(a()),revert:()=>$r(a()),remove:()=>$r(a()),next:()=>li({state:a(),recordStore:o}),previous:()=>ci({state:a()}),nextPage:()=>ui({state:a(),recordStore:o}),previousPage:()=>di({state:a()}),nextDynamicPage:()=>sn(a()).hasUrl(),previousDynamicPage:()=>cn(a()).hasUrl(),loadMore:()=>(e=>{let{state:t,recordStore:r}=e;if(si({recordStore:r}))return!0;const n=ai({recordStore:r});return!!n&&ti({state:t})+ri({state:t})<n.total})({state:a(),recordStore:o})},{inputComponents:c,linkedComponents:l}=((e,t)=>{const r=(0,D.uniqBy)(e.filter((e=>{let{enabled:t}=e;return t})),(e=>{let{id:t}=e;return t}));return{inputComponents:sc(r),linkedComponents:cc(r,t)}})(t,Object.keys(s)),d=c.length+l.length?i((e=>{let{getState:t,inputComponents:r,linkedComponents:n,datasetId:o,logger:a,shouldEnableLinkedComponent:i}=e;return()=>{const e=t();if(!Wr(e))return;const s=$r(e);r.forEach((e=>{lc(e,s,a,o)})),n.forEach((e=>{const{action:t}=e.connectionConfig.events.onClick,r=i[t]();lc(e,r,a,o)}))}})({getState:a,inputComponents:c,linkedComponents:l,datasetId:n,logger:r,shouldEnableLinkedComponent:s})):D.noop;return d},uc=Object.assign(Object.assign({SHORT_DATE:"SHORT_DATE",MEDIUM_DATE:"MEDIUM_DATE",LONG_DATE:"LONG_DATE",FULL_DATE:"FULL_DATE",SHORT_DATE_TIME:"SHORT_DATE_TIME",LONG_DATE_TIME:"LONG_DATE_TIME",FULL_DATE_TIME:"FULL_DATE_TIME"},{MEDIUM_TIME_12:"MEDIUM_TIME_12",MEDIUM_TIME_24:"MEDIUM_TIME_24",LONG_TIME_12:"LONG_TIME_12",LONG_TIME_24:"LONG_TIME_24",HOUR_ONLY:"HOUR_ONLY",MINUTE_ONLY:"MINUTE_ONLY"}),{YEAR_ONLY:"YEAR_ONLY",MONTH_ONLY:"MONTH_ONLY",SHORT_MONTH_ONLY:"SHORT_MONTH_ONLY",DAY_ONLY:"DAY_ONLY"}),pc=(new Set([uc.SHORT_DATE_TIME,uc.LONG_DATE_TIME,uc.FULL_DATE_TIME,uc.MEDIUM_TIME_12,uc.MEDIUM_TIME_24,uc.LONG_TIME_12,uc.LONG_TIME_24,uc.HOUR_ONLY,uc.MINUTE_ONLY]),{[uc.SHORT_DATE]:{day:"numeric",month:"numeric",year:"2-digit"},[uc.MEDIUM_DATE]:{day:"numeric",month:"short",year:"numeric"},[uc.LONG_DATE]:{day:"numeric",month:"long",year:"numeric"},[uc.FULL_DATE]:{day:"numeric",month:"long",year:"numeric",weekday:"long"},[uc.SHORT_DATE_TIME]:{day:"numeric",month:"numeric",year:"2-digit",hour:"numeric",minute:"numeric"},[uc.LONG_DATE_TIME]:{day:"numeric",month:"long",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric"},[uc.FULL_DATE_TIME]:{day:"numeric",month:"long",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric",weekday:"long",timeZoneName:"short"},[uc.MEDIUM_TIME_12]:{minute:"numeric",hour:"numeric",hour12:!0},[uc.MEDIUM_TIME_24]:{minute:"numeric",hour:"numeric",hour12:!1},[uc.LONG_TIME_12]:{minute:"numeric",hour:"numeric",second:"numeric",hour12:!0},[uc.LONG_TIME_24]:{minute:"numeric",hour:"numeric",second:"numeric",hour12:!1},[uc.HOUR_ONLY]:{hour:"numeric"},[uc.MINUTE_ONLY]:{minute:"numeric"},[uc.YEAR_ONLY]:{year:"numeric"},[uc.MONTH_ONLY]:{month:"long"},[uc.SHORT_MONTH_ONLY]:{month:"short"},[uc.DAY_ONLY]:{weekday:"long"}}),fc=({locale:e,timeZone:t}={})=>{if(!e)throw new Error('A "locale" parameter is required for wixFormatting');return{formatDateTime(r,n,{locale:o,timeZone:a}={}){const i=Object.assign(Object.assign({},pc[n]),{timeZone:a||t});return new Intl.DateTimeFormat(o||e,i).format(r)},dateFormats:uc}},hc=e=>(0,D.isEqual)(!1,e);function mc(e,t){return(0,D.mapValues)(t,((t,r)=>e(r).map((e=>function(e,t){switch(e){case"number":return Number(t);case"boolean":if("string"==typeof t)return"true"===t.toLowerCase()||"1"===t.toLowerCase();break;case"text":if(null!=t&&"function"==typeof t.toString)return t.toString()}return t}(e,t))).getOrElse(t)))}const gc=function(e,t,r,n,o,a,i,s){const{logger:c,errorReporting:l,breadcrumbReporting:d}=U,u=(e,t)=>d(t,xe.with({category:"effects",message:e,data:{datasetId:o}}));function p(e,r){t.onCurrentRecordModified(r,e)}function f(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return l(i,w.withMessage("Dataset "+e+" event execution failed"))(e,...r)}function h(){return Promise.all(t.onRecordsLoaded())}const m=e=>{throw new b(e,{code:"DS_OPERATION_FAILED"})};return{goToRecordByIndex:(t,r,n)=>({run:u("goToRecordByIndex",(async function(){let o;Za({recordStore:e})&&await pi({index:r,recordStore:e});try{o=(e=>{let{recordStore:t,index:r}=e;const{total:n,loaded:o}=t().fold((e=>{throw e}),(e=>e.getDatasetSize()));return Math.max(Math.min(r,Math.max(n,o)-1),0)})({recordStore:e,index:r})}catch(e){m(e)}if(t!==o||n){const t=await(a=o,e().fold(m,(e=>e.getRecords(a,1))));return t.matchWith({Empty:()=>As.GoToIndexResult.NoRecord(),Results:e=>{let{items:t}=e;return As.GoToIndexResult.Record(o,t[0])}})}return As.GoToIndexResult.InvalidIndex();var a})),isQueued:!0,resultActionCreator:As.goToRecordByIndexResult}),setFieldsInCurrentRecord:(t,n,o)=>({run:u("setFieldsInCurrentRecord",(function(){const a=mc(r,t);return e().fold(m,(e=>e.setFieldsValues(n,a,o).fold((e=>{throw e}),(()=>{}))))})),isQueued:!1}),revertChanges:(t,r)=>({run:u("revertChanges",(function(){e().chain((e=>e.resetDraft(t,r))),p()})),isQueued:!1,resultActionCreator:As.revertResult}),saveRecord:(t,r)=>({run:u("saveRecord",(async function(){return await(c.log(new Le(Le.types.DS_API.TRIGGERED,{eventName:"beforeSave"})),n("beforeSave").then((e=>e.some(hc))).catch((e=>({error:e}))).then((e=>{if(e)throw new b("Operation cancelled by user code. "+((0,D.isBoolean)(e)?"":e.error),{code:"DS_OPERATION_CANCELLED"})}))),e().fold((()=>!1),(async e=>{if(e.hasDraft(t)){!function(e){const t=a.filter((t=>!t.isValid(e)));if(t.forEach((e=>e.updateValidityIndication())),t.length)throw new b("Some of the elements validation failed",{code:"DS_VALIDATION_ERROR"})}(r);const n=await e.saveRecord(t);return f("afterSave",r,n),s.dispatch("afterSave",r,n),n}}))})),isQueued:!0,resultActionCreator:As.saveRecordResult}),removeCurrentRecord:t=>({run:u("removeCurrentRecord",(()=>function(t){return e().fold(m,(e=>e.removeRecord(t)))}(t))),isQueued:!0,resultActionCreator:As.removeCurrentRecordResult}),newRecord:(t,r)=>({run:u("newRecord",(()=>function(t,r){return e().fold(m,(e=>e.newRecord(t,r)))}(t,r))),isQueued:!0,resultActionCreator:As.newRecordResult}),fireEvent:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return{run:u("fireEvent",(()=>f(e,...r))),isQueued:!1}},notifyIndexChange:e=>({run:u("notifyIndexChange",(()=>{t.onCurrentIndexChanged(),f("currentIndexChanged",e)})),isQueued:!1}),notifyRecordSetLoaded:()=>({run:u("notifyRecordSetLoaded",h),isQueued:!0}),updateCurrentView:e=>({run:u("updateCurrentView",(()=>Promise.all(t.onCurrentViewChanged()))),isQueued:!0,resultActionCreator:As.updateCurrentViewResult}),refresh:(t,r,n)=>({run:u("refresh",(async function(){return e().fold(m,(async e=>(e.reset(),n?As.GoToIndexResult.Record(0,e.newRecord(0,r)):e.getRecords(0,1).then((e=>e.matchWith({Empty:()=>As.GoToIndexResult.NoRecord(),Results:e=>{let{items:t}=e;return As.GoToIndexResult.Record(0,t[0])}}))))))})),isQueued:!0,resultActionCreator:As.refreshResult}),updateComponents:(e,t)=>({run:u("updateComponents",(()=>{p(e,t)})),isQueued:!1})}},yc=e=>ei({state:e}),vc=e=>sn(e).shouldLoadUrl(),_c=e=>cn(e).shouldLoadUrl(),Ic=e=>{let{getNextDynamicPageUrl:t,getPreviousDynamicPageUrl:r}=e;const n={run:t,isQueued:!0,resultActionCreator:(e,t)=>({type:br,error:e,payload:t})},o={run:r,isQueued:!0,resultActionCreator:(e,t)=>({type:Cr,error:e,payload:t})},a=e=>{let{hasChangedToTrue:t}=e;const r=[];return t(vc)&&r.push(n),t(_c)&&r.push(o),r};return e=>(0,D.flatten)([a].map((t=>t(e))))},Ec=/[^{}]+(?=\})/g,Tc=/[^\dA-Za-z]/g,Sc=async e=>{let{dataProvider:t,dynamicPagesData:{dynamicPageData:r,datasetConfig:{dataset:{sort:n,collectionName:o}},items:a}}=e;const i=await t.getSort({sort:n,collectionId:o})||[],{dynamicUrl:s,userDefinedFilter:c}=r,d=(0,Rn.PL)(a)[0],{fieldName:u,fieldDefinition:p}=Pc({dynamicUrl:s,schema:t.getSchema(o)}),f=s&&d?p&&(!(m=p).queryOperators||[l.AllowedFilterOperator.gt,l.AllowedFilterOperator.lt].every((e=>m.queryOperators.includes(e))))?[u]:(h=s,h=(e=>e.replace(/(\/{2,})/g,"/").replace(/^\//,""))(h),{fields:h.match(Ec)||[],nonFields:h.replace(Ec,"").split(Tc).filter((e=>!!e))}).fields:[];var h,m;const g=Rc(i),y=(0,D.difference)(f,g),v=wc([...i,...Oc(y)]),_=[...g,...y];return{dynamicUrl:s,userDefinedFilter:c,dynamicUrlPatternFieldsValues:bc(d,_,f),sort:v,sortFields:_,patternFields:f}},Rc=e=>(0,D.flatten)(e.map((e=>Object.keys(e).map((e=>e))))),wc=e=>e.reduce(((e,t)=>Object.assign(e,t)),{}),Oc=e=>e.map((e=>({[e]:"asc"}))),bc=(e,t,r)=>{const n=r.concat(t);return r.length?(0,D.pick)(e,n):null},Cc=async e=>{let{dataProvider:t,collectionName:r,directionTowardSibling:n,dynamicPagesData:o}=e;const{dynamicUrl:a,userDefinedFilter:i,dynamicUrlPatternFieldsValues:s,sort:c,sortFields:l,patternFields:d}=o?await Sc({dynamicPagesData:o,dataProvider:t}):{};if(null==a||!d.length)return null;const u=await t.getSibling({collectionName:r,sort:c,sortFields:l,directionTowardSibling:n,fieldValues:s,filter:i}),{fieldName:p}=Pc({dynamicUrl:a,schema:t.getSchema(r)});return u&&p?u[p]:void 0},Pc=e=>{let{schema:t,dynamicUrl:r}=e;const[n,o]=Object.entries(t.fields).find((e=>{let[t,n]=e;return n.type===l.FieldType.pageLink&&n.calculator.config.pattern===r}))||[];return{fieldName:n,fieldDefinition:o}},Nc=(e,t)=>{try{return Dc(e(t))}catch(e){return Ac(e)}},Dc=e=>({value:e,then:t=>Nc(t,e),catch:()=>Dc(e)}),Ac=e=>({error:e,then:()=>Ac(e),catch:t=>Nc(t,e)}),xc={resolve:Dc,reject:Ac},Lc=e=>{let{recordStore:t}=e;const{logger:r}=U;return t().fold((()=>Promise.resolve(je.Maybe.Nothing())),(e=>e.hasSeedData()?(e=>e.getSeedRecords().matchWith({Empty:()=>xc.resolve(je.Maybe.Nothing()),Results:e=>{let{items:t}=e;return xc.resolve(je.Maybe.Just(t[0]))}}))(e):r.log(new Ae("dataset/pageReady/getData",(()=>(e=>e.seed().then((()=>e.getRecords(0,1).then((e=>e.chain((e=>{let{items:t}=e;return je.Maybe.Just(t[0])})))))).catch((e=>(r.logError(e,"Fetch initial data failed"),je.Maybe.Nothing()))))(e))))))},Fc=e=>{let{shouldFetchInitialData:t,recordStore:r,store:n,filter:o,sort:a,datasetIsDeferred:i,modeIsSSR:s,queueMicrotask:c,datasetIsReal:l,collectionId:d,filterResolver:u,dependencyManager:p,getSchemas:f,schemasLoading:h,getUserFilterInitialData:m}=e;const g=()=>{const e=(i=n.getState(),Or.getUserFilterConnectionProps(i.config));var i;const s=t?Lc({recordStore:r}):Promise.resolve();if(!(l&&(null==e?void 0:e.length)>0))return s.then((e=>Promise.resolve([e])));const c=u(o).map((async t=>{const r=m();if(r)return n.dispatch(Ds(r)),r;await h;const o=f(),i=o[d];if(i){const r=await U.dataFetcher.fetchUserFilterInitialData({filter:t,sort:await Fo({datasetConfigSort:a,getSchema:()=>i}),userFilterConnectionProps:e,schema:i,schemas:o});return n.dispatch(Ds(r)),r}})).getOrElse(null);return Promise.all([s,c])},y=p.getDependencyResolutionPromise(o),v=i&&((e,t)=>{const{promise:r,resolve:n}=new j;return e||t(n),r})(s,c),{waitingForUserInput:_,resolveUserInputDependency:I}=wi(o)&&(()=>{const{promise:e,resolve:t}=new j;return{waitingForUserInput:e,resolveUserInputDependency:t}})(),E=[y,v,_].filter((e=>Boolean(e)));return{fetchingInitialData:E.length?Promise.all(E).then(g):g(),resolveUserInputDependency:()=>I&&I()}},Mc=e=>{let{value:t,fieldName:r,record:n,getFieldType:o}=e;const a=(e=>{let{value:t,currentValue:r,fieldType:n}=e;return n===l.FieldType.date&&na(t)?ca(t):ra(r)&&na(t)?oa({time:r,date:t}):na(r)&&ra(t)?oa({time:t,date:r}):t})({value:t,currentValue:(0,D.get)(n,r),fieldType:o(r).getOrElse(null)});(0,D.set)(n,r,a)},Uc=(e,t)=>{const r=["value","checked"];return e.reduce(((e,n)=>{var o;const a=(null==(o=n.connectionConfig)?void 0:o.properties)||{};return r.forEach((r=>{(0,D.has)(a,r)&&Mc({value:n.getValue({propPath:r}),fieldName:a[r].fieldName,record:e,getFieldType:t})})),e}),{})},kc=(e,t,r)=>{var n;return t===r||(null==(n=e[t])?void 0:n.some((t=>kc(e,t,r))))},Gc=e=>{let{components:t,connectionsGraph:r,updatedCompIds:n,datasetIsReal:o}=e;const a=t.filter((e=>(e=>{let{component:t,updatedCompIds:r,datasetIsReal:n,connectionsGraph:o}=e;if(r.length&&n){const{id:e}=t;return r.some((t=>kc(o,e,t)||kc(o,t,e)))}return!0})({component:e,connectionsGraph:r,updatedCompIds:n,datasetIsReal:o})));return a.some((e=>{let{role:t}=e;return t===Q}))?t:a},jc=(e,t)=>{let{repeaterId:r,itemId:n}=t;return[e,"componentId",r,"itemId",n].join("_")},Bc=e=>e.split("_componentId_")[0],Vc=(e,t)=>{const{logger:r}=U;return(n,o,a)=>{const i=((e,t)=>(0,D.isNull)(e)&&(0,D.isNull)(t))(n,o);if(i)return void r.log(new w("onChangeHandler invoked with illegal arguments",{extra:{arguments:{before:n,after:o,componentIdToExclude:a}}}));if((e=>(0,D.isNull)(e))(n))return void t(As.refreshCurrentView()).catch((()=>{}));const s=Zr(e());if(((e,t)=>(0,D.isNull)(t))(0,o))return Li(n,s)&&t(As.refreshCurrentRecord()).catch((()=>{})),void t(As.refreshCurrentView()).catch((()=>{}));if(((e,t)=>Li(e,t))(n,s)){const r=ni({state:e()});t(As.setCurrentRecord(o,r,a)).catch((()=>{}))}}},Wc=e=>{let{detailsDatasetApis:t,masterDatasetApi:r,controllerConfig:n,unsubscribeHandlers:o}=e;const{logger:a}=U;t.forEach((e=>{const t=()=>{o.push(qc({masterDatasetApi:r,masterDatasetConfig:n,detailsDatasetApi:e}))};try{o.push(r.onReady(t))}catch(e){a.log(new Fe(new b("The dataset cannot filter by the dynamic dataset because the field used to build this page's URL is empty",{code:"DS_EMPTY_URL_FIELD",cause:e}),"error"))}}))},qc=e=>{let{masterDatasetConfig:t,masterDatasetApi:r,detailsDatasetApi:n}=e;const o=tr(t.dataset);let a,i;return o!==ke&&(a=r.onCurrentIndexChanged((()=>n.onReady((()=>n.refresh()))))),o!==Ue&&(i=r.onItemValuesChanged((()=>n.refresh()))),()=>[a,i].forEach((e=>null==e?void 0:e()))},{richText:Hc}=l.FieldType,$c={$text:e=>e===Hc?"html":"text"},zc=e=>{let{propName:t,getFieldType:r}=e;return t in $c?$c[t](r()):t},Yc=e=>e.startsWith("$"),Xc=e=>({id:e.id,role:e.role,isValidConnection:()=>!0,bind:()=>{},clear:()=>e.clear(),hide:()=>e.hide(),show:t=>e.show(t),resetUserFilter:()=>{},onRecordsLoaded:async()=>{},onCurrentViewChanged:async()=>{},onCurrentIndexChanged:async()=>{},onCurrentRecordModified:async()=>{}}),Jc=e=>!!e&&Object.values(e).some((e=>!(0,D.isEmpty)(e))),Kc=(e,t,r)=>{const{logger:n,platform:{location:o,utils:a,executeTpaAction:i}}=U,{getState:s,getFieldType:c,wixFormatter:l,modeIsLivePreview:d}=r,u=o=>{gi({currentRecord:Zr(s()),previousRecord:o,component:e,connectionConfig:t,formatter:l,modeIsLivePreview:d,getFieldType:c,logger:n,recordStore:r.recordStore,actions:r.actions})},p=e=>e.matchWith({Empty(){},Loading(){},Loaded(e){let{url:t}=e;o.navigateTo(t)}}),f=t=>{const{datasetApi:s,getState:c,actions:l}=r;(0,D.forEach)(t,((t,r)=>{let{action:d,postAction:u}=t;e.on(r,(async()=>{try{if(d.startsWith("tpa/")){const e=s.getCurrentItem();return void await i({currentItem:e,action:d})}if("nextDynamicPage"===d)return p(sn(c()));if("previousDynamicPage"===d)return p(cn(c()));if("applyUserInputFilters"===d)return l.refresh();if("resetUserFilter"===d)return l.resetUserInputFilters();const e=await Promise.resolve(s[d]());if(u&&u.navigate){const t=((e,t)=>e.fieldName?Qo(t,e.fieldName):e.linkObject?a.links.toUrl(e.linkObject):void 0)(u.navigate,e);o.navigateTo(t)}}catch(e){e instanceof R||n.log(new w(d+" operation failed:",{cause:e}))}}))}))};return{...Xc(e),isValidConnection:()=>Jc(t),bind(){const{events:n,behaviors:o}=t;n&&f(n),o&&(t=>{const{dispatcher:n,eventListeners:{register:o}}=r;t.forEach((t=>{let r=!1;switch(t.type){case"saveSuccessFeedback":o("beforeSave",(()=>e.hide())),o("afterSave",(()=>{e.show(),r=!0})),o("currentIndexChanged",(()=>{r?r=!1:e.hide()})),o("itemValuesChanged",(()=>e.hide()));break;case"saveFailureFeedback":o("beforeSave",(()=>e.hide())),o("currentIndexChanged",(()=>e.hide())),n.subscribe("datasetSaveError",(()=>e.show()))}}))})(o)},clear(){const{getFieldType:n}=r,{properties:o}=t;(0,D.forEach)(o,((t,r)=>{const o=n(t.fieldName).getOrElse(void 0),a=(e=>e===ea?[]:void 0)(o);e.setValue(a,{propPath:r,fieldType:o,binding:t})}))},async onRecordsLoaded(){const{behaviors:t}=e.connectionConfig;u(),t&&t.forEach((t=>{"saveSuccessFeedback"===t.type&&e.hide()}))},async onCurrentViewChanged(){u()},async onCurrentIndexChanged(){u()},async onCurrentRecordModified(e){u(e)}}};const Qc=(e,t)=>{return r=e,n=t,Object.defineProperties({},{...Object.getOwnPropertyDescriptors(r),...Object.getOwnPropertyDescriptors(n)});var r,n},Zc=e=>{const t={getValue:()=>e.data,setValue(t){e.data=t},clear(){e.data=[]},onItemReady(t){e.onItemReady(t)},onItemRemoved(t){e.onItemRemoved(t)}};return Qc(nl(e),t)},el=e=>"onChange"in e&&("value"in e||"checked"in e),tl=(e,t)=>{const r=t.split("."),n=r.slice(0,-1),[o]=r.slice(-1);return{obj:n.length>0?(0,D.get)(e,n):e,prop:o}},rl=e=>{if(!e||!e.parent)return;const{parent:t}=e;return t.type===He.Repeater?Zc(t):rl(t)},nl=e=>{const{connectionConfig:t,uniqueId:r,type:n,role:o,id:a}=e,i=!!e.hidden,s={id:r,connectionConfig:t,nickname:a,type:n,role:o,isInput:el(e),parentRepeater:rl(e),getValue(t){let{propPath:r}=void 0===t?{}:t;if(r){const{obj:t,prop:n}=tl(e,r);return t[n]}},setValue(t,r){let{propPath:n,fieldType:o,binding:a}=void 0===r?{}:r;if(n){const{obj:r,prop:i}=tl(e,n);r[i]="reference"===o&&(e=>(0,D.isObject)(e)&&(0,D.has)(e,"_id"))(t)?t._id:t;const s=null==a?void 0:a.linkTarget;(e=>e===l.FieldType.url||e===l.FieldType.pageLink)(o)&&s&&(r.target=s)}},setOptions(t){"options"in e&&(e.options=t)},hide(){e.hidden||null==e.hide||e.hide()},show(t){let{ignoreInitiallyHidden:r}=void 0===t?{ignoreInitiallyHidden:!1}:t;!e.hidden||r&&i||null==e.show||e.show()},clear(e){s.setValue(void 0,e)},get enabled(){return!("enabled"in e)||e.enabled},enable(){"enable"in e&&!s.enabled&&e.enable()},disable(){"disable"in e&&s.enabled&&e.disable()},isValid:()=>!("validity"in e)||"object"!=typeof e.validity||e.validity.valid,updateValidityIndication(){"updateValidityIndication"in e&&e.updateValidityIndication()},resetValidityIndication(){"resetValidityIndication"in e&&e.resetValidityIndication()},onChange(e){s.on("onChange",e)},on(t,r){var n;null==(n=e[t])||n.call(e,r)}};return"placeholder"in e&&Object.defineProperty(s,"placeholder",{get:()=>e.placeholder}),s},ol=e=>{switch(e.role){case Z:return(e=>{const t={setValue(t,r){let{fieldType:n,propPath:o="text",binding:a}=void 0===r?{}:r;if(n===l.FieldType.url){const r=(null==a?void 0:a.linkTarget)||"_blank";e.text="<a href="+t+' target="'+r+'" style="text-decoration: underline">'+t+"</a>";const{html:n}=e;return e.text="",void(e.html=(0,D.unescape)(n))}n!==l.FieldType.richText?e[o]=t:e.html=t},clear(t){let{fieldType:r}=void 0===t?{}:t;const n=r===l.FieldType.richText||r===l.FieldType.url?"html":"text";e[n]=""}};return Qc(nl(e),t)})(e);case le:case J:return Zc(e);case ae:return(e=>{const t={get nextEnabled(){return e.nextEnabled},set nextEnabled(t){e.nextEnabled=t},get previousEnabled(){return e.previousEnabled},set previousEnabled(t){e.previousEnabled=t},setValue(t){e.rows=t},getValue:()=>e.rows,set rows(e){t.setValue(e)},get rows(){return e.rows},get columns(){return e.columns},clear(){e.rows=[],e.dataFetcher=void 0},set dataFetcher(t){e.dataFetcher=t},refresh:()=>e.refresh(),onCellSelect:t=>e.onCellSelect(t),onRowSelect:t=>e.onRowSelect(t)};return Qc(nl(e),t)})(e);case ce:return(e=>{const t={isValid(t){const{connectionConfig:r,validity:n}=e;if(n.valid)return!0;if((0,D.some)((0,D.values)((0,D.omit)(n,["valid","valueMissing"])),(e=>e)))return!1;const o=(0,D.get)(r,"properties.value.fieldName")||"";return!(0,D.isEmpty)(Qo(t,o))},set fileType(t){e.fileType=t},get fileType(){return e.fileType},getValue:()=>e.value,clear(){e.reset()},uploadFiles:async()=>e.uploadFiles()};return Qc(nl(e),t)})(e);case ye:return(e=>{const t=nl(e),r={setValue(r,n){r?t.setValue(r,n):e.clear()}};return Qc(t,r)})(e);case ee:return(e=>{e.clickAction&&(e.clickAction=e.clickAction);const t={setValue(t){e.items=t},getValue:()=>e.items,clear(){e.items=[]},set currentIndex(t){try{e.galleryCapabilities.hasCurrentItem&&(e.currentIndex=t)}catch(e){}},get currentIndex(){return e.currentIndex},get clickAction(){return e.clickAction},onCurrentItemChanged(t){e.galleryCapabilities.hasCurrentItem&&e.onCurrentItemChanged((e=>{let{item:r,itemIndex:n}=e;return t(r,n)}))}};return Qc(nl(e),t)})(e);case ue:return(e=>{const t={get currentPage(){return e.currentPage},set currentPage(t){e.currentPage=t},get totalPages(){return e.totalPages},set totalPages(t){e.totalPages=t},get nextEnabled(){return e.nextEnabled},set nextEnabled(t){e.nextEnabled=t},get previousEnabled(){return e.previousEnabled},set previousEnabled(t){e.previousEnabled=t},get navigationType(){return e.navigationType},set navigationType(t){e.navigationType=t},onNextClicked(t){e.onNextClicked(t)},onPreviousClicked(t){e.onPreviousClicked(t)}};return Qc(nl(e),t)})(e);case fe:return(e=>{const t={setValue(t){e.location=t},getValue:()=>e.location,clear(){e.markers=[]},set location(t){e.location=t},get location(){return e.location},set markers(t){e.markers=t},get markers(){return e.markers},setCenter(t){e.setCenter(t)}};return Qc(nl(e),t)})(e);case Re:return(e=>{const t={setValue(t){e.value=t},getValue:()=>e.value,clear(){e.value=[]},setBounds(t,r){e.min=t,e.max=r},getBounds:()=>[e.min,e.max]};return Qc(nl(e),t)})(e);default:return nl(e)}},al=e=>t=>{const r=[],n=[];(0,D.uniq)(t.map((e=>{let{role:t}=e;return t}))).forEach((t=>{if(t===K){return void(e("@"+t)||[]).forEach((e=>e&&n.push(e)))}if(t===de){const t=e("@"+de)||[],[n]=Array.isArray(t)?t:[t],o=e("Document");if(o&&n){const e=new Proxy(o,{get:(e,t)=>"connectionConfig"===t?n.connectionConfig:"role"===t?de:e[t]});r.push(e)}return}(e("@"+t)||[]).forEach((e=>{e&&r.push(e)}))}));return{components:r.map((e=>ol(e))),detailsDatasetApis:n}},il=(e,t,r)=>{const{logger:n,errorReporting:o}=U,{getState:a,getFieldType:i,actions:s,modeIsLivePreview:c}=r,l=o=>{gi({currentRecord:Zr(a()),previousRecord:o,component:e,connectionConfig:t,modeIsLivePreview:c,getFieldType:i,logger:n,recordStore:r.recordStore,actions:r.actions})},d=()=>{const t=s.isCurrentRecordPristine(a()),r=s.isCurrentRecordNew(a());t&&r&&e.resetValidityIndication()};return{...Xc(e),isValidConnection:()=>Jc(t),bind(){(()=>{const{id:r,role:n}=e,{properties:c}=t;e.onChange(o((e=>{const t=c.checked?"checked":"value",o=c[t].fieldName,l=Zr(a()),d=Ma({value:e.target[t],currentValue:Qo(l,o),fieldType:i(o).getOrElse(void 0),fieldName:o,utils:{referenceFetcher:(e,t)=>s.fetchRecordById(e,t).getOrElse(e)},role:n});s.setFieldInCurrentRecordAndSynchronize(o,d,r)}),w.withMessage("Input adapter onChange - setting value to record failed")))})(),t.filters&&e.onChange(o(s.refresh,w.withMessage("Input adapter onChange - sync actions failed")))},async onRecordsLoaded(){l(),d()},async onCurrentViewChanged(){l(),d()},async onCurrentIndexChanged(){l(),d()},async onCurrentRecordModified(e){l(e),d()}}},sl={start:0,end:0},cl=(e,t)=>{let{valueSource:r,labelField:n,dataTransformer:o}=t;const a=o(e,r);return{value:a,label:n?o(e,{type:"field",fieldName:n}):a}},ll=e=>(0,D.get)(e,"properties.value.fieldName")||"",dl=(e,t,r)=>{const{errorReporting:n}=U,{actions:o,recordStore:a,getState:i}=r,s=t.userInputFilter.fieldName;e.onChange(n((async()=>{const t=dn(i()),n=(c=i(),fr.selectIsApplyUserInputFiltersActionBindingPresent(c.records));var c;if(t||n)return;await o.refresh();const l=a().fold((()=>{}),(e=>e.getDatasetSize().total)),d=Ur(i());(e=>{let{state:t,numberOfResults:r,filteredBy:n,componentType:o,fieldType:a,schema:i}=e;const{logger:s,platform:{settings:{env:{editor:c}}}}=U,l=Br(t),d=Ur(t);if(!d)return;const u=i.getOrElse({displayName:d}).displayName;s.log(new Sn({id:c?366:371,collectionId:d,collectionName:u,datasetMode:l,numberOfResults:r,filteredBy:n,componentType:o,fieldType:a}))})({filteredBy:s,numberOfResults:l,state:r.getState(),componentType:e.type,fieldType:r.getFieldType(s).getOrElse(void 0),schema:r.getSchema(d)})}),w.withMessage("Filter input adapter onChange failed")))},ul=(e,t,r)=>{const{i18n:n}=U,{getState:o}=r,a=t=>{const r=Array.isArray(e.getValue({propPath:t}))?[]:Oe;e.setValue(r,{propPath:t})};return{...Xc(e),isValidConnection:()=>gr(t),bind(){dl(e,t,r);const{userInputFilter:{prop:i,fieldName:s}}=t,c=(e=>{var t;return null==(t=gn(o()))?void 0:t.find((t=>t.fieldName===e&&be.includes(t.role)))})(s);c&&(e.setOptions((e=>{let{component:t,prop:r,userFilterInitialData:o}=e;return[!Array.isArray(t.getValue({propPath:r}))&&{value:Oe,label:n.t("USER_INPUT_FILTER_OPTION_RESET_ALL")},...o.options.map((e=>({value:String(e),label:String(e)})))].filter(Boolean)})({component:e,prop:i,userFilterInitialData:c})),(e=>"placeholder"in e)(e)||a(i))},resetUserFilter(){const{userInputFilter:{prop:r}}=t;e.getValue({propPath:r})&&a(r)}}},pl=new Map([[le,(e,t,r)=>{const{errorReporting:n}=U,{controllerFactory:o,controllerStore:a}=r,i=[],s=(t,r)=>{const n={repeaterId:e.id,itemId:r._id},s=o.createScopedDataset({datasetScope:n,fixedItem:r});a.setController(n,s);const c=al(t.scoped),l=s.pageReady(c);i.push(l)},c=t=>{const r={repeaterId:e.id,itemId:t._id};a.removeController(r)},l=async()=>{const{actions:t,getState:n,modeIsLivePreview:o}=r,{items:a}=await t.fetchCurrentItems(n());o&&0===a.length||(e.setValue(a),await Promise.all(i),i.splice(0))};return{...Xc(e),bind(){e.onItemReady(n(s,w.withMessage("Repeater adapter onItemReady failed"))),e.onItemRemoved(n(c,w.withMessage("Repeater adapter onItemRemoved failed")))},onRecordsLoaded:async()=>l(),async onCurrentViewChanged(){l()},async onCurrentIndexChanged(){},async onCurrentRecordModified(){const{getState:t}=r,n=Zr(t()),o=e.getValue();if(o&&o.length>0){const t=o.map((e=>e._id===n._id?n:e));e.setValue(t)}}}}],[J,(e,t,r)=>{const{errorReporting:n}=U,{controllerFactory:o,controllerStore:a}=r,i=(t,r)=>{const n={repeaterId:e.id,itemId:r._id},i=o.createScopedDetailsDataset({datasetScope:n});a.setController(n,i);const s=al(t.scoped);i.pageReady(s)},s=t=>{const r={repeaterId:e.id,itemId:t._id};a.removeController(r)};return{...Xc(e),bind(){e.onItemReady(n(i,w.withMessage("Details repeater adapter onItemReady failed"))),e.onItemRemoved(n(s,w.withMessage("Details repeater adapter onItemRemoved failed")))}}}],[Q,(e,t,r)=>{const{errorReporting:n}=U,{actions:o}=r;return{...Xc(e),isValidConnection:()=>Jc(t),bind(){e.onChange(n(o.refresh,w.withMessage("Filter input adapter onChange failed")))},resetUserFilter(){const t=mi(e);e.setValue((e=>{switch(e.type){case fi:return!1;case hi:return"";default:return null}})(e),{propPath:t})}}}],[_e,ul],[Te,ul],[Ee,ul],[Se,ul],[Ie,(e,t,r)=>{const n=()=>{const{userInputFilter:{prop:r}}=t;e.setValue(null,{propPath:r})};return{...Xc(e),isValidConnection:()=>gr(t),bind(){dl(e,t,r),n()},resetUserFilter(){n()}}}],[Re,(e,t,r)=>{const{getState:n}=r,o=t=>{var r;const o=null==(r=gn(n()))?void 0:r.find((r=>r.fieldName===t&&r.role===e.role));if(!o)return null;const{min:a,max:i}=o;return void 0===a||void 0===i?null:{min:a,max:i}},a=r=>{let{firstRender:n,min:o,max:a}=r;const{userInputFilter:{prop:i}}=t;n&&e.setBounds(o,a),e.setValue([o,a],{propPath:i})};return{...Xc(e),isValidConnection:()=>gr(t),bind(){const n=o(t.userInputFilter.fieldName);n&&(dl(e,t,r),a({firstRender:!0,...n}))},resetUserFilter(){const e=o(t.userInputFilter.fieldName);e&&a({firstRender:!1,...e})}}}],[ae,(e,t,r)=>{const{errorReporting:n}=U,{datasetApi:o,getState:a,modeIsLivePreview:i,actions:s}=r;let c=sl;const l=e=>c=e,d=()=>l(sl),u=e=>{let{fetchRows:t,logGridValue:r,disableNavigation:n=!1}=e;return async(e,o)=>{const{items:a,datasetSize:i}=await t(e,o-e);return r(a),{pageRows:a,totalRowsCount:n?a.length:i.total}}},p=t=>{let{fetchRows:r,logGridValue:n}=t;return async t=>{let{direction:o,limit:a}=t,{start:i,end:s}=c;"previous"===o?(s=i,i-=a):(i=s,s+=a);const{items:d,datasetSize:u}=await r(i,s-i);return l({start:i,end:s}),e.nextEnabled=!!u.cursor||s<u.loaded,e.previousEnabled=i>0,n(d),{pageRows:d,totalRowsCount:u.total||void 0}}},f=t=>{const r=[],n=e.columns;(0,D.forEach)(t,(e=>{const t={};(0,D.forEach)(n,(r=>{t[r.label]=(0,D.get)(e,r.dataPath)})),r.push(t)}))};return{...Xc(e),bind(){s.getInitialData().chain((t=>{let{items:r}=t;e.rows=r}));const t=Zr(a());if(i&&!t)return;const r=s.isCursorPaging();e.dataFetcher=r?{type:"directional",value:p({fetchRows:s.fetch,logGridValue:f,component:e})}:{type:"pages",value:u({fetchRows:s.fetch,logGridValue:f})},e.onCellSelect(n((e=>{let{cellRowIndex:t}=e;o.setCurrentItemIndex(t)}),w.withMessage("Grid adapter onCellSelect failed"))),e.onRowSelect(n((e=>{let{rowIndex:t}=e;o.setCurrentItemIndex(t)}),w.withMessage("Grid adapter onRowSelect failed"))),(()=>{const t={};e.columns.forEach((e=>{let{label:r,dataPath:n,linkPath:o}=e;(n||o)&&(t[r]=Object.assign(n?{dataPath:n}:{},o?{linkPath:o}:{}))}))})()},async onCurrentRecordModified(){e.refresh()},async onRecordsLoaded(){d(),e.refresh()},async onCurrentViewChanged(){d(),e.refresh()}}}],[ne,(e,t,r)=>{const{logger:n}=U,{actions:o,getFieldType:a,getSchema:i}=r,s=async()=>{var r;const{role:s}=e,c=(e=>{const t=e[0];return 1===e.length&&""===t.label&&""===t.value?[]:e})(await(async(e,t)=>{if("field"===t.type&&a(t.fieldName).map((e=>"reference"===e)).getOrElse(!1)){const{fieldName:r}=t;return i().chain((t=>{const n=Fn(r,t);return i(n).map(Mn).map((async t=>{const{items:n}=await o.fetchAll(r),a=n.map((r=>cl(r,{valueSource:{type:"field",fieldName:"_id"},labelField:t,dataTransformer:e})));return(0,D.orderBy)(a,[e=>e.label.toLowerCase()])}))})).getOrElse(Promise.resolve([]))}{const{items:r}=await o.fetchAll(),n=r.map((r=>cl(r,{valueSource:t,dataTransformer:e})));return(0,D.uniqBy)(n,"value")}})(((e,t)=>"expression"===t.type?Qa({expression:t.expression,record:e,prop:"value",role:s,logger:n}).value:Ua({value:Qo(e,t.fieldName),role:s})),null!=(r=t.expressions)&&r.value?{type:"expression",expression:t.expressions.value.expression}:{type:"field",fieldName:t.properties.value.fieldName}));e.setOptions(c)};return{...Xc(e),isValidConnection:()=>Jc(t),clear(){e.setOptions([])},async onRecordsLoaded(){s()},async onCurrentRecordModified(){s()}}}],[oe,(e,t,r)=>{const{logger:n}=U,{actions:o}=r,a=async()=>{var r;const{role:a}=e,i=(e=>{const t=e[0];return 1===e.length&&""===t.label&&""===t.value?[]:e})(await(async(e,t)=>{const{items:r}=await o.fetchAll(),n=r.map((r=>((e,t)=>{let{valueSource:r,labelField:n,dataTransformer:o}=t;const a=o(e,r);return{value:a,label:n?o(e,{type:"field",fieldName:n}):a}})(r,{valueSource:t,dataTransformer:e})));return(0,D.uniqBy)(n,"value")})(((e,t)=>"expression"===t.type?Qa({expression:t.expression,record:e,prop:"options",role:a,logger:n}).value:Ua({value:Qo(e,t.fieldName),role:a})),null!=(r=t.expressions)&&r.value?{type:"expression",expression:t.expressions.options.expression}:{type:"field",fieldName:t.properties.options.fieldName}));e.setOptions(i)};return{...Xc(e),isValidConnection:()=>Jc(t),clear(){e.setOptions([])},async onRecordsLoaded(){a()},async onCurrentRecordModified(){a()}}}],[ge,(e,t,r)=>{const{logger:n}=U,{actions:o,modeIsLivePreview:a}=r,i=async()=>{const{role:r}=e,{items:i}=await o.fetchAll(),s=i.reduce(((e,o)=>{var a;if(null!=(a=t.expressions)&&a.options){const{value:a}=Qa({expression:t.expressions.options.expression,record:o,prop:"options",role:r,logger:n});return e.push({value:a,label:a}),e}const{properties:{options:{fieldName:i}}}=t,s=Ua({value:Qo(o,i),role:r});return s&&e.push({value:s,label:s}),e}),[]);a&&0===s.length||e.setOptions(s)};return{...Xc(e),isValidConnection:()=>Jc(t),clear(){e.setOptions([])},async onRecordsLoaded(){i()},async onCurrentRecordModified(){i()}}}],[ce,(e,t,r)=>{const{logger:n,errorReporting:o}=U,{actions:a,datasetApi:i,getState:s,getFieldType:c}=r,l={},d=function(r){void 0===r&&(r=!1);const n=Zr(s()),o=ll(t),i=a.isCurrentRecordNew(s()),c=(0,D.isEmpty)(Qo(n,o));(a.isCurrentRecordPristine(s())||r)&&e.clear(),!c||i&&!r||e.updateValidityIndication()};return{...Xc(e),isValidConnection:()=>Jc(t),bind(){if(qr(s()))return;const{id:r,role:d}=e,u=ll(t),p=c(u).getOrElse(void 0);e.onChange(o((()=>{l[r]=!0}),w.withMessage("Upload button adapter onChange failed"))),i.onBeforeSave((()=>{if(l[r]&&e.getValue().length)return e.uploadFiles().then((e=>{l[r]=!1;const t=Zr(s()),n=Ma({value:e,currentValue:Qo(t,u),fieldType:p,fieldName:u,role:d});a.setFieldInCurrentRecordAndSynchronize(u,n,r)})).catch((t=>{const r=e.getValue(),o=Array.isArray(r)&&1===r.length?r[0].name:"unknown";throw n.log(new O("The "+o+" file failed to upload. Please try again later.",{cause:t})),t}))})),c(u).map((t=>{switch(t){case"image":e.fileType="Image";break;case"document":e.fileType="Document"}}))},async onCurrentRecordModified(r){const{id:n}=e,o=ll(t),a=Zr(s()),i=Zo({previousRecord:r,currentRecord:a,fieldName:o});i&&(l[n]=!1),d(i)},async onRecordsLoaded(){d()},async onCurrentViewChanged(){d()},async onCurrentIndexChanged(){d()}}}],[ee,(e,t,r)=>{const{logger:n,errorReporting:o}=U,{actions:a,getState:i,getFieldType:s,modeIsLivePreview:c,wixFormatter:l}=r,d=(e,t,r,o)=>{(0,D.forEach)(r.expressions,((r,a)=>{let{expression:i}=r;const{value:s}=Qa({expression:i,record:t,prop:a,role:o,logger:n});e[a]=s})),(0,D.forEach)(r.properties,((r,n)=>{let{fieldName:a,format:i}=r;const c=Ua({value:Qo(t,a),role:o,fieldType:s(a).getOrElse(void 0),propPath:n,format:i,utils:{formatter:l}});e[n]=c}))},u=()=>{e.currentIndex=ni({state:i()})},p=async()=>{const{role:r}=e,{items:n}=await a.fetchCurrentItems(i());try{const o=n.map((e=>{const n={};return d(n,e,t,r),n})),a=o.every((e=>{let{src:t}=e;return!t}));if(c&&a)return;e.setValue(o)}catch(e){if("URIError"!==e.name)throw e}u()};return{...Xc(e),isValidConnection:()=>Jc(t),bind(){e.onCurrentItemChanged(o((()=>{a.setCurrentIndex(e.currentIndex)}),w.withMessage("Gallery adapter onItemReady failed")))},async onCurrentRecordModified(){const{role:r}=e,n=Zr(i()),o=ni({state:i()}),a=e.getValue()||[],s=a[o];s&&d(s,n,t,r),e.setValue(a),u()},async onRecordsLoaded(){p()},async onCurrentViewChanged(){p()},async onCurrentIndexChanged(){u()}}}],[ue,(e,t,r)=>{const{errorReporting:n}=U,{actions:o,getState:a}=r,i=()=>{o.isCursorPaging()?(()=>{const t=oi({state:a()});e.nextEnabled=o.hasNextPage(a()),e.previousEnabled=t>1})():(()=>{const t=oi({state:a()}),r=o.getTotalPageCount(a());e.currentPage=t,r<1?e.disable():(e.enable(),e.totalPages=r)})()};return{...Xc(e),bind(){const t=o.isCursorPaging(),r=e=>{let{delta:r,index:n}=e;const i=oi({state:a()}),s=r?i+r:n,c=ei({state:a()}),l=t?s:(0,D.clamp)(s,1,o.getTotalPageCount(a()));o.setCurrentIndex(((e,t)=>t*(e-1))(l,c))};t?(e.navigationType="arrowsOnly",e.onNextClicked(n((()=>r({delta:1})),w.withMessage("Pagination adapter onNextClicked failed"))),e.onPreviousClicked(n((()=>r({delta:-1})),w.withMessage("Pagination adapter onPreviousClicked failed")))):e.onChange(n((e=>r({index:e.target.currentPage})),w.withMessage("Pagination adapter onChange failed")))},async onRecordsLoaded(){i()},async onCurrentViewChanged(){i()}}}],[fe,(e,t,r)=>{const{logger:n}=U,{actions:o,getState:a,getFieldType:i,wixFormatter:s}=r,c=(e,t,r)=>{let{expressions:n={},properties:o={}}=t;const a=e=>{let{propPath:t,marker:n,value:o,fieldType:a,format:i}=e;if("address"===t)return Object.assign(n,{address:(0,D.get)(o,"formatted"),location:(0,D.get)(o,"location")});if("link"===t&&(0,D.isEmpty)(o))return n;const c=Ua({value:o,role:r,fieldType:a,propPath:t,format:i,utils:{formatter:s}});return Object.assign(n,{[t]:c})};let c={};return c=(0,D.reduce)(n,((t,r,n)=>{let{expression:o}=r;const i=Ha({expression:o,variables:e,functions:Ka()});return a({propPath:n,marker:t,value:i})}),c),c=(0,D.reduce)(o,((t,r,n)=>{let{fieldName:o,format:s}=r;const c=Qo(e,o);return a({propPath:n,marker:t,format:s,value:c,fieldType:i(o).getOrElse(void 0)})}),c),c},l=async()=>{const{role:r}=e;try{const{items:n}=await o.fetchCurrentItems(a());e.markers=n.map((e=>c(e,t,r)))}catch(e){n.log(new w("Failed setting markers",{cause:e}))}};return{...Xc(e),isValidConnection:()=>Jc(t),async onRecordsLoaded(){l()},async onCurrentViewChanged(){l()},async onCurrentIndexChanged(){const t=ni({state:a()});e.setCenter((0,D.get)(e,["markers",t,"location"]))},async onCurrentRecordModified(){const{role:r}=e,n=Zr(a()),o=ni({state:a()});e.markers[o]=c(n,t,r),e.setCenter((0,D.get)(e,["markers",o,"location"]))}}}]]),fl=e=>{let{components:t,context:r}=e;const n=(e=>{let{recordStore:t,dispatch:n}=e;const a={fetchRecordById:(e,r)=>t(r).fold((()=>je.Maybe.Nothing()),(t=>t.getRecordById(e))),fetchAll:e=>(async(e,t,r,n)=>{const o=await e(n).fold((()=>ji.Empty()),(e=>e.externalApi.getRecordsLimitedByMaxPageSize(t,r)));return o.get()})(t,0,1e3,e),fetchCurrentItems:e=>Ns(t,e).catch((()=>ji.Empty().get())),fetchOne:()=>Ps(t,0,1),fetch:(e,r,n)=>Ps(t,e,r,n),getTotalPageCount:e=>ii({state:e,recordStore:t}),getInitialData:()=>t().fold((()=>ji.Empty()),(e=>e.externalApi.getSeedRecords())),setCurrentIndex:(e,t)=>n(ws(e,t)),setFieldInCurrentRecordAndSynchronize:(e,t,r)=>{n(Os({[e]:(0,D.cloneDeep)(t)},r))},refresh:()=>n(Cs()),resetUserInputFilters:()=>{const e=o.filter((e=>{let{role:t}=e;return t===Q||we.includes(t)})),t=dn(r.getState());e.length&&(e.forEach((e=>e.resetUserFilter())),t||a.refresh())},isCurrentRecordNew:e=>t().fold((()=>!1),(t=>t.isNewRecord(ni({state:e})))),isCurrentRecordPristine:e=>t().fold((()=>!1),(t=>t.isPristine(ni({state:e})))),isCursorPaging:()=>Za({recordStore:t}),hasNextPage:e=>ui({state:e,recordStore:t}),getUniqueFieldValues:e=>t().fold((()=>!1),(t=>t.getUniqueFieldValues(e)))};return a})(r),o=t.map((e=>((e,t,r)=>(pl.get(e.role)||(e.isInput?il:Kc))(e,t,r))(e,((e,t)=>{if(!e)return e;const{properties:r,totalCount:n}=e;return{...e,...r?{properties:(0,D.mapKeys)(r,((e,r)=>Yc(r)?zc({propName:r,getFieldType:()=>t(e.fieldName).getOrElse(null)}):r))}:{},...n?{totalCount:{prop:Yc(n.prop)?zc({propName:n.prop,getFieldType:()=>null}):n.prop}}:{}}})(e.connectionConfig,r.getFieldType),{...r,actions:n}))).filter((e=>e.isValidConnection()));return{bindAll:async()=>Promise.all(o.map((e=>(e.bind(),e.onRecordsLoaded())))),hideAll:()=>o.map((e=>e.hide())),showAll:()=>o.map((e=>e.show({ignoreInitiallyHidden:!0}))),clearAll:()=>o.map((e=>e.clear())),onRecordsLoaded:()=>o.map((e=>e.onRecordsLoaded())),onCurrentViewChanged:()=>o.map((e=>e.onCurrentViewChanged())),onCurrentIndexChanged:()=>o.map((e=>e.onCurrentIndexChanged())),onCurrentRecordModified:(e,t)=>o.filter((e=>{let{id:r}=e;return!t||t!==r})).map((t=>t.onCurrentRecordModified(e)))}},hl=e=>{let{datasetId:t,masterIds:r,connectionsGraph:n}=e;const o=e=>n[t].includes(e.id)?"PRIMARY":r.some((t=>n[t].includes(e.id)))?"DETAILS":"OTHER";return{isInsidePrimaryOrDetailsRepeater:e=>{let{parentRepeater:t}=e;return!!(r=t)&&["PRIMARY","DETAILS"].includes(o(r));var r},getDetailsRepeaters:e=>{const t=[];return e.forEach((e=>{let{parentRepeater:r}=e;r&&"DETAILS"===o(r)&&t.push(new Proxy(r,{get:(e,t)=>"role"===t?J:e[t]}))})),(0,D.uniqBy)(t,"uniqueId")}}},ml=[l.FieldType.text,l.FieldType.number,l.FieldType.image,l.FieldType.video,l.FieldType.mediaGallery,l.FieldType.richContent],gl={[l.FieldType.text]:"text",[l.FieldType.number]:"number",[l.FieldType.image]:"image",[l.FieldType.video]:"video",[l.FieldType.mediaGallery]:"gallery",[l.FieldType.richContent]:"rich-content"},yl=e=>{var t;let{recordStore:r,state:n,schema:o,connections:a,isDpItemDataset:i}=e;if(!i&&!a.length)return{collectionData:void 0};const s=Zr(n);if(!s)return{collectionData:void 0};const{id:c,displayName:l,displayField:d,fields:u}=o,p=i&&d?s[d]:void 0,f=i?1:null!=(t=(e=>{let{recordStore:t}=e;const r=ai({recordStore:t});return r?r.total:null})({recordStore:r}))?t:void 0;return{title:p,collectionData:{id:c,name:l||c,totalCount:f,fields:vl({connections:a,fields:u,currentRecord:s}),primary:i}}},vl=e=>{let{connections:t,fields:r,currentRecord:n}=e;const o=t.reduce(Il,{});return Object.entries(r).filter((e=>{let[t,r]=e;return!r.pii&&!r.isDeleted&&ml.includes(r.type)})).map((e=>{var t;let[r,a]=e;return{key:r,type:gl[a.type],label:a.displayName,connected:!(null==(t=o[r])||!t.length),value:_l({key:r,field:a,currentRecord:n,connections:o[r]||[]})}}))},_l=e=>{let{key:t,field:r,currentRecord:n,connections:o}=e;const{type:a}=r,i=n[t];switch(a){case l.FieldType.image:return i&&El({src:i},o);case l.FieldType.video:return i&&Tl({src:i},o);case l.FieldType.mediaGallery:return Sl(i,o);case l.FieldType.text:case l.FieldType.number:case l.FieldType.richContent:return i;default:throw new Error("Unsupported field type: "+a)}},Il=(e,t)=>{var r;const n=(null==t||null==(r=t.config)?void 0:r.properties)||{};return Object.values(n).map((e=>{let{fieldName:t}=e;return t})).forEach((r=>{e[r]||(e[r]=[]),e[r].push(t)})),e},El=(e,t)=>{let{src:r}=e;const n=t.some((e=>{var t,r,n;let{role:o,config:a}=e;return o===te&&Boolean(null==a||null==(t=a.properties)?void 0:t.items)||o===ee&&Boolean(null==a||null==(r=a.properties)?void 0:r.src)||"imageRole"===o&&Boolean(null==a||null==(n=a.properties)?void 0:n.src)}));return{url:r,...Rl(r),connectedToSrc:n}},Tl=(e,t)=>{let{src:r,title:n,description:o}=e;const a=t.some((e=>{var t,r,n;let{role:o,config:a}=e;return o===te&&Boolean(null==a||null==(t=a.properties)?void 0:t.items)||"videoPlayerRole"===o&&Boolean(null==a||null==(r=a.properties)?void 0:r.src)||"videoRole"===o&&Boolean(null==a||null==(n=a.properties)?void 0:n.src)}));if(!bl(r))return{thumbnailUrl:void 0,title:n,description:o,uploadDate:void 0,connectedToSrc:a};const[i,s]=r.match(/posterUri=(\w+)/)||[],[c,l]=r.match(/posterWidth=(\d+)/)||[],[d,u]=r.match(/posterHeight=(\d+)/)||[];return{thumbnailUrl:wl({uri:s,width:Number(l),height:Number(u)}),title:n,description:o,uploadDate:void 0,connectedToSrc:a}},Sl=function(e,t){return void 0===e&&(e=[]),e.map((e=>"image"===e.type?El(e,t):Tl(e,t)),t)},Rl=e=>{if(!Ol(e))return{height:void 0,width:void 0};const[t,r]=e.match(/originHeight=(\d+)/)||[],[n,o]=e.match(/originWidth=(\d+)/)||[];return{height:r?Number(r):void 0,width:o?Number(o):void 0}},wl=e=>{let{uri:t,width:r,height:n,filename:o="image.ext"}=e;return"wix:image://v1/"+t+"/"+o+"#originWidth="+r+"&originHeight="+n},Ol=e=>e.startsWith("wix:image://"),bl=e=>e.startsWith("wix:video://"),Cl=(e,t)=>r=>{let{shouldCollectSeoData:n,controllerConfig:o,datasetType:a,connections:i,connectionsGraph:s,isScoped:c,datasetScope:l,dataProvider:d,dependencyManager:u,seoManager:p,firePlatformEvent:f,dynamicPagesData:h,datasetId:m,fixedRecordId:g,recordStoreService:y,updatedCompIds:v,markControllerAsRendered:_,markDatasetDataFetched:I,renderingRegularControllers:E,modeIsLivePreview:T,modeIsSSR:S,schemasLoading:R,listenersByEvent:O}=r;const b=i.filter((e=>!(e=>{let{role:t}=e;return we.includes(t)})(e)||e.config)),C=!!g,{logger:P,loadExpressionFunctions:N,platform:{user:A,settings:{locale:x},timers:{queueMicrotask:L}}}=U,{setConnectedComponents:F,getConnectedComponents:M}=(()=>{let e;return{setConnectedComponents:t=>e=t,getConnectedComponents:()=>e}})(),k=[],{store:j,subscribe:V,onIdle:W}=Gs(P,m),q=oc(f),{fireEvent:H,register:$}=q;k.push(q.dispose);const z=new G({datasetId:Bc(m),scopedDatasetId:c?m:void 0,getState:j.getState,getSchema:function(e){return void 0===e&&(e=ee),d.getSchema(e)}}),Y=z.subscribe(O);k.push(...Y),j.dispatch(Xt({controllerConfig:o,connections:b,isScoped:c,datasetType:a}));const{datasetIsVirtual:X,datasetIsReal:J,datasetIsDeferred:K,datasetIsWriteOnly:Q,datasetIsRouter:Z,datasetCollectionName:ee,dynamicPageNavComponentsShouldBeLinked:te}=(re=j.getState(),{datasetIsRouter:zr(re),datasetIsMaster:Yr(re),datasetIsVirtual:Xr(re),datasetIsReal:Jr(re),datasetIsDeferred:Kr(re),datasetIsWriteOnly:Hr(re),datasetCollectionName:Ur(re),dynamicPageNavComponentsShouldBeLinked:Qr(re)});var re;const ne=kr(j.getState()),oe=Gr(j.getState()),ae=function(e){return void 0===e&&(e=ee),je.Maybe.fromNullable(d.getSchema(e))},ie=e=>{const t=ae(ee),r=d.getReferencedSchemas(ee);return t.chain((t=>je.Maybe.fromNullable(Ln(t,r)(e))))},se=((e,t,r)=>({dataBinding:$o(e),currentUser:Ho(),userInput:yi({getConnectedComponents:t,getFieldType:r})}))((e=>u.getDependencyById(e,l)),M,ie),le=Ti({valueResolvers:se,getConnectedComponents:()=>Wr(j.getState())?M():[],getFieldType:ie,getUserFilterInitialData:()=>gn(j.getState()),wasSetFilterCalled:(0,D.flow)((()=>j.getState()),dn)}),de=(e=>{let{recordStoreService:t,getFilter:r,getSort:n,getPageSize:o,datasetId:a,filterResolver:i,getSchema:s,fixedRecordId:c}=e;return e=>{const l=o();return t.chain((t=>{if(e)return je.Result.fromMaybe(s().map((t=>Fn(e,t))),"cannot resolve referenced collection name for field "+e).map((e=>t({pageSize:l,sort:null,filter:null,datasetId:a,referencedCollectionName:e,fixedRecordId:c})));{const e=r();return je.Result.fromMaybe(i(e).map((e=>t({pageSize:l,sort:n(),filter:e,datasetId:a,referencedCollectionName:null,fixedRecordId:c}))),"could not resolve dynamic filter")}}))}})({recordStoreService:y,getFilter:(0,D.flow)((()=>j.getState()),kr),getSort:(0,D.flow)((()=>j.getState()),Gr),getPageSize:()=>ei({state:j.getState()}),datasetId:m,filterResolver:le,getSchema:ae,fixedRecordId:g}),ue=te?(e=>{let{dataProvider:t,dynamicPagesData:r,collectionName:n}=e;return{getNextDynamicPageUrl:()=>Cc({dataProvider:t,dynamicPagesData:r,collectionName:n,directionTowardSibling:"asc"}),getPreviousDynamicPageUrl:()=>Cc({dataProvider:t,dynamicPagesData:r,collectionName:n,directionTowardSibling:"desc"})}})({dataProvider:d,dynamicPagesData:h,collectionName:ee}):null;let pe,fe;te&&(V(Ic(ue)),j.dispatch(xs(b)));const he=new Promise(((e,t)=>{pe=e,fe=t})),me=c?void 0:()=>he;c||$("datasetReady",pe);const ge=nc({store:j,recordStore:de,eventListeners:q,controllerStore:t,datasetId:m,datasetType:a,isFixedItem:C,siblingDynamicPageUrlGetter:ue,onIdle:W,dispatcher:z,onReadyAsync:me}),ve=ge(!1);k.push(y.map((e=>e.onChange(Vc(j.getState,j.dispatch)))).getOrElse((()=>{})));const{fetchingInitialData:_e,resolveUserInputDependency:Ie}=Fc({dependencyManager:u,shouldFetchInitialData:o&&!Q,recordStore:de,store:j,filter:ne,sort:oe,datasetIsDeferred:K,modeIsSSR:S,queueMicrotask:L,datasetIsReal:J,collectionId:ee,filterResolver:le,getSchemas:()=>d.getSchemas(),schemasLoading:R,getUserFilterInitialData:()=>d.getUserFilterInitialData(m)});_e.then((()=>{I();const e=de().fold((()=>{}),(e=>e.getSeedRecords().matchWith({Empty:()=>{},Results:e=>{let{items:t}=e;return t[0]}})));e&&j.dispatch(As.setCurrentRecord(e,0))}));c&&!C&&u.getDependenciesByFilter(ne,l).forEach((e=>{let{masterDataset:{api:t}}=e;Wc({detailsDatasetApis:[ve],store:j,masterDatasetApi:t,controllerConfig:o,unsubscribeHandlers:k})}));n&&J&&!K&&Promise.all([_e,R]).then((()=>{let e={};try{e=yl({isDpItemDataset:Z,recordStore:de,state:j.getState(),schema:d.getSchema(ee),connections:b})}catch(e){P.log(new w("Failed to extract seo data for dataset "+m,{cause:e}))}p.submitSeoData(e)}));const Ee=async function(r){A.onLogin((()=>{(()=>{const e=ni({state:j.getState()}),t=de().fold((()=>!1),(t=>t.isPristine(e)));return t&&!Q})()&&ve.refresh()}));const{components:n,detailsDatasetApis:i}=r(b),c=Gc({updatedCompIds:v,datasetIsReal:J,connectionsGraph:s,components:n});F(c);const l=((e,t)=>{let{datasetId:r,connectionsGraph:n,datasetIsReal:o,getDependencies:a}=t;if(!o)return e;const{isInsidePrimaryOrDetailsRepeater:i,getDetailsRepeaters:s}=hl({datasetId:r,connectionsGraph:n,masterIds:a().map((e=>e.masterDatasetId))}),c=e.filter((e=>!i(e)));return c.push(...s(e)),c})(c,{datasetId:m,datasetIsReal:J,connectionsGraph:s,getDependencies:()=>u.getDependenciesByFilter(ne)});if(Wc({detailsDatasetApis:i,masterDatasetApi:ve,dependencyManager:u,controllerConfig:o,unsubscribeHandlers:k}),J&&await R,Ie(),!Vr(j.getState())||!d.hasSchema(o.dataset.collectionName))return _e.then((()=>{_(),u.resolveDependants(m),j.dispatch(Ms(!0)),H("datasetReady")})),Promise.resolve();const p=fl({components:l,context:{connections:b,recordStore:de,dispatch:j.dispatch,getState:j.getState,datasetApi:ve,eventListeners:q,dispatcher:z,getFieldType:ie,getSchema:ae,controllerFactory:e,controllerStore:t,modeIsLivePreview:T,wixFormatter:x?fc({locale:x}):null}});V(((e,t,r,n,o,a,i,s)=>{const c=gc(e,t,r,n,o,a,i,s),l=e=>{let{from:t,to:r,hasChanged:n,hasChangedToFalse:o,hasChangedToTrue:a,hasChangedToMatch:i}=e;const s=en(r),l=en(t),d=rn(r),u=un(r),p=[];return(i(rn,(e=>e>=0&&e!==s))||a(un))&&p.push(c.goToRecordByIndex(l,d,u)),(n(en)&&l>=0||o(ln)&&0===s)&&p.push(c.notifyIndexChange(s)),p},d=e=>{let{from:t,to:r,hasChanged:n,hasChangedToMatch:o,hasChangedToTrue:a}=e;const i=en(r),s=Zr(r),l=Zr(t),d=[];Li(l,s)?(0,D.isEqual)(l,s)||(d.push(c.updateComponents(on(r),l)),d.push(c.fireEvent("itemValuesChanged",(0,D.cloneDeep)(l),(0,D.cloneDeep)(s)))):null==l||null==s||n(en)||d.push(c.updateComponents());const u=nn(r);return o(nn,(e=>null!=e))&&d.push(c.setFieldsInCurrentRecord(u,i,on(r))),a(hn)&&d.push(c.revertChanges(i,tn(r))),a(fn)&&d.push(c.removeCurrentRecord(i)),d},u=e=>{let{to:t,hasChanged:r,hasChangedToFalse:n,hasChangedToTrue:o}=e;const a=[];return r(yc)&&a.push(c.refresh(en(t),tn(t),Hr(t))),r(jr)&&a.push(c.notifyRecordSetLoaded()),o(ln)&&a.push(c.refresh(en(t),tn(t),Hr(t))),n(ln)&&a.push(c.notifyRecordSetLoaded()),o(pn)&&a.push(c.updateCurrentView()),a},p=e=>{let{to:t,hasChangedToTrue:r}=e;const n=en(t),o=Zr(t);if(r(mn))return c.saveRecord(n,o)},f=e=>{let{to:t,hasChangedToNotNull:r}=e;const n=[];return r(an)&&n.push(c.newRecord(an(t),tn(t))),n};return e=>(0,D.flatten)([l,d,u,p,f].map((t=>t(e))))})(de,p,ie,q.executeHooks,m,l,H,z)),k.push(((e,t,r,n,o)=>dc(e,t,r,n,o))(j,l,P,m,de));const f=Uc(l.filter((e=>{let{role:t}=e;return![ce,ye].includes(t)})),ie);j.dispatch(As.setDefaultRecord(f)),Q&&await j.dispatch(As.initWriteOnly(X)),K&&(p.hideAll(),S&&p.clearAll());const h=b.some((e=>{var t;return Object.keys((null==e||null==(t=e.config)?void 0:t.expressions)||{}).length>0}))?N():Promise.resolve(),g=Promise.all([_e,h]).then((async()=>{if(K&&await E,!S)try{((e,t,r,n,o,a)=>{if(n)return;const i=Ur(e);if(!i)return;const s=a.fold((()=>i),(e=>e.displayName)),c=Br(e),l=!!Zr(e),{logger:d,platform:{settings:{env:{editor:u}}}}=U;l&&[yn,vn].includes(c)&&t.find((e=>{let{role:t,config:r}=e;return Ge(t,r)}))&&d.log(new Sn({id:u?153:152,collectionId:i,collectionName:s,datasetId:o,datasetType:r,datasetMode:c})),ut(Br(e),t)&&d.log(new Sn({id:u?157:156,collectionId:i,collectionName:s,datasetId:o,datasetType:r,datasetMode:c}))})(j.getState(),b,a,X,m,ae(ee))}catch(e){P.log(new w("Failed to report dataset active BI",{cause:e}))}await p.bindAll(),J&&await(e=>Promise.all(e.getAll().map((e=>new Promise((t=>{e.staticExports.onReady(t)}))))))(t),K&&p.showAll(),u.resolveDependants(m),j.dispatch(Ms(!0)),H("datasetReady")}));return K?(_(),Promise.resolve()):(g.then(_),g)},Te=ge(!0);return{pageReady:B(X?Ee:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return P.log(new Ae("dataset/pageReady",(()=>Ee(...t))))},(e=>(fe(),P.logError(e,"Dataset pageReady callback failed",{datasetId:m})))),exports:e=>e.type===Ss.l.COMPONENT?Te.inScope(e.compId,e.additionalData.itemId):Te,staticExports:Te,dispose:()=>{k.forEach((e=>e()))},api:ve,userFilterInitialDataPromise:_e.then((e=>{let[t,r]=e;return r}))}},Pl=(e,t)=>{const r=Ts(e),n={createRealDataset:()=>o({...t,isScoped:!1}),createScopedDetailsDataset:e=>{let{datasetScope:r}=e;return o({...t,isScoped:!0,firePlatformEvent:D.noop,datasetId:jc(t.datasetId,r),datasetScope:r})},createScopedDataset:e=>{let{datasetScope:r,fixedItem:n}=e;const{dataProvider:a,controllerConfig:i,dynamicPagesData:s}=t,c=(0,D.cloneDeep)(i),l={items:[n]};c.dataset.filter=a.createSimpleFilter("_id",n._id);const{collectionName:d}=i.dataset;return a.setCollectionData({collectionId:d,data:l}),o({...t,isScoped:!0,controllerConfig:c,firePlatformEvent:D.noop,dynamicPagesData:s,datasetId:jc(t.datasetId,r),fixedRecordId:r.itemId})}},o=Cl(n,r);return n},Nl=e=>Ri(e).map((e=>{let{filterExpression:{filterId:t}}=e;return t}));var Dl=a(9025);class Al{constructor(){this._datasetConfigs=new Map}get datasetConfigs(){return this._datasetConfigs}}class xl{constructor(e){let{platform:t,dataFetcher:r,warmupCache:n,staticCache:o,features:a,listenersByEvent:i,logger:s,i18n:c,global:l,loadExpressionFunctions:d}=e;const u=new _n(s,l);k({loadExpressionFunctions:d,platform:t,features:a,dataFetcher:r,i18n:c,appState:new Al,logger:u,errorReporting:In(u),breadcrumbReporting:En(u),verboseReporting:Tn(u)}),this._listenersByEvent=i,this._dataProvider=new Mo,this._warmupCache=n,this._staticCache=o,this._features=a,this._logger=u,this._recordStoreCache={}}initializeDatasets(e){let{datasetConfigs:t,firePlatformEvent:r}=e;try{return this._logger.log(new Ae("databinding/createControllers",(()=>this._initializeDatasets({datasetConfigs:t,firePlatformEvent:r}))))}catch(e){return this._logger.logError(e,"Datasets initialisation failed"),[]}}_initializeDatasets(e){let{datasetConfigs:t,firePlatformEvent:r}=e;const{platform:{settings:{mode:{name:n,csr:o,ssr:a},env:{livePreview:i,live:s}},seo:c,location:l}}=U,d=Pi(t),u=this._updateDatasetConfigsState(d),p=this._features.warmupData,f=[],h=[],{resolve:m,promise:g}=new j;this._dataProvider.setSchemas({...p&&o&&this._warmupCache.getSchemas()||{},...this._staticCache.getSchemas()||{}});const y=this._logger.log(new Ae("databinding/loadSchemas",(()=>this._dataProvider.loadSchemas(Ll(d)).then((()=>p&&a&&this._warmupCache.setSchemas(this._dataProvider.getSchemas()))))));this._dataProvider.setDatasetConfigs(d.map((e=>{let{config:{dataset:{collectionName:t}},compId:r,type:n}=e;return{collectionId:t,datasetId:r,type:n}})));const v=o&&p&&this._warmupCache.getDataStore();v&&this._dataProvider.setStore(kl(v));const _=this._staticCache.getDataStore();_&&this._dataProvider.setStaticStore(kl(_)),this._dataProvider.createInitialDataRequest(this._getInitialDataRequestConfigs(d,u));const I=d.reduce(((e,t)=>{let{compId:r,connections:n}=t;return e[r]=n.map((e=>{let{compId:t}=e;return t})),e}),{}),E=(e=>{let{datasetConfigs:t}=e;const r={},n={},o=(e,t)=>{const o=n[e];if(!o)return;const a=r[o.masterDatasetId];return a?{...o,masterDataset:t?{...a,api:a.api.inScope(t.repeaterId,t.itemId)}:a}:o};return t.forEach((e=>{let{id:t,connections:r}=e;r.forEach((e=>{let{role:r,config:o}=e;r===K&&Object.entries(o.filters).forEach((e=>{let r,[o,{fieldName:a}]=e;n[o]={id:o,fieldName:a,masterDatasetId:t,isResolved:!1,promise:new Promise((e=>r=e)),resolve:()=>{n[o].isResolved=!0,r()}}}))}))})),{resolveDependants:e=>Object.values(n).forEach((t=>{let{id:r,masterDatasetId:o}=t;e===o&&n[r].resolve()})),getDependencyResolutionPromise:e=>{const t=Nl(e).flatMap((e=>n[e]&&!n[e].isResolved?[n[e].promise]:[]));return t.length>0?Promise.all(t):void 0},getDependencyById:o,getDependenciesByFilter:(e,t)=>Nl(e).flatMap((e=>o(e,t)||[])),registerDataset:e=>{let{id:t,api:n,config:o}=e;r[t]={id:t,api:n,config:o}}}})({datasetConfigs:d}),T=d.some((e=>{let{type:t,dynamicPageData:r}=e;return t===mr&&!(null==(n=null==r?void 0:r.dynamicUrl)||!n.match(/\{.+\}/));var n})),S=T&&d.some((e=>{let{type:t,dynamicPageData:r}=e;return t===mr&&(null==r?void 0:r.seoV2)})),R=s&&T&&S,O=R?(e=>{let{seo:t,pageUrl:r}=e;const{logger:n}=U;let o;const a={title:void 0,pageUrl:r,collections:[]};return{submitSeoData:e=>{let{title:t,collectionData:r}=e;o||(t&&(a.title=t),r&&a.collections.push(r))},renderSeoTagsOnce:()=>(o||(o=t.renderSEOTags({itemType:Dl.ITEM_TYPES.WIX_DATA_PAGE_ITEM,itemData:a}).catch((e=>{n.log(new w("Failed to render seo tags",{cause:e}))}))),o)}})({seo:c,pageUrl:l.pageUrl}):null,b=d.map((e=>{let{type:t,config:s,connections:c,compId:l,livePreviewOptions:{shouldFetchData:d,compsIdsToReset:u=[]}={},dynamicPageData:m}=e;const{datasetIsRouter:_,datasetIsDeferred:T}=s.datasetStaticConfig;this._logger.log(new xe({category:"createControllers",message:"warmup data contents",data:{datasetId:l,datasetType:t,mode:n,warmupData:Boolean(v)}}));const S=(e=>{let{primaryDatasetId:t,recordStoreCache:r,refreshStoreCache:n,dataProvider:o,controllerConfig:a}=e;return je.Result.fromNullable(a,"missing controller configuration").chain((e=>{let{dataset:t}=e;return je.Result.fromNullable(t,"controller configuration is missing dataset object")})).chain((e=>{let{collectionName:t}=e;return je.Result.fromNullable(t,"dataset is not connected to a collection")})).map((e=>{const i=(0,D.get)(a,["dataset","includes"]),s=(0,D.get)(a,["dataset","nested"]),c=(0,D.get)(a,["dataset","cursor"]),l=(0,D.get)(a,["dataset","readWriteType"]),d=(0,D.get)(a,["dataset","uniqueFieldValues"]);return Es({primaryDatasetId:t,recordStoreCache:r,refreshStoreCache:n,dataProvider:o,mainCollectionName:e,includes:i,nestedFieldKeys:s,uniqueFieldValues:d,readWriteType:l,cursorPagingRequired:c})}))})({primaryDatasetId:l,recordStoreCache:this._recordStoreCache,refreshStoreCache:d,dataProvider:this._dataProvider,controllerConfig:s}),{promise:w,resolve:b}=new j;_||T||f.push(w);const{promise:C,resolve:P}=new j;h.push(C);const N=o&&p&&this._warmupCache.getUserFilterInitialData(l);N&&this._dataProvider.setUserFilterInitialData(l,N);const A=Pl(this._logger,{shouldCollectSeoData:R,seoManager:O,dependencyManager:E,controllerConfig:s,datasetType:t,connections:c,connectionsGraph:I,recordStoreService:S,dataProvider:this._dataProvider,firePlatformEvent:r(l),dynamicPagesData:_&&m?{dynamicPageData:m,items:this._staticCache.getItems(),datasetConfig:s}:void 0,datasetId:l,schemasLoading:y,listenersByEvent:this._listenersByEvent,updatedCompIds:u,markControllerAsRendered:P,markDatasetDataFetched:b,renderingRegularControllers:g,modeIsLivePreview:i,modeIsSSR:a}).createRealDataset();return E.registerDataset({id:l,api:A.api,config:s}),a&&p&&A.userFilterInitialDataPromise.then((e=>{this._warmupCache.setUserFilterInitialData(l,e)})),Fl(A)}));a&&p&&f.length&&Promise.all(f).then((()=>{this._warmupCache.setDataStore(Ul(this._dataProvider.getStore()))})),Promise.all(h).then(m);const C=()=>Promise.all(f).then(O.renderSeoTagsOnce);return R?b.map((e=>({...e,pageReady:function(){return e.pageReady(...arguments).then(C)}}))):b}_updateDatasetConfigsState(e){const{appState:t}=U;return e.reduce(((e,r)=>{let{compId:n,config:{dataset:o}}=r;const a=t.datasetConfigs.get(n);return a&&!(0,D.isEqual)(a,o)&&e.push(n),t.datasetConfigs.set(n,o),e}),[])}_getInitialDataRequestConfigs(e,t){return e.reduce(((e,r)=>{let{compId:n,config:{datasetStaticConfig:{sequenceType:o}},livePreviewOptions:{shouldFetchData:a}={}}=r;return o===Go?[...e,{id:n,refresh:a||t.includes(n)}]:e}),[])}}const Ll=e=>[...e.reduce(((e,t)=>{let{config:{dataset:{collectionName:r}}}=t;return r?e.add(r):e}),new Set)],Fl=e=>{let{pageReady:t,exports:r,dispose:n}=e;return{pageReady:t,exports:r,dispose:n}},Ml=e=>t=>{if(t)return{...t,recordsByCollectionId:Object.entries(t.recordsByCollectionId).reduce(((t,r)=>{let[n,o]=r;return t[n]=e(o),t}),{})}},Ul=Ml(Rn.ah),kl=Ml(Rn.PL),Gl=e=>{let{datasetId:t,record:r,schema:n,getSchema:o}=e;const a={"form-id":{value:t,keyName:""}},i=(0,D.pickBy)(n.fields,((e,t)=>((e,t)=>{const r=e.type,n=_.includes(r),o=!!e.systemField,a=["_createdDate","_updatedDate"].includes(t||e.name);return(!o||a)&&n})(e,t)&&!function(e){return!!e.isDeleted}(e)));return(0,D.forEach)(i,((e,n)=>{const i=function(e){let{record:t,fieldData:r,fieldName:n,getSchema:o}=e;if("reference"===r.type){const e=o(r.referencedCollection);if(!e)return;const a=Qo(t[n],e.displayField);return{value:da(a),type:e.fields[e.displayField].type}}return{value:da(Qo(t,n)),type:r.type}}({record:r,fieldData:e,fieldName:n,getSchema:o});if(!i)return;const{value:s,type:c}=i,{displayName:l,index:d}=e,u=((e,t)=>`${e}.${t}`)(t,n);a["field:"+u]={value:s,keyName:l,index:d,valueType:c}})),a};const jl=e=>{let{automationsClientCreator:t,pageId:r}=e;const n=t().reportFormEventToAutomationCreator();return{afterSave:async(e,t,o)=>{let{datasetId:a,getSchema:i,getState:s}=e;const c=s(),l=i();if(!Boolean(c.records.isForm)||!l)return;const{eventUTCTime:d,detailedEventPayload:u,collectionId:p}=(e=>{let{datasetId:t,getSchema:r,record:n,schema:o}=e;return{eventUTCTime:Qo(n,"_updatedDate"),detailedEventPayload:Gl({datasetId:t,record:n,schema:o,getSchema:r}),collectionId:o.id}})({datasetId:a,record:o,schema:l,getSchema:i});await n({eventUTCTime:d,detailedEventPayload:u},p,r)}}};var Bl=a(5675),Vl=a.n(Bl);function Wl(e){return"object"===Vl()(e)}function ql(e){return"array"===Vl()(e)}function Hl(e){return"string"===Vl()(e)}function $l(e){return function(e){if(!Hl(e))return e;var t=e.slice(0,1).toUpperCase(),r=e.slice(1,e.length);return t+r}(Vl()(e))}function zl(e){if(null==e||"object"!=typeof e)return e;var t=null;if(function(e){return"date"===Vl()(e)}(e))t=new Date(e.getTime());else for(var r in t=e.constructor(),e)t[r]=zl(e[r]);return t}var Yl=a(3065);a(5174);var Xl=function(){return"WDE0001: Collection name must be a string."},Jl=function(){return"WDE0002: ItemId must be a string."},Kl=function(){return"WDE0068: Item ids must be an array of strings"},Ql=function(e){return"WDE0069: Failed to remove items from [".concat(e,"].\nCannot remove more than 1000 items in one request")},Zl=function(){return"WDE0003: FieldName must be a string."},ed=function(e,t){return"WDE0004: Failed to save [".concat(e,"] into [").concat(t,"].\nItems must be JavaScript objects.")},td=function(e){return"WDE0005: Failed to bulk save items into [".concat(e,"].\nItems must be an array of JavaScript objects and itemIds must be strings if present.")},rd=function(e){return"WDE0006: Failed to bulk save items into [".concat(e,"].\nCannot insert more than 1000 items in one request")},nd=function(){return"WDE0007: Invalid update. Updated object must have a string _id property."},od=function(e,t,r,n){return"WDE0008: wixData.".concat(e," expects between ").concat(t," and ").concat(r," arguments, but was called with ").concat(n,".")},ad=function(e){return"WDE0018: Options must be an object with one or all of the following boolean properties: ".concat(e.join(", "),".")},id=function(){return"WDE0019: Reference operation takes a string ID or an object with an ID to be connected."},sd=function(){return"WDE0021: Invalid reference"},cd=function(e){return"WDE0025: The ".concat(e," collection does not exist. You cannot work with a collection using the Data API before it is created in the Editor.")},ld=function(e){return"WDE0026: The ".concat(e," collection was removed, so you cannot work with it. To restore its data, create a new collection with the same name.")},dd={queryInvalid:function(e,t){return"Failed to perform query on [".concat(e,"].\n").concat(t.join("\n"))},isNumber:function(e,t,r){return"WDE0032: Invalid ".concat(e," parameter [").concat($l(r),"]. ").concat(e," parameter must be a ").concat(t," number.")},isPositiveNumber:function(e,t){return"WDE0033: Invalid ".concat(e," parameter [").concat(t,"]. ").concat(e," parameter must be a positive number.")},isNonNegativeNumber:function(e,t){return"WDE0034: Invalid ".concat(e," parameter [").concat(t,"]. ").concat(e," parameter must be a non-negative number.")},isInteger:function(e,t){return"WDE0035: Invalid ".concat(e," parameter [").concat(t,"]. ").concat(e," parameter must be an integer.")},isNonEmptyString:function(e){return"WDE0094: Invalid ".concat(e," parameter. ").concat(e," parameter must be non-empty string.")},notGreaterThan:function(e,t,r){return"WDE0036: Invalid ".concat(e," parameter [").concat(t,"]. ").concat(e," parameter cannot exceed ").concat(r,".")},invalidSkipParameter:function(e,t){return"WDE0037: Invalid query on [".concat(e,"].\nInvalid prev positioned query skip on a negative number ").concat(t,".")},noPrevPage:function(e){return"WDE0159: Invalid query on [".concat(e,"].\nThere is no prev page.")},noNextPage:function(e){return"WDE0165: Invalid query on [".concat(e,"].\nThere is no next page.")}},ud={arityIsZero:function(e){return"WDE0038: Invalid ".concat(e," usage. ").concat(e," does not take parameters.")},arityIsOne:function(e){return"WDE0039: Invalid ".concat(e," usage. ").concat(e," requires one parameter.")},arityIsTwo:function(e){return"WDE0040: Invalid ".concat(e," usage. ").concat(e," requires two parameters.")},arityIsThree:function(e){return"WDE0041: Invalid ".concat(e," usage. ").concat(e," requires three parameters.")},arityIsAtLeastTwo:function(e){return"WDE0042: Invalid ".concat(e," usage. ").concat(e," requires at least two parameters.")},arityIsAtLeastOne:function(e){return"WDE0043: Invalid ".concat(e," usage. ").concat(e," requires at least one parameter.")}},pd={ItemDoesNotExist:"WD_ITEM_DOES_NOT_EXIST",ItemAlreadyExists:"WD_ITEM_ALREADY_EXISTS",SiteInTemplateMode:"WD_SITE_IN_TEMPLATE_MODE",UnknownError:"WD_UNKNOWN_ERROR",ValidationError:"WD_VALIDATION_ERROR",CollectionDeleted:"WD_COLLECTION_DELETED",SchemaDoesNotExist:"WD_SCHEMA_DOES_NOT_EXIST",PermissionDenied:"WD_PERMISSION_DENIED",BadRequest:"WD_BAD_REQUEST",Unauthorized:"WD_UNAUTHORIZED",TooManyRequests:"WD_TOO_MANY_REQUESTS",RequestTimedOut:"WD_REQUEST_TIMED_OUT",QuotaExceeded:"WD_DATABASE_QUOTA_EXCEEDED",QueryExecutionError:"WD_QUERY_EXECUTION_ERROR"};function fd(e,t,r){return hd(e,t,r)}function hd(e,t,r){var n=new(t&&t!==pd.UnknownError?gd:Error)(e);return n.code=t,r&&(n.details=r),n}function md(e){return fd(cd(e),pd.SchemaDoesNotExist)}function gd(e){var t=new Yl.UserCodeError(e);return Object.setPrototypeOf(t,Object.getPrototypeOf(this)),Error.captureStackTrace&&Error.captureStackTrace(t,gd),t.name=Error.name,t}Object.create(Error.prototype,{constructor:{value:Error,enumerable:!1,writable:!0,configurable:!0}}),gd.prototype=Object.create(Yl.UserCodeError.prototype,{constructor:{value:gd,enumerable:!1,writable:!0,configurable:!0}});var yd=function(){function e(){this._validations=[]}return e.prototype.arityIsZero=function(e){var t=this;return this.addValidation((function(){return 0===e.length}),(function(){return ud.arityIsZero(t.operatorName)}))},e.prototype.arityIsOne=function(e){var t=this;return this.addValidation((function(){return 1===e.length}),(function(){return ud.arityIsOne(t.operatorName)}))},e.prototype.arityIsTwo=function(e){var t=this;return this.addValidation((function(){return 2===e.length}),(function(){return ud.arityIsTwo(t.operatorName)}))},e.prototype.arityIsThree=function(e){var t=this;return this.addValidation((function(){return 3===e.length}),(function(){return ud.arityIsThree(t.operatorName)}))},e.prototype.arityIsAtLeastTwo=function(e){var t=this;return this.addValidation((function(){return e.length>=2}),(function(){return ud.arityIsAtLeastTwo(t.operatorName)}))},e.prototype.arityIsAtLeastOne=function(e){var t=this;return this.addValidation((function(){return e.length>=1}),(function(){return ud.arityIsAtLeastOne(t.operatorName)}))},e.prototype.addValidation=function(e,t){return this._validations.push({predicateFn:e,messageFn:t}),this},e}(),vd=(function(e){function t(t){var r=e.call(this)||this;return r._invalidArguments=zl(t),r}za(t,e),t.prototype.validateAndAggregate=function(){var e=this,t=this._validations.every((function(t){var r=t.predicateFn,n=t.messageFn;return e._appendIfInvalid(r(),n())}));return[this._invalidArguments,t]},t.prototype._appendIfInvalid=function(e,t){return!!e||(this._invalidArguments.push(t),!1)}}(yd),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return za(t,e),t.prototype.validateAndReject=function(){var e=this;return Promise.resolve().then((function(){e._validations.forEach((function(e){var t=e.predicateFn,r=e.messageFn;if(!t())throw hd(r(),pd.ValidationError)}))}))},t}(yd));!function(e){function t(){return null!==e&&e.apply(this,arguments)||this}za(t,e),t.prototype.arity=function(e,t,r,n){return this.addValidation((function(){return t.length<=n&&t.length>=r}),(function(){return od(e,r,n,t.length)}))},t.prototype._isObject=function(e,t){return this.addValidation((function(){return Wl(e)}),(function(){return ed(e,t)}))},t.prototype.item=function(e,t,r){return this._isObject(e,t).addValidation((function(){return void 0!==e._id?Hl(e._id):!r}),(function(){return nd()}))},t.prototype.items=function(e,t){return this.addValidation((function(){return ql(e)&&e.every((function(e){return Wl(e)&&(void 0===e._id||null===e._id||Hl(e._id))}))}),(function(){return td(t)})).addValidation((function(){return e.length<=1e3}),(function(){return rd(t)}))},t.prototype.fieldName=function(e){return this.addValidation((function(){return Hl(e)}),(function(){return Zl()}))},t.prototype.itemId=function(e){return this.addValidation((function(){return Hl(e)}),(function(){return Jl()}))},t.prototype.itemIds=function(e,t){return this.addValidation((function(){return ql(e)&&e.every((function(e){return Hl(e)}))}),(function(){return Kl()})).addValidation((function(){return e.length<=1e3}),(function(){return Ql(t)}))},t.prototype._options=function(e,t){return this.addValidation((function(){var r=Wl(e)&&t.every((function(t){return"language"===t?null==(r=e[t])||Hl(r)&&r.length>0:function(e){return null==e||(t=e,"boolean"===Vl()(t));var t}(e[t]);var r}));return null==e||r}),(function(){return ad(t)}))},t.prototype.referenceRemoveParameters=function(e){return this.addValidation((function(){return ql(e)&&e.every(Id)}),id)},t.prototype.referenceParameters=function(e){return this.addValidation((function(){return ql(e)&&e.every(_d)}),id)},t.prototype.referenceParameter=function(e){return this.addValidation((function(){return _d(e)}),id)},t.prototype.isNonEmptyString=function(e,t){return this.addValidation((function(){return"string"==typeof e&&e.length>0}),(function(){return dd.isNonEmptyString(t)}))},t.prototype.references=function(e){return this.addValidation((function(){return ql(e)&&e.every((function(e){return Hl(e.relationshipName)&&_d(e.left)&&_d(e.right)}))}),sd)},t.prototype.options=function(e){return this._options(e,["suppressAuth","suppressHooks","showDrafts","consistentRead","language"])},t.prototype.bulkInsertOptions=function(e){return this._options(e,["suppressAuth","suppressHooks","overrideExisting"])},t.prototype.bulkUpdateOptions=function(e){return this._options(e,["suppressAuth","suppressHooks","showDrafts"])},t.prototype.bulkRemoveOptions=function(e){return this._options(e,["suppressAuth","suppressHooks","showDrafts"])},t.prototype.truncateOptions=function(e){return this._options(e,["suppressAuth"])},t.prototype.collectionName=function(e){return this.addValidation((function(){return Hl(e)}),(function(){return Xl()}))}}(vd);function _d(e){return Hl(e)&&""!==e||Wl(e)&&e.hasOwnProperty("_id")}function Id(e){return Hl(e)||Wl(e)&&e.hasOwnProperty("_id")}var Ed=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function Td(e){return function(e,t){return Promise.reject(fd(e,t))}(ld(e),pd.CollectionDeleted)}var Sd,Rd,wd,Od,bd,Cd,Pd,Nd,Dd,Ad,xd,Ld,Fd,Md,Ud,kd=function(e){function t(t,r){var n=e.call(this,t)||this;return Object.setPrototypeOf(n,r.prototype),n.name=r.name,Error.captureStackTrace?Error.captureStackTrace(n,r):n.stack=new Error(t).stack,n}return Ed(t,e),t}(Error),Gd=function(e){function t(r){var n=e.call(this,r,t)||this;return n.reason=r,n.message=r,n}return Ed(t,e),t}(kd),jd=function(e){function t(r,n,o,a){var i=e.call(this,o,t)||this;return i.status=r,i.responseText=n,i.requestId=a,i}return Ed(t,e),t}(kd);function Bd(e){return Object.keys(e).reduce((function(t,r){return void 0!==e[r]&&(t[r]=e[r]),t}),{})}function Vd(e){for(var t={},r=0,n=Object.keys(e);r<n.length;r++){var o=n[r],a=e[o];void 0!==a&&(t[a]=o)}return t}function Wd(e,t){return null==e?void 0:t(e)}!function(e){e.NATIVE="NATIVE",e.WIX_APP="WIX_APP",e.BLOCKS_APP="BLOCKS_APP",e.EXTERNAL="EXTERNAL"}(Sd||(Sd={})),function(e){e.ASC="ASC",e.DESC="DESC"}(Rd||(Rd={})),function(e){e.AGGREGATE="AGGREGATE",e.BULK_INSERT="BULK_INSERT",e.BULK_REMOVE="BULK_REMOVE",e.BULK_SAVE="BULK_SAVE",e.BULK_UPDATE="BULK_UPDATE",e.COUNT="COUNT",e.DISTINCT="DISTINCT",e.FIND="FIND",e.GET="GET",e.INSERT="INSERT",e.INSERT_REFERENCE="INSERT_REFERENCE",e.IS_REFERENCED="IS_REFERENCED",e.QUERY_REFERENCED="QUERY_REFERENCED",e.REMOVE="REMOVE",e.REMOVE_REFERENCE="REMOVE_REFERENCE",e.REPLACE_REFERENCES="REPLACE_REFERENCES",e.SAVE="SAVE",e.TRUNCATE="TRUNCATE",e.UPDATE="UPDATE"}(wd||(wd={})),function(e){e.UPDATE="UPDATE",e.REMOVE="REMOVE"}(Od||(Od={})),function(e){e.UNKNOWN_FIELD_TYPE="UNKNOWN_FIELD_TYPE",e.TEXT="TEXT",e.NUMBER="NUMBER",e.DATE="DATE",e.DATETIME="DATETIME",e.IMAGE="IMAGE",e.BOOLEAN="BOOLEAN",e.DOCUMENT="DOCUMENT",e.URL="URL",e.RICH_TEXT="RICH_TEXT",e.VIDEO="VIDEO",e.ANY="ANY",e.ARRAY_STRING="ARRAY_STRING",e.ARRAY_DOCUMENT="ARRAY_DOCUMENT",e.AUDIO="AUDIO",e.TIME="TIME",e.LANGUAGE="LANGUAGE",e.RICH_CONTENT="RICH_CONTENT",e.MEDIA_GALLERY="MEDIA_GALLERY",e.ADDRESS="ADDRESS",e.PAGE_LINK="PAGE_LINK",e.REFERENCE="REFERENCE",e.MULTI_REFERENCE="MULTI_REFERENCE",e.OBJECT="OBJECT",e.ARRAY="ARRAY",e.LEGACY_TIME="LEGACY_TIME",e.LEGACY_BOOK="LEGACY_BOOK",e.LEGACY_EXTERNAL_URL="LEGACY_EXTERNAL_URL",e.LEGACY_BROKEN_REFERENCE="LEGACY_BROKEN_REFERENCE",e.LEGACY_IMAGE="LEGACY_IMAGE",e.LEGACY_COLOR="LEGACY_COLOR",e.LEGACY_EXTERNAL_VIDEO="LEGACY_EXTERNAL_VIDEO"}(bd||(bd={})),function(e){e.EQ="EQ",e.LT="LT",e.GT="GT",e.NE="NE",e.LTE="LTE",e.GTE="GTE",e.STARTS_WITH="STARTS_WITH",e.ENDS_WITH="ENDS_WITH",e.CONTAINS="CONTAINS",e.HAS_SOME="HAS_SOME",e.HAS_ALL="HAS_ALL",e.EXISTS="EXISTS",e.URLIZED="URLIZED"}(Cd||(Cd={})),function(e){e.UNKNOWN="UNKNOWN",e.CMS="CMS"}(Pd||(Pd={})),function(e){e.UNKNOWN_ROLE="UNKNOWN_ROLE",e.ADMIN="ADMIN",e.SITE_MEMBER_AUTHOR="SITE_MEMBER_AUTHOR",e.SITE_MEMBER="SITE_MEMBER",e.ANYONE="ANYONE"}(Nd||(Nd={})),function(e){e.UNKNOWN_PUBLISH_PLUGIN_STATUS="UNKNOWN_PUBLISH_PLUGIN_STATUS",e.PUBLISHED="PUBLISHED",e.DRAFT="DRAFT"}(Dd||(Dd={})),function(e){e.UNKNOWN_URLIZED_PLUGIN_FORMAT="UNKNOWN_URLIZED_PLUGIN_FORMAT",e.ORIGINAL="ORIGINAL",e.PLAIN="PLAIN"}(Ad||(Ad={})),function(e){e.UNKNOWN_PLUGIN_TYPE="UNKNOWN_PLUGIN_TYPE",e.PUBLISH="PUBLISH",e.SINGLE_ITEM="SINGLE_ITEM",e.URLIZED="URLIZED",e.GRIDAPPLESS="GRIDAPPLESS",e.MULTILINGUAL="MULTILINGUAL",e.SHARED="SHARED",e.EDITABLE_PAGE_LINK="EDITABLE_PAGE_LINK",e.CMS="CMS"}(xd||(xd={})),function(e){e.OFFSET="OFFSET",e.CURSOR="CURSOR"}(Ld||(Ld={})),function(e){e.ASC="ASC",e.DESC="DESC"}(Fd||(Fd={})),function(e){e.ASC="ASC",e.DESC="DESC"}(Md||(Md={})),function(e){e.UNKNOWN="UNKNOWN",e.BUILDING="BUILDING",e.ACTIVE="ACTIVE",e.DROPPING="DROPPING",e.DROPPED="DROPPED",e.FAILED="FAILED",e.INVALID="INVALID"}(Ud||(Ud={}));var qd,Hd=function(){return Hd=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Hd.apply(this,arguments)},$d={ADMIN:l.PermissionRole.admin,SITE_MEMBER_AUTHOR:l.PermissionRole.siteMemberAuthor,SITE_MEMBER:l.PermissionRole.siteMember,ANYONE:l.PermissionRole.anyone,UNKNOWN_ROLE:void 0},zd=Vd($d),Yd={TEXT:l.FieldType.text,NUMBER:l.FieldType.number,DATE:l.FieldType.date,DATETIME:l.FieldType.dateTime,IMAGE:l.FieldType.image,BOOLEAN:l.FieldType.boolean,DOCUMENT:l.FieldType.document,URL:l.FieldType.url,RICH_TEXT:l.FieldType.richText,VIDEO:l.FieldType.video,ANY:l.FieldType.any,ARRAY_STRING:l.FieldType.stringArray,ARRAY_DOCUMENT:l.FieldType.documentArray,AUDIO:l.FieldType.audio,TIME:l.FieldType.time,LANGUAGE:l.FieldType.language,RICH_CONTENT:l.FieldType.richContent,MEDIA_GALLERY:l.FieldType.mediaGallery,ADDRESS:l.FieldType.address,PAGE_LINK:l.FieldType.pageLink,REFERENCE:l.FieldType.reference,MULTI_REFERENCE:l.FieldType.multiReference,OBJECT:l.FieldType.object,ARRAY:l.FieldType.array,LEGACY_TIME:l.FieldType.time,LEGACY_BOOK:l.FieldType.legacyBook,LEGACY_EXTERNAL_URL:l.FieldType.legacyExternalUrl,LEGACY_BROKEN_REFERENCE:l.FieldType.legacyBrokenRef,LEGACY_IMAGE:l.FieldType.legacyImage,LEGACY_COLOR:l.FieldType.color,LEGACY_EXTERNAL_VIDEO:l.FieldType.legacyExternalVideo,UNKNOWN_FIELD_TYPE:void 0},Xd=Hd(Hd({},Vd(Yd)),((qd={})[l.FieldType.time]=bd.TIME,qd)),Jd=[{v1Type:l.MULTILINGUAL_PLUGIN_ID,v2Type:xd.MULTILINGUAL,toV2:function(e){return{multilingualOptions:{translatableFieldKeys:e.translatable}}},toV1:function(e){var t,r;return{translatable:null!==(r=null===(t=e.multilingualOptions)||void 0===t?void 0:t.translatableFieldKeys)&&void 0!==r?r:[]}}},{v1Type:l.PUBLISHING_PLUGIN_ID,v2Type:xd.PUBLISH,toV2:function(e){return{publishOptions:{defaultStatus:e.defaultStatus}}},toV1:function(e){var t;return{defaultStatus:null===(t=e.publishOptions)||void 0===t?void 0:t.defaultStatus}}},{v1Type:l.SINGLES_PLUGIN_ID,v2Type:xd.SINGLE_ITEM,toV2:function(e){return{singleItemOptions:{singleItemId:e.singleItemId}}},toV1:function(e){var t,r;return{singleItemId:null!==(r=null===(t=e.singleItemOptions)||void 0===t?void 0:t.singleItemId)&&void 0!==r?r:"SINGLE_ITEM_ID"}}},{v1Type:l.URLIZED_PLUGIN_ID,v2Type:xd.URLIZED,toV2:function(e){return{urlizedOptions:{format:e.format.toUpperCase()}}},toV1:function(e){var t;return{format:(null===(t=e.urlizedOptions)||void 0===t?void 0:t.format)===Ad.ORIGINAL?l.UrlizedFormat.ORIGINAL:l.UrlizedFormat.PLAIN}}},{v1Type:l.GRID_APPLESS_PLUGIN_ID,v2Type:xd.GRIDAPPLESS,toV2:function(e){return{gridapplessOptions:{migrated:e.isMigrated}}},toV1:function(e){var t,r;return{isMigrated:null!==(r=null===(t=e.gridapplessOptions)||void 0===t?void 0:t.migrated)&&void 0!==r&&r}}},{v1Type:l.SHARED_PLUGIN_ID,v2Type:xd.SHARED,toV2:function(e){return{}},toV1:function(e){return{}}},{v1Type:l.PAGE_LINK_PLUGIN_ID,v2Type:xd.EDITABLE_PAGE_LINK,toV2:function(e){return{editablePageLinkOptions:{isPersisted:e.isPersisted,isMutable:e.isUpdatable}}},toV1:function(e){var t,r,n,o;return{isPersisted:null!==(r=null===(t=e.editablePageLinkOptions)||void 0===t?void 0:t.isPersisted)&&void 0!==r&&r,isUpdatable:null!==(o=null===(n=e.editablePageLinkOptions)||void 0===n?void 0:n.isMutable)&&void 0!==o&&o}}},{v1Type:l.CMS_PLUGIN_ID,v2Type:xd.CMS,toV1:function(e){var t,r;return Hd(Hd({},null!==(t=e.cmsOptions)&&void 0!==t?t:{}),{siteSort:Wd(null===(r=e.cmsOptions)||void 0===r?void 0:r.siteSort,(function(e){var t;return{sort:(null!==(t=e.sort)&&void 0!==t?t:[]).map((function(e){var t;return{fieldName:e.fieldKey,direction:null===(t=e.direction)||void 0===t?void 0:t.toLowerCase()}}))}}))})},toV2:function(e){return{cmsOptions:Hd(Hd({},e),{siteSort:Wd(e.siteSort,(function(e){return{sort:e.sort.map((function(e){var t;return{fieldKey:e.fieldName,direction:null===(t=e.direction)||void 0===t?void 0:t.toUpperCase()}}))}}))})}}}];var Kd,Qd,Zd=[{v1Type:l.CMS_FIELD_PLUGIN_ID,v2Type:Pd.CMS,toV1:function(e){var t,r;return{internal:null!==(r=null===(t=e.cmsOptions)||void 0===t?void 0:t.internal)&&void 0!==r&&r}},toV2:function(e){return{cmsOptions:{internal:e.internal}}}}];function eu(e){for(var t={},r=function(e){var r=Zd.find((function(t){return t.v2Type===e.type}));void 0!==r?t[r.v1Type]=r.toV1(e):t[e.type]=e},n=0,o=e;n<o.length;n++){r(o[n])}return t}function tu(e){for(var t=[],r=function(e,r){var n=Zd.find((function(t){return t.v1Type===e}));void 0!==n?t.push(Hd({type:n.v2Type},n.toV2(r))):t.push(r)},n=0,o=Object.entries(e);n<o.length;n++){var a=o[n];r(a[0],a[1])}return t}function ru(e){if(e.permissions)return{insert:zd[e.permissions.insert],update:zd[e.permissions.update],remove:zd[e.permissions.remove],read:zd[e.permissions.read]}}function nu(e){return Object.entries(e.fields||{}).filter((function(e){e[0];return!e[1].isDeleted})).sort((function(e,t){var r,n,o=null!==(r=e[1].index)&&void 0!==r?r:0,a=null!==(n=t[1].index)&&void 0!==n?n:0;return o>a?1:o<a||null!=o&&null==a?-1:null==o&&null!=a?1:0})).map((function(e){return function(e,t){function r(e){return Object.values(e).some((function(e){return void 0!==e}))?e:void 0}return Bd({key:e,displayName:t.displayName,type:Xd[t.type],typeMetadata:ou(t),encrypted:t.pii,description:t.description,plugin:t.plugin,stringLengthRange:r({minLength:t.minStrLength,maxLength:t.maxStrLength}),arraySizeRange:r({minSize:t.minArraySize,maxSize:t.maxArraySize}),readOnly:t.readOnly,numberRange:r({min:t.minValue,max:t.maxValue}),immutable:t.immutable,required:t.required,plugins:Wd(t.plugins,tu)})}(e[0],e[1])}))}function ou(e){switch(e.type){case"pagelink":return function(e){return null==e.calculator||null==e.calculator.config?void 0:{pageLink:{linkedRouterPage:e.linkedRouterPage,calculator:Bd({fieldsPattern:Bd({pattern:e.calculator.config.pattern,lowercase:e.calculator.config.lowercase}),urlizedOnlyPattern:Bd({pattern:e.calculator.config.pattern})})}}}(e);case"reference":return function(e){return{reference:{referencedCollectionId:e.referencedCollection}}}(e);case"multi-reference":return function(e){return{multiReference:{referencedCollectionId:e.referencedCollection,referencingFieldKey:e.referencingFieldKey,referencingDisplayName:e.referencingDisplayName}}}(e);case"object":return function(e){return null==e.fields?void 0:{object:{fields:Object.entries(e.fields).map((function(e){return function(e,t){return Bd({key:e,displayName:t.displayName,type:Xd[t.type],typeMetadata:ou(t)})}(e[0],e[1])}))}}}(e);case"array":return function(e){return null==e.elementType?void 0:{array:Bd({elementType:Xd[e.elementType.type],typeMetadata:ou(e.elementType)})}}(e)}}function au(e){var t;return function(e){for(var t=[],r=function(e,r){var n=Jd.find((function(t){return t.v1Type===e}));void 0!==n?t.push(Hd({type:n.v2Type},n.toV2(r))):t.push(r)},n=0,o=Object.entries(e);n<o.length;n++){var a=o[n];r(a[0],a[1])}return t}(null!==(t=e.plugins)&&void 0!==t?t:{})}var iu=((Kd={})[Ld.OFFSET]=l.PagingMode.Offset,Kd[Ld.CURSOR]=l.PagingMode.Cursor,Kd),su=((Qd={})[Sd.NATIVE]=l.Storage.docstore,Qd[Sd.WIX_APP]=l.Storage.driver,Qd[Sd.BLOCKS_APP]=l.Storage.staticAppSchema,Qd[Sd.EXTERNAL]=l.Storage.external,Qd),cu={IS_REFERENCED:l.DataOperation.isReferenced,INSERT:l.DataOperation.insert,SAVE:l.DataOperation.save,BULK_INSERT:l.DataOperation.bulkInsert,BULK_UPDATE:l.DataOperation.bulkUpdate,UPDATE:l.DataOperation.update,TRUNCATE:l.DataOperation.truncate,REMOVE:l.DataOperation.remove,REMOVE_REFERENCE:l.DataOperation.removeReference,COUNT:l.DataOperation.count,FIND:l.DataOperation.find,REPLACE_REFERENCES:l.DataOperation.replaceReferences,BULK_REMOVE:l.DataOperation.bulkRemove,INSERT_REFERENCE:l.DataOperation.insertReference,GET:l.DataOperation.get,BULK_SAVE:l.DataOperation.bulkSave,QUERY_REFERENCED:l.DataOperation.queryReferenced,DISTINCT:l.DataOperation.distinct,AGGREGATE:l.DataOperation.aggregate},lu={UPDATE:l.CollectionOperation.UPDATE,REMOVE:l.CollectionOperation.REMOVE},du={EQ:l.AllowedFilterOperator.eq,LT:l.AllowedFilterOperator.lt,GT:l.AllowedFilterOperator.gt,NE:l.AllowedFilterOperator.ne,LTE:l.AllowedFilterOperator.lte,GTE:l.AllowedFilterOperator.gte,STARTS_WITH:l.AllowedFilterOperator.startsWith,ENDS_WITH:l.AllowedFilterOperator.endsWith,CONTAINS:l.AllowedFilterOperator.contains,HAS_SOME:l.AllowedFilterOperator.hasSome,HAS_ALL:l.AllowedFilterOperator.hasAll,EXISTS:l.AllowedFilterOperator.exists,URLIZED:l.AllowedFilterOperator.urlized};function uu(e){var t,r,n,o=e;return Bd({id:o.id,isDeleted:!1,namespace:Ru(o.id),storage:su[o.collectionType],ownerAppId:o.ownerAppId||null,displayNamespace:o.displayNamespace||null,displayField:o.displayField,allowedOperations:hu(o),collectionOperations:mu(o),fields:vu(o),displayName:null!==(t=o.displayName)&&void 0!==t?t:o.id,permissions:fu(o),maxPageSize:null!==(r=o.maxPageSize)&&void 0!==r?r:void 0,defaultSort:gu(o.defaultDisplayOrder),version:pu(o.revision),plugins:yu(o.plugins),pagingMode:null===(n=o.pagingModes)||void 0===n?void 0:n.map((function(e){return iu[e]})),translatable:!1,ttl:null,capabilities:Ou(o)})}function pu(e){var t=parseInt(null!=e?e:"0",10);return isNaN(t)?0:t}function fu(e){if(e.permissions){var t=e.permissions;return{read:$d[t.read],insert:$d[t.insert],remove:$d[t.remove],update:$d[t.update]}}}function hu(e){var t,r=null===(t=null==e?void 0:e.capabilities)||void 0===t?void 0:t.dataOperations;return null==r?void 0:r.map((function(e){return cu[e]}))}function mu(e){var t,r=null===(t=null==e?void 0:e.capabilities)||void 0===t?void 0:t.collectionOperations;return null==r?void 0:r.map((function(e){return lu[e]}))}function gu(e){return e?{direction:e.direction===Rd.DESC?l.Direction.desc:l.Direction.asc,fieldName:e.fieldKey}:null}function yu(e){if(e)return function(e){for(var t={},r=function(e){var r=Jd.find((function(t){return t.v2Type===e.type}));void 0!==r?t[r.v1Type]=r.toV1(e):t[e.type]=e},n=0,o=e;n<o.length;n++)r(o[n]);return t}(e)}function vu(e){return e.fields?e.fields.reduce((function(e,t,r){var n;return Object.assign({},e,((n={})[t.key]=function(e,t){var r,n,o,a,i,s,c,l,d,u,p,f,h,m,g,y,v,_,I,E,T,S,R,w,O,b,C,P=e;return Bd({displayName:null!==(r=P.displayName)&&void 0!==r?r:P.key,systemField:null!==(n=P.systemField)&&void 0!==n&&n,sortable:null===(o=null==P?void 0:P.capabilities)||void 0===o?void 0:o.sortable,isDeleted:!1,index:t,queryOperators:Tu(P),plugin:null!==(a=null==P?void 0:P.plugin)&&void 0!==a?a:void 0,calculator:Su(P),pii:!!P.encrypted||void 0,linkedRouterPage:null!==(c=null===(s=null===(i=null==P?void 0:P.typeMetadata)||void 0===i?void 0:i.pageLink)||void 0===s?void 0:s.linkedRouterPage)&&void 0!==c?c:void 0,description:null!==(l=P.description)&&void 0!==l?l:void 0,readOnly:null!==(d=P.readOnly)&&void 0!==d?d:void 0,immutable:null!==(u=P.immutable)&&void 0!==u?u:void 0,required:null!==(p=P.required)&&void 0!==p?p:void 0,minValue:null!==(h=null===(f=null==P?void 0:P.numberRange)||void 0===f?void 0:f.min)&&void 0!==h?h:void 0,maxValue:null!==(g=null===(m=null==P?void 0:P.numberRange)||void 0===m?void 0:m.max)&&void 0!==g?g:void 0,minStrLength:null!==(v=null===(y=null==P?void 0:P.stringLengthRange)||void 0===y?void 0:y.minLength)&&void 0!==v?v:void 0,maxStrLength:null!==(I=null===(_=null==P?void 0:P.stringLengthRange)||void 0===_?void 0:_.maxLength)&&void 0!==I?I:void 0,minArraySize:null!==(T=null===(E=null==P?void 0:P.arraySizeRange)||void 0===E?void 0:E.minSize)&&void 0!==T?T:void 0,maxArraySize:null!==(R=null===(S=null==P?void 0:P.arraySizeRange)||void 0===S?void 0:S.maxSize)&&void 0!==R?R:void 0,type:Yd[P.type],referencedCollection:wu(P.typeMetadata),referencingFieldKey:null===(O=null===(w=P.typeMetadata)||void 0===w?void 0:w.multiReference)||void 0===O?void 0:O.referencingFieldKey,referencingDisplayName:null===(C=null===(b=P.typeMetadata)||void 0===b?void 0:b.multiReference)||void 0===C?void 0:C.referencingDisplayName,fields:Iu(P.typeMetadata),elementType:Eu(P.typeMetadata),plugins:Wd(P.plugins,eu)})}(t,r),n))}),{}):{}}function _u(e,t){return{type:Yd[e],fields:Iu(t),elementType:Eu(t)}}function Iu(e){var t,r=null==e?void 0:e.object;if(r)return null===(t=r.fields)||void 0===t?void 0:t.reduce((function(e,t){var r;return Object.assign(e,((r={})[t.key]=function(e){var t;return Bd(Object.assign({displayName:e.displayName,sortable:null===(t=null==e?void 0:e.capabilities)||void 0===t?void 0:t.sortable,queryOperators:Tu(e)},_u(e.type,e.typeMetadata)))}(t),r))}),{})}function Eu(e){var t=null==e?void 0:e.array;if(t)return Bd(_u(t.elementType,t.typeMetadata))}function Tu(e){var t,r=null===(t=null==e?void 0:e.capabilities)||void 0===t?void 0:t.queryOperators;return r?r.length>=Object.keys(du).length?void 0:r.map((function(e){return du[e]})):[]}function Su(e){var t,r,n,o,a,i,s,c,l,d,u=null===(t=e.typeMetadata)||void 0===t?void 0:t.pageLink;return u?{config:{lowercase:null!==(o=null===(n=null===(r=u.calculator)||void 0===r?void 0:r.fieldsPattern)||void 0===n?void 0:n.lowercase)&&void 0!==o&&o,pattern:null!==(d=null!==(s=null===(i=null===(a=u.calculator)||void 0===a?void 0:a.fieldsPattern)||void 0===i?void 0:i.pattern)&&void 0!==s?s:null===(l=null===(c=u.calculator)||void 0===c?void 0:c.urlizedOnlyPattern)||void 0===l?void 0:l.pattern)&&void 0!==d?d:"unknown"}}:void 0}function Ru(e){if(!e)return null;var t=e.lastIndexOf("/");return-1===t?null:e.substring(0,t)}function wu(e){var t,r,n;return null!==(r=null===(t=null==e?void 0:e.multiReference)||void 0===t?void 0:t.referencedCollectionId)&&void 0!==r?r:null===(n=null==e?void 0:e.reference)||void 0===n?void 0:n.referencedCollectionId}function Ou(e){var t,r=null===(t=null==e?void 0:e.capabilities)||void 0===t?void 0:t.indexLimits;if(r)return{indexing:{regular:r.regular,unique:r.unique,total:r.total}}}var bu=function(){return bu=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},bu.apply(this,arguments)},Cu=function(e,t,r,n){return new(r||(r=Promise))((function(o,a){function i(e){try{c(n.next(e))}catch(e){a(e)}}function s(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,s)}c((n=n.apply(e,t||[])).next())}))},Pu=function(e,t){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Nu=function(){function e(e){this.transport=e}return e.prototype.get=function(e,t){var r,n,o;return Cu(this,void 0,void 0,(function(){var a;return Pu(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,Au(this.transport.get({dataCollectionId:e,consistentRead:null==t?void 0:t.consistentRead}))];case 1:return[2,uu(i.sent().collection)];case 2:if(a=i.sent(),"WDE0025"===(null===(o=null===(n=null===(r=null==a?void 0:a.responseText)||void 0===r?void 0:r.details)||void 0===n?void 0:n.applicationError)||void 0===o?void 0:o.code))throw md(e);throw a;case 3:return[2]}}))}))},e.prototype.bulkGet=function(e,t){return void 0===t&&(t={referencedCollectionsDepth:0}),Cu(this,void 0,void 0,(function(){var r=this;return Pu(this,(function(n){switch(n.label){case 0:return[4,Fu(e,100,(function(e){return Cu(r,void 0,void 0,(function(){var r,n,o,a,i;return Pu(this,(function(s){switch(s.label){case 0:return r={dataCollectionIds:e,includeReferencedCollections:(null!==(i=t.referencedCollectionsDepth)&&void 0!==i?i:0)>0,showDeletedCollections:t.includeDeletedCollections,consistentRead:null==t?void 0:t.consistentRead},[4,Au(this.transport.getBulk(r))];case 1:return n=s.sent(),o=(n.activeCollections||[]).map(uu),(a=(n.deletedCollections||[]).map(uu)).forEach((function(e){return e.isDeleted=!0})),[2,o.concat(a)]}}))}))}))];case 1:return[2,xu(n.sent())]}}))}))},e.prototype.listCollections=function(e){var t,r,n,o;return Cu(this,void 0,void 0,(function(){var a,i,s,c,l,d;return Pu(this,(function(u){switch(u.label){case 0:a=[],i={offset:0},u.label=1;case 1:return[4,Au(this.transport.list({paging:i,consistentRead:null==e?void 0:e.consistentRead}))];case 2:return s=u.sent(),a=a.concat(null!==(t=s.collections)&&void 0!==t?t:[]),c=s.pagingMetadata,l=(null!==(r=null==c?void 0:c.offset)&&void 0!==r?r:0)+(null!==(n=null==c?void 0:c.count)&&void 0!==n?n:0),d=null!==(o=null==c?void 0:c.total)&&void 0!==o?o:0,l<d?(i.offset=l,[3,1]):[2,a];case 3:return[2]}}))}))},e.prototype.list=function(e){return Cu(this,void 0,void 0,(function(){return Pu(this,(function(t){switch(t.label){case 0:return[4,this.listCollections(e)];case 1:return[2,xu(t.sent().map(uu))]}}))}))},e.prototype.save=function(e,t){return Cu(this,void 0,void 0,(function(){var r;return Pu(this,(function(n){switch(n.label){case 0:return r=function(e){var t;return Bd({id:e.id,displayName:e.displayName,displayField:e.displayField,fields:nu(e),permissions:ru(e),revision:null===(t=e.version)||void 0===t?void 0:t.toString(),plugins:au(e)})}(t),r.id=e||r.id,[4,Au(t.version>0?this.transport.update({collection:r}):this.transport.create({collection:r}))];case 1:return[2,[uu(n.sent().collection)]]}}))}))},e.prototype.remove=function(e){return Cu(this,void 0,void 0,(function(){return Pu(this,(function(t){switch(t.label){case 0:return[4,Au(this.transport.delete({dataCollectionId:e}))];case 1:return t.sent(),[2,[{id:e,isDeleted:!0}]]}}))}))},e.prototype.restore=function(){return Promise.reject(new Error("Collection restoring is not supported."))},e}();const Du=Nu;function Au(e){return e.catch((function(e){if(!e.response)return Promise.reject(new Gd(Lu(e)));var t=e.response,r=t.headers&&t.headers["x-wix-request-id"];return Promise.reject(new jd(t.status,t.data,Lu(t.data),r))}))}function xu(e){return e.reduce((function(e,t){var r;return bu(bu({},e),((r={})[t.id]=t,r))}),{})}function Lu(e){return"object"==typeof e&&e.message?e.message:"string"==typeof e?e:JSON.stringify(e)}function Fu(e,t,r){return Cu(this,void 0,void 0,(function(){var n,o;return Pu(this,(function(a){switch(a.label){case 0:for(n=[],o=0;o<e.length;o+=t)n.push(r(e.slice(o,o+t)));return[4,Promise.all(n)];case 1:return[2,a.sent().reduce((function(e,t){return e.concat(t)}),[])]}}))}))}const Mu=e=>e.split("#");const Uu="_",ku=/{(.*)}/,Gu=new RegExp(`\\.(${["wix.com","editorx.com"].join("|")})$`),ju=new RegExp(`\\.(${["42.wixprod.net","uw2-edt-1.wixprod.net"].join("|")})$`),Bu=new RegExp(".*\\.dev.wix-code.com$");function Vu(e){const t=function(e,t){const r=t[e]||t[Uu];if(!r&&function(e){return!!e.match(/\._base_domain_$/)}(e))return t[Wu];return r}(function(e){return e.replace("create.editorx.com","editor.editorx.com")}(e.host).replace(Gu,"._base_domain_").replace(ju,"._api_base_domain_").replace(Bu,"*.dev.wix-code.com"),e.domainToMappings);var r,n;return function(e,t){const r=null==t?void 0:t.find((t=>e.startsWith(t.destPath)));if(!r)return e;return r.srcPath+e.slice(r.destPath.length)}((r=e.protoPath,n=e.data||{},r.split("/").map((e=>function(e,t){const r=e.match(ku)||[],n=r[1];if(n){const o=e.replace(r[0],"");return function(e,t,r,n){let o=e;for(const e of t.split(".")){if(!o)return r;o=o[e]}return`${o}${n}`}(t,n,e,o)}return e}(e,n))).join("/")),t)}const Wu="www._base_domain_";function qu(e,t=""){const r={};return Object.entries(e).forEach((([e,n])=>{const o=null!==n&&"object"==typeof n&&!Array.isArray(n),a=function(e,t){return`${e}${e?".":""}${t}`}(t,e);if(o){const e=qu(n,a);Object.assign(r,e)}else r[a]=n})),r}function Hu(e){const t=qu(e);return Object.entries(t).reduce(((e,[t,r])=>((Array.isArray(r)?r:[r]).forEach((r=>{null!=r&&e.append(t,r)})),e)),new URLSearchParams)}var $u;function zu(e,t={},r){return function(n={},o){return"string"==typeof n?n:a(e,n);function a(e,t){const r={};return[null,void 0].includes(t)?t:(Object.entries(t).forEach((([t,n])=>{var o,a,c;const l=e[t],{schemaName:d,schemaType:u}=function(e=""){const[t,r]=Mu(e);return r?{schemaName:r,schemaType:t}:{schemaName:t}}(l),p="Map"===u;let f;f=(null!==(c=null===(a=null===(o=s(d))||void 0===o?void 0:o.checkRepetable)||void 0===a?void 0:a.call(o,n))&&void 0!==c?c:Array.isArray(n))?n.map((e=>i(e,d))):p?function(e,t){return Object.entries(e).reduce(((e,[r,n])=>(e[r]=i(n,t),e)),{})}(n,d):i(n,d),r[t]=f})),r)}function i(e,r){if(!r)return e;const n=t[r];if(s(r))return s(r).transform(e);if(n)return a(n,e);throw new Error(`${r} is neither schema nor serializable type`)}function s(e){var t;return null===(t=r[e])||void 0===t?void 0:t[o]}}}!function(e){e[e.TO_JSON=0]="TO_JSON",e[e.FROM_JSON=1]="FROM_JSON"}($u||($u={}));const Yu={types:["google.protobuf.Timestamp"],[$u.TO_JSON]:{transform:e=>null==e?void 0:e.toISOString()},[$u.FROM_JSON]:{transform:e=>e?new Date(e):void 0}},Xu={types:["google.protobuf.FieldMask"],[$u.TO_JSON]:{transform:e=>e.join(","),checkRepetable:e=>e.some((e=>Array.isArray(e)))},[$u.FROM_JSON]:{transform:e=>"object"==typeof e?e.paths:e.split(",")}},Ju={types:["google.protobuf.BytesValue","BYTES"],[$u.TO_JSON]:{transform:e=>{const t=e.reduce(((e,t)=>e+String.fromCharCode(t)),"");return btoa(t)}},[$u.FROM_JSON]:{transform:e=>Uint8Array.from(atob(e),(e=>e.charCodeAt(0)))}},Ku={types:["google.protobuf.Duration"],[$u.TO_JSON]:{transform:({seconds:e="0",nanos:t=0})=>{let r="";return 0!==t&&(r=`.${t.toString().padStart(9,"0")}`),`${e}${r}s`}},[$u.FROM_JSON]:{transform:e=>{const[t,r]=e.substring(0,e.length-1).split(".");return{seconds:t,nanos:Qu(r)}}}};function Qu(e){let t=0;if(void 0!==e){const r=3-e.length/3;t=parseInt(e,10)*Math.pow(1e3,r)}return t}const Zu={types:["FLOAT","DOUBLE","google.protobuf.FloatValue","google.protobuf.DoubleValue"],[$u.TO_JSON]:{transform:e=>isFinite(e)?e:e.toString()},[$u.FROM_JSON]:{transform:e=>"NaN"===e?NaN:"Infinity"===e?1/0:"-Infinity"===e?-1/0:e}};const ep=[...[Yu,Xu,Ju,Ku,Zu]].reduce(((e,t)=>{const r=t.types.reduce(((e,r)=>Object.assign(Object.assign({},e),{[r]:t})),{});return Object.assign(Object.assign({},e),r)}),{});function tp(e,t={}){const r=zu(e,t,ep);return{fromJSON(e){const t=function(e){try{return JSON.parse(e)}catch(e){}}(e)||e;return r(t,$u.FROM_JSON)},toJSON:e=>r(e,$u.TO_JSON)}}var rp={typeMetadata:"_typeMetadata"},np={},op={activeCollections:"_dataCollection",deletedCollections:"_dataCollection"},ap={collection:"_dataCollection"},ip={collection:"_dataCollection"},sp={createdDate:"google.protobuf.Timestamp",updatedDate:"google.protobuf.Timestamp",fields:"_field"},cp={},lp={},dp={numberRange:"_numberRange",typeMetadata:"_typeMetadata"},up={},pp={collection:"_dataCollection",referencedCollections:"_dataCollection"},fp={},hp={collections:"_dataCollection"},mp={min:"google.protobuf.DoubleValue",max:"google.protobuf.DoubleValue"},gp={fields:"_objectField"},yp={typeMetadata:"_typeMetadata"},vp={object:"_object",array:"_array"},_p={collection:"_dataCollection"},Ip={collection:"_dataCollection"};function Ep(e){return Vu(Object.assign(e,{domainToMappings:{"api._api_base_domain_":[{srcPath:"/cloud-data",destPath:""}],"code._base_domain_":[{srcPath:"/_api/cloud-data/v1/data-settings",destPath:"/v1/data-settings"},{srcPath:"/_api/cloud-data/v1/schemas",destPath:"/v1/schemas"},{srcPath:"/_api/cloud-data/v1/connector",destPath:"/v1/connector"},{srcPath:"/_api/data/v1/data-settings",destPath:"/v1/data-settings"},{srcPath:"/_api/data/v1/schemas",destPath:"/v1/schemas"},{srcPath:"/_api/data/v1/connector",destPath:"/v1/connector"},{srcPath:"/_api/cloud-data/v1/wix-data",destPath:"/v1/wix-data"}],"cloud-data.wix-code.com":[{srcPath:"",destPath:""}],_:[{srcPath:"/_api/cloud-data",destPath:""}],"www._base_domain_":[{srcPath:"/_api/cloud-data",destPath:""},{srcPath:"/_api/data",destPath:""}],"dev._base_domain_":[{srcPath:"/_api/cloud-data",destPath:""}],"bo._base_domain_":[{srcPath:"/_api/cloud-data/v1",destPath:"/v1"},{srcPath:"/_api/cloud-data/v2",destPath:"/v2"}],"manage._base_domain_":[{srcPath:"/_api/cloud-data",destPath:""},{srcPath:"/_api/data",destPath:""}],"editor._base_domain_":[{srcPath:"/_api/cloud-data/v1/schemas",destPath:"/v1/schemas"},{srcPath:"/_api/cloud-data/dbs/tasks",destPath:"/dbs/tasks"},{srcPath:"/_api/data/v1/schemas",destPath:"/v1/schemas"},{srcPath:"/_api/data/dbs/tasks",destPath:"/dbs/tasks"},{srcPath:"/_api/cloud-data/v1/wix-data",destPath:"/v1/wix-data"},{srcPath:"/_api/cloud-data/v1/data-settings",destPath:"/v1/data-settings"},{srcPath:"/_api/data/v2/indexes",destPath:"/v2/indexes"},{srcPath:"/_api/cloud-data/v1/external-database-connections",destPath:"/v1/external-database-connections"},{srcPath:"/_api/data/v1/data-collection-sharing",destPath:"/v1/data-collection-sharing"},{srcPath:"/_api/cloud-data/v2/collections",destPath:"/v2/collections"},{srcPath:"/_api/cloud-data/v2/bulk",destPath:"/v2/bulk"}],"blocks._base_domain_":[{srcPath:"/_api/cloud-data/v1/schemas",destPath:"/v1/schemas"},{srcPath:"/_api/cloud-data/dbs/tasks",destPath:"/dbs/tasks"},{srcPath:"/_api/data/v1/schemas",destPath:"/v1/schemas"},{srcPath:"/_api/data/dbs/tasks",destPath:"/dbs/tasks"},{srcPath:"/_api/cloud-data/v1/wix-data",destPath:"/v1/wix-data"},{srcPath:"/_api/cloud-data/v1/data-settings",destPath:"/v1/data-settings"},{srcPath:"/_api/data/v2/indexes",destPath:"/v2/indexes"},{srcPath:"/_api/cloud-data/v1/external-database-connections",destPath:"/v1/external-database-connections"},{srcPath:"/_api/data/v1/data-collection-sharing",destPath:"/v1/data-collection-sharing"},{srcPath:"/_api/cloud-data/v2/collections",destPath:"/v2/collections"},{srcPath:"/_api/cloud-data/v2/bulk",destPath:"/v2/bulk"}],"create.editorx":[{srcPath:"/_api/cloud-data/v1/schemas",destPath:"/v1/schemas"},{srcPath:"/_api/cloud-data/dbs/tasks",destPath:"/dbs/tasks"},{srcPath:"/_api/data/v1/schemas",destPath:"/v1/schemas"},{srcPath:"/_api/data/dbs/tasks",destPath:"/dbs/tasks"},{srcPath:"/_api/cloud-data/v1/wix-data",destPath:"/v1/wix-data"},{srcPath:"/_api/cloud-data/v1/data-settings",destPath:"/v1/data-settings"},{srcPath:"/_api/data/v2/indexes",destPath:"/v2/indexes"},{srcPath:"/_api/cloud-data/v1/external-database-connections",destPath:"/v1/external-database-connections"},{srcPath:"/_api/data/v1/data-collection-sharing",destPath:"/v1/data-collection-sharing"},{srcPath:"/_api/cloud-data/v2/collections",destPath:"/v2/collections"},{srcPath:"/_api/cloud-data/v2/bulk",destPath:"/v2/bulk"}],"www.wixapis.com":[{srcPath:"/wix-data/v1/collections",destPath:"/v1/wix-data/collections"},{srcPath:"/wix-data/v1/external-database-connections",destPath:"/v1/external-database-connections"},{srcPath:"/wix-data/v2/indexes",destPath:"/v2/indexes"},{srcPath:"/wix-data/v1/items",destPath:"/v1/items"},{srcPath:"/wix-data/v1/bulk",destPath:"/v1/bulk"},{srcPath:"/wix-data/v1/external-databases",destPath:"/v1/external-databases"},{srcPath:"/wix-data/v2",destPath:"/v2"}],"www.wixgateway.com":[{srcPath:"/wix-data/v1/items",destPath:"/v1/items"},{srcPath:"/wix-data/v1/bulk",destPath:"/v1/bulk"}]}}))}var Tp=function(){return Tp=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Tp.apply(this,arguments)},Sp=function(){function e(e,t,r){this.httpClient=e,this.signedInstance=t,this.baseUrl=function(e){var t=null==e?void 0:e.baseUrl;if(!t)return"https://cloud-data.wix-code.com";return t=wp(t,"/"),t=wp(t,"/v1/schemas")}(r)}return e.prototype._call=function(e){var t=this;return this.httpClient.request((function(r){var n=e(r),o=t.baseUrl+function(e,t){return e.startsWith(t)?e.substring(t.length):e}(n.url,"/_api/cloud-data");return Tp(Tp({},n),{url:o,headers:Tp(Tp({},n.headers),{authorization:t.signedInstance})})}),{signedInstance:this.signedInstance}).then((function(e){return e.data}))},e.prototype.create=function(e){return this._call(function(e){var t=tp(ap,{_array:rp,_dataCollection:sp,_field:dp,_numberRange:mp,_object:gp,_objectField:yp,_typeMetadata:vp}),r=t.toJSON,n=t.fromJSON,o=tp(ip,{_array:rp,_dataCollection:sp,_field:dp,_numberRange:mp,_object:gp,_objectField:yp,_typeMetadata:vp}).fromJSON;function a(t){var n=t.host,a=r(e);return{entityFqdn:"wix.data.v2.data_collection",method:"POST",methodFqn:"com.wixpress.cloud.data.api.collectionservice.DataCollectionService.CreateDataCollection",url:Ep({protoPath:"/v2/collections",data:a,host:n}),data:a,transformResponse:o}}return a.fromReq=n,a.__isAmbassador=!0,a}(e))},e.prototype.delete=function(e){return this._call(function(e){var t=tp(cp,{}),r=t.toJSON,n=t.fromJSON,o=tp(lp,{}).fromJSON;function a(t){var n=t.host,a=r(e);return{entityFqdn:"wix.data.v2.data_collection",method:"DELETE",methodFqn:"com.wixpress.cloud.data.api.collectionservice.DataCollectionService.DeleteDataCollection",url:Ep({protoPath:"/v2/collections/{dataCollectionId}",data:a,host:n}),params:Hu(a),transformResponse:o}}return a.fromReq=n,a.__isAmbassador=!0,a}(e))},e.prototype.get=function(e){return this._call(function(e){var t=tp(up,{}),r=t.toJSON,n=t.fromJSON,o=tp(pp,{_array:rp,_dataCollection:sp,_field:dp,_numberRange:mp,_object:gp,_objectField:yp,_typeMetadata:vp}).fromJSON;function a(t){var n=t.host,a=r(e);return{entityFqdn:"wix.data.v2.data_collection",method:"GET",methodFqn:"com.wixpress.cloud.data.api.collectionservice.DataCollectionService.GetDataCollection",url:Ep({protoPath:"/v2/collections/{dataCollectionId}",data:a,host:n}),params:Hu(a),transformResponse:o}}return a.fromReq=n,a.__isAmbassador=!0,a}(e))},e.prototype.getBulk=function(e){return this._call(function(e){var t=tp(np,{}),r=t.toJSON,n=t.fromJSON,o=tp(op,{_array:rp,_dataCollection:sp,_field:dp,_numberRange:mp,_object:gp,_objectField:yp,_typeMetadata:vp}).fromJSON;function a(t){var n=t.host,a=r(e);return{entityFqdn:"wix.data.v2.data_collection",method:"POST",methodFqn:"com.wixpress.cloud.data.api.collectionservice.DataCollectionService.BulkGetDataCollections",url:Ep({protoPath:"/v2/bulk/collections/get",data:a,host:n}),data:a,transformResponse:o}}return a.fromReq=n,a.__isAmbassador=!0,a}(e))},e.prototype.list=function(e){return this._call(function(e){var t=tp(fp,{}),r=t.toJSON,n=t.fromJSON,o=tp(hp,{_array:rp,_dataCollection:sp,_field:dp,_numberRange:mp,_object:gp,_objectField:yp,_typeMetadata:vp}).fromJSON;function a(t){var n=t.host,a=r(e);return{entityFqdn:"wix.data.v2.data_collection",method:"GET",methodFqn:"com.wixpress.cloud.data.api.collectionservice.DataCollectionService.ListDataCollections",url:Ep({protoPath:"/v2/collections",data:a,host:n}),params:Hu(a),transformResponse:o}}return a.fromReq=n,a.__isAmbassador=!0,a}(e))},e.prototype.update=function(e){return this._call(function(e){var t=tp(_p,{_array:rp,_dataCollection:sp,_field:dp,_numberRange:mp,_object:gp,_objectField:yp,_typeMetadata:vp}),r=t.toJSON,n=t.fromJSON,o=tp(Ip,{_array:rp,_dataCollection:sp,_field:dp,_numberRange:mp,_object:gp,_objectField:yp,_typeMetadata:vp}).fromJSON;function a(t){var n=t.host,a=r(e);return{entityFqdn:"wix.data.v2.data_collection",method:"PUT",methodFqn:"com.wixpress.cloud.data.api.collectionservice.DataCollectionService.UpdateDataCollection",url:Ep({protoPath:"/v2/collections",data:a,host:n}),data:a,transformResponse:o}}return a.fromReq=n,a.__isAmbassador=!0,a}(e))},e}();const Rp=Sp;function wp(e,t){return e.endsWith(t)?e.substring(0,e.length-t.length):e}var Op=a(4126),bp=function(e){return"object"==typeof e&&e.message?e.message:"string"==typeof e?e:JSON.stringify(e)},Cp=function(e){return e.reduce((function(e,t){var r;return Object.assign({},e,((r={})[t.id]=t,r))}),{})},Pp=function(e,t){return e.endsWith(t)?e.substring(0,e.length-t.length):e},Np=function(){function e(e,t,r,n){var o=this,a=function(e){return e=Pp(e,"/"),Pp(e,"/v1/schemas")}(n&&n.baseUrl||"https://cloud-data.wix-code.com");this.signedInstance=t,this.gridAppId=r,this.mutate=function(t,r,n){return e[t](a+r,n,o._setHeaders()).then((function(e){return e.data})).catch(o._handleError)},this.retrieve=function(t){return e.get(a+t,o._setHeaders()).then((function(e){return e.data})).catch(o._handleError)}}return e.prototype.wrapWithDefaultOptions=function(e){return Object.assign({},e,{appId:this.gridAppId})},e.prototype.formRequestUrl=function(e){return"/v1/schemas?"+Op.Pz(e)},e.prototype.get=function(e,t){void 0===t&&(t={includeDeletedCollections:!1});var r=this.wrapWithDefaultOptions({includeDeleted:!0,schemaIds:e});return this.retrieve(this.formRequestUrl(r)).then((function(r){var n=r.schemas[0];return n&&n.isDeleted&&!t.includeDeletedCollections?Td(e):n||Promise.reject(md(e))}))},e.prototype.bulkGet=function(e,t){void 0===t&&(t={includeDeletedCollections:!1,referencedCollectionsDepth:0});var r=this.wrapWithDefaultOptions({depth:t.referencedCollectionsDepth||0,includeDeleted:t.includeDeletedCollections||!1,schemaIds:e});return this.retrieve(this.formRequestUrl(r)).then((function(e){var t=e.schemas;return Cp(t)}))},e.prototype.list=function(e){void 0===e&&(e={includeDeletedCollections:!1});var t=this.wrapWithDefaultOptions({schemaIds:[],depth:0,includeDeleted:e.includeDeletedCollections||!1});return this.retrieve(this.formRequestUrl(t)).then((function(e){var t=e.schemas;return Cp(t)}))},e.prototype.save=function(e,t){var r=this.wrapWithDefaultOptions({schemaId:e,schema:t});return this.mutate("post","/v1/schemas",r).then((function(e){return e.schemas}))},e.prototype.setIsDeletedFlag=function(e,t){var r=this.wrapWithDefaultOptions({schemaId:e,partialSchema:{isDeleted:t}});return this.mutate("patch","/v1/schemas",r).then((function(e){return e.schemas}))},e.prototype.remove=function(e){return this.setIsDeletedFlag(e,!0)},e.prototype.restore=function(e){return this.setIsDeletedFlag(e,!1)},e.prototype._setHeaders=function(){return{headers:{authorization:this.signedInstance}}},e.prototype._handleError=function(e){if(!e.response)return Promise.reject(new Gd(bp(e)));var t=e.response,r=t.headers&&t.headers["x-wix-request-id"];return Promise.reject(new jd(t.status,t.data,bp(t.data),r))},e}();const Dp=Np;var Ap=function(e,t,r,n){return new(r||(r=Promise))((function(o,a){function i(e){try{c(n.next(e))}catch(e){a(e)}}function s(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,s)}c((n=n.apply(e,t||[])).next())}))},xp=function(e,t){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Lp=function(){function e(e,t,r,n){(null==n?void 0:n.client)?this._client=n.client:(null==n?void 0:n.useApiV2)?this._client=new Du(new Rp(e,t,n)):this._client=new Dp(e,t,r,n)}return e.prototype.get=function(e,t){var r=this;return this._client.get(e,t).then((function(e){return r._mapDefaults(e)}))},e.prototype.bulkGet=function(e,t){return Ap(this,void 0,void 0,(function(){var r=this;return xp(this,(function(n){return e&&0!==e.length?[2,this._client.bulkGet(e,t).then((function(e){return r._mapDefaultsForSchemas(e)}))]:[2,{}]}))}))},e.prototype.list=function(e){var t=this;return this._client.list(e).then((function(e){return t._mapDefaultsForSchemas(e)}))},e.prototype.save=function(e,t){return this._client.save(e,t)},e.prototype.remove=function(e){return this._client.remove(e)},e.prototype.restore=function(e){return this._client.restore(e)},e.prototype._mapDefaultsForSchemas=function(e){var t=this;return Object.keys(e).reduce((function(r,n){var o=e[n];return r[n]=t._mapDefaults(o),r}),{})},e.prototype._mapDefaults=function(e){var t,r;e.displayField||(e.fields&&e.fields.title?e.displayField="title":e.displayField="_id");for(var n=0,o=Object.values(e.fields);n<o.length;n++){var a=o[n];(null===(r=null===(t=a.plugins)||void 0===t?void 0:t.cms)||void 0===r?void 0:r.internal)&&(a.systemField=!0,a.sortable=!1,a.queryOperators=[])}return e},e}();const Fp=Lp;var Mp=function(e,t,r,n){return new Fp(e,t,r,n)},Up=a(4070),kp=a.n(Up);const Gp="v1",jp=2,Bp=1920,Vp=1920,Wp=1e3,qp=1e3,Hp={SCALE_TO_FILL:"fill",SCALE_TO_FIT:"fit",STRETCH:"stretch",ORIGINAL_SIZE:"original_size",TILE:"tile",TILE_HORIZONTAL:"tile_horizontal",TILE_VERTICAL:"tile_vertical",FIT_AND_TILE:"fit_and_tile",LEGACY_STRIP_TILE:"legacy_strip_tile",LEGACY_STRIP_TILE_HORIZONTAL:"legacy_strip_tile_horizontal",LEGACY_STRIP_TILE_VERTICAL:"legacy_strip_tile_vertical",LEGACY_STRIP_SCALE_TO_FILL:"legacy_strip_fill",LEGACY_STRIP_SCALE_TO_FIT:"legacy_strip_fit",LEGACY_STRIP_FIT_AND_TILE:"legacy_strip_fit_and_tile",LEGACY_STRIP_ORIGINAL_SIZE:"legacy_strip_original_size",LEGACY_ORIGINAL_SIZE:"actual_size",LEGACY_FIT_WIDTH:"fitWidth",LEGACY_FIT_HEIGHT:"fitHeight",LEGACY_FULL:"full",LEGACY_BG_FIT_AND_TILE:"legacy_tile",LEGACY_BG_FIT_AND_TILE_HORIZONTAL:"legacy_tile_horizontal",LEGACY_BG_FIT_AND_TILE_VERTICAL:"legacy_tile_vertical",LEGACY_BG_NORMAL:"legacy_normal"},$p={FIT:"fit",FILL:"fill",FILL_FOCAL:"fill_focal",CROP:"crop",LEGACY_CROP:"legacy_crop",LEGACY_FILL:"legacy_fill"},zp={CENTER:"center",TOP:"top",TOP_LEFT:"top_left",TOP_RIGHT:"top_right",BOTTOM:"bottom",BOTTOM_LEFT:"bottom_left",BOTTOM_RIGHT:"bottom_right",LEFT:"left",RIGHT:"right"},Yp={[zp.CENTER]:{x:.5,y:.5},[zp.TOP_LEFT]:{x:0,y:0},[zp.TOP_RIGHT]:{x:1,y:0},[zp.TOP]:{x:.5,y:0},[zp.BOTTOM_LEFT]:{x:0,y:1},[zp.BOTTOM_RIGHT]:{x:1,y:1},[zp.BOTTOM]:{x:.5,y:1},[zp.RIGHT]:{x:1,y:.5},[zp.LEFT]:{x:0,y:.5}},Xp={center:"c",top:"t",top_left:"tl",top_right:"tr",bottom:"b",bottom_left:"bl",bottom_right:"br",left:"l",right:"r"},Jp="img",Kp={AUTO:"auto",CLASSIC:"classic",SUPER:"super"},Qp={classic:1,super:2},Zp={radius:"0.66",amount:"1.00",threshold:"0.01"},ef=25e6,tf=[1.5,2,4],rf={HIGH:{size:196e4,quality:90,maxUpscale:1},MEDIUM:{size:36e4,quality:85,maxUpscale:1},LOW:{size:16e4,quality:80,maxUpscale:1.2},TINY:{size:0,quality:80,maxUpscale:1.4}},nf={HIGH:"HIGH",MEDIUM:"MEDIUM",LOW:"LOW",TINY:"TINY"},of={CONTRAST:"contrast",BRIGHTNESS:"brightness",SATURATION:"saturation",HUE:"hue",BLUR:"blur"},af={JPG:"jpg",JPEG:"jpeg",JPE:"jpe",PNG:"png",WEBP:"webp",WIX_ICO_MP:"wix_ico_mp",WIX_MP:"wix_mp",GIF:"gif",SVG:"svg",UNRECOGNIZED:"unrecognized"},sf=(af.JPG,af.JPEG,af.JPE,af.PNG,af.GIF,af.WEBP,{isMobile:!1}),cf=function(e){return sf[e]};function lf(){if("undefined"!=typeof window&&"undefined"!=typeof navigator){const t=window.matchMedia&&window.matchMedia("(max-width: 767px)").matches,r=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);e=t&&r,sf["isMobile"]=e}var e}function df(e,...t){return function(...r){const n=r[r.length-1]||{},o=[e[0]];return t.forEach((function(t,a){const i=Number.isInteger(t)?r[t]:n[t];o.push(i,e[a+1])})),o.join("")}}function uf(e){return e[e.length-1]}const pf=[af.PNG,af.JPEG,af.JPG,af.JPE,af.WIX_ICO_MP,af.WIX_MP,af.WEBP],ff=[af.JPEG,af.JPG,af.JPE];function hf(e,t,r){return!function(e,t,r=!1){return mf(e)&&(t||!r)}(e,t,r)&&function(e){return pf.includes(If(e))}(e)&&!function(e){return/(^https?)|(^data)|(^\/\/)/.test(e)}(e)}function mf(e){return If(e)===af.WEBP}const gf=["/","\\","?","<",">","|","\u201c",":",'"'].map(encodeURIComponent),yf=["\\.","\\*"],vf="_";function _f(e){return function(e){return ff.includes(If(e))}(e)?af.JPG:function(e){return If(e)===af.PNG}(e)?af.PNG:mf(e)?af.WEBP:af.UNRECOGNIZED}function If(e){return(/[.]([^.]+)$/.exec(e)&&/[.]([^.]+)$/.exec(e)[1]||"").toLowerCase()}function Ef(e,t,r,n,o){let a;return a=o===$p.FILL?function(e,t,r,n){return Math.max(r/e,n/t)}(e,t,r,n):o===$p.FIT?function(e,t,r,n){return Math.min(r/e,n/t)}(e,t,r,n):1,a}function Tf(e,t,r,n,o,a){e=e||n.width,t=t||n.height;const{scaleFactor:i,width:s,height:c}=function(e,t,r,n,o){let a,i=r,s=n;if(a=Ef(e,t,r,n,o),o===$p.FIT&&(i=e*a,s=t*a),i&&s&&i*s>ef){const r=Math.sqrt(ef/(i*s));i*=r,s*=r,a=Ef(e,t,i,s,o)}return{scaleFactor:a,width:i,height:s}}(e,t,n.width*o,n.height*o,r);return function(e,t,r,n,o,a,i){const{optimizedScaleFactor:s,upscaleMethodValue:c,forceUSM:l}=function(e,t,r,n){if("auto"===n)return function(e,t){const r=Of(e,t);return{optimizedScaleFactor:rf[r].maxUpscale,upscaleMethodValue:Qp.classic,forceUSM:!1}}(e,t);if("super"===n)return function(e){return{optimizedScaleFactor:uf(tf),upscaleMethodValue:Qp.super,forceUSM:!(tf.includes(e)||e>uf(tf))}}(r);return function(e,t){const r=Of(e,t);return{optimizedScaleFactor:rf[r].maxUpscale,upscaleMethodValue:Qp.classic,forceUSM:!1}}(e,t)}(e,t,a,o);let d=r,u=n;if(a<=s)return{width:d,height:u,scaleFactor:a,upscaleMethodValue:c,forceUSM:l,cssUpscaleNeeded:!1};switch(i){case $p.FILL:d=r*(s/a),u=n*(s/a);break;case $p.FIT:d=e*s,u=t*s}return{width:d,height:u,scaleFactor:s,upscaleMethodValue:c,forceUSM:l,cssUpscaleNeeded:!0}}(e,t,s,c,a,i,r)}function Sf(e,t,r,n){const o=wf(r)||function(e=zp.CENTER){return Yp[e]}(n);return{x:Math.max(0,Math.min(e.width-t.width,o.x*e.width-t.width/2)),y:Math.max(0,Math.min(e.height-t.height,o.y*e.height-t.height/2)),width:Math.min(e.width,t.width),height:Math.min(e.height,t.height)}}function Rf(e){return e.alignment&&Xp[e.alignment]||Xp[zp.CENTER]}function wf(e){let t;return!e||"number"!=typeof e.x||isNaN(e.x)||"number"!=typeof e.y||isNaN(e.y)||(t={x:bf(Math.max(0,Math.min(100,e.x))/100,2),y:bf(Math.max(0,Math.min(100,e.y))/100,2)}),t}function Of(e,t){const r=e*t;return r>rf[nf.HIGH].size?nf.HIGH:r>rf[nf.MEDIUM].size?nf.MEDIUM:r>rf[nf.LOW].size?nf.LOW:nf.TINY}function bf(e,t){const r=Math.pow(10,t||0);return(e*r/r).toFixed(t)}function Cf(e){return e&&e.upscaleMethod&&Kp[e.upscaleMethod.toUpperCase()]||Kp.AUTO}zp.CENTER,zp.TOP,zp.TOP_LEFT,zp.TOP_RIGHT,zp.BOTTOM,zp.BOTTOM_LEFT,zp.BOTTOM_RIGHT,zp.LEFT,zp.RIGHT;function Pf(e,t,r){let n;switch(t.crop&&(n=function(e,t){const r=Math.max(0,Math.min(e.width,t.x+t.width)-Math.max(0,t.x)),n=Math.max(0,Math.min(e.height,t.y+t.height)-Math.max(0,t.y));return r&&n&&(e.width!==r||e.height!==n)?{x:Math.max(0,t.x),y:Math.max(0,t.y),width:r,height:n}:null}(t,t.crop),n&&(e.src.width=n.width,e.src.height=n.height,e.src.isCropped=!0,e.parts.push(Df(n)))),e.fittingType){case Hp.SCALE_TO_FIT:case Hp.LEGACY_FIT_WIDTH:case Hp.LEGACY_FIT_HEIGHT:case Hp.LEGACY_FULL:case Hp.FIT_AND_TILE:case Hp.LEGACY_BG_FIT_AND_TILE:case Hp.LEGACY_BG_FIT_AND_TILE_HORIZONTAL:case Hp.LEGACY_BG_FIT_AND_TILE_VERTICAL:case Hp.LEGACY_BG_NORMAL:e.parts.push(Nf(e,r));break;case Hp.SCALE_TO_FILL:e.parts.push(function(e,t){const r=Tf(e.src.width,e.src.height,$p.FILL,t,e.devicePixelRatio,e.upscaleMethod),n=wf(e.focalPoint);return{transformType:n?$p.FILL_FOCAL:$p.FILL,width:Math.round(r.width),height:Math.round(r.height),alignment:Rf(t),focalPointX:n&&n.x,focalPointY:n&&n.y,upscale:r.scaleFactor>1,forceUSM:r.forceUSM,scaleFactor:r.scaleFactor,cssUpscaleNeeded:r.cssUpscaleNeeded,upscaleMethodValue:r.upscaleMethodValue}}(e,r));break;case Hp.STRETCH:e.parts.push(function(e,t){const r=Ef(e.src.width,e.src.height,t.width,t.height,$p.FILL),n=Object.assign({},t);return n.width=e.src.width*r,n.height=e.src.height*r,Nf(e,n)}(e,r));break;case Hp.TILE_HORIZONTAL:case Hp.TILE_VERTICAL:case Hp.TILE:case Hp.LEGACY_ORIGINAL_SIZE:case Hp.ORIGINAL_SIZE:n=Sf(e.src,r,e.focalPoint,r.alignment),e.src.isCropped?(Object.assign(e.parts[0],n),e.src.width=n.width,e.src.height=n.height):e.parts.push(Df(n));break;case Hp.LEGACY_STRIP_TILE_HORIZONTAL:case Hp.LEGACY_STRIP_TILE_VERTICAL:case Hp.LEGACY_STRIP_TILE:case Hp.LEGACY_STRIP_ORIGINAL_SIZE:e.parts.push(function(e){return{transformType:$p.LEGACY_CROP,width:Math.round(e.width),height:Math.round(e.height),alignment:Rf(e),upscale:!1,forceUSM:!1,scaleFactor:1,cssUpscaleNeeded:!1}}(r));break;case Hp.LEGACY_STRIP_SCALE_TO_FIT:case Hp.LEGACY_STRIP_FIT_AND_TILE:e.parts.push(function(e){return{transformType:$p.FIT,width:Math.round(e.width),height:Math.round(e.height),upscale:!1,forceUSM:!0,scaleFactor:1,cssUpscaleNeeded:!1}}(r));break;case Hp.LEGACY_STRIP_SCALE_TO_FILL:e.parts.push(function(e){return{transformType:$p.LEGACY_FILL,width:Math.round(e.width),height:Math.round(e.height),alignment:Rf(e),upscale:!1,forceUSM:!0,scaleFactor:1,cssUpscaleNeeded:!1}}(r))}}function Nf(e,t){const r=Tf(e.src.width,e.src.height,$p.FIT,t,e.devicePixelRatio,e.upscaleMethod);return{transformType:!e.src.width||!e.src.height?$p.FIT:$p.FILL,width:Math.round(r.width),height:Math.round(r.height),alignment:Xp.center,upscale:r.scaleFactor>1,forceUSM:r.forceUSM,scaleFactor:r.scaleFactor,cssUpscaleNeeded:r.cssUpscaleNeeded,upscaleMethodValue:r.upscaleMethodValue}}function Df(e){return{transformType:$p.CROP,x:Math.round(e.x),y:Math.round(e.y),width:Math.round(e.width),height:Math.round(e.height),upscale:!1,forceUSM:!1,scaleFactor:1,cssUpscaleNeeded:!1}}function Af(e,t){var r;t=t||{},e.quality=function(e,t){const r=e.fileType===af.PNG,n=e.fileType===af.JPG,o=e.fileType===af.WEBP,a=n||r||o;if(a){const n=uf(e.parts),o=(i=n.width,s=n.height,rf[Of(i,s)].quality);let a=t.quality&&t.quality>=5&&t.quality<=90?t.quality:o;return a=r?a+5:a,a}var i,s;return 0}(e,t),e.progressive=function(e){return!1!==e.progressive}(t),e.watermark=function(e){return e.watermark}(t),e.autoEncode=null===(r=t.autoEncode)||void 0===r||r,e.unsharpMask=function(e,t){var r,n,o;if(function(e){const t="number"==typeof(e=e||{}).radius&&!isNaN(e.radius)&&e.radius>=.1&&e.radius<=500,r="number"==typeof e.amount&&!isNaN(e.amount)&&e.amount>=0&&e.amount<=10,n="number"==typeof e.threshold&&!isNaN(e.threshold)&&e.threshold>=0&&e.threshold<=255;return t&&r&&n}(t.unsharpMask))return{radius:bf(null===(r=t.unsharpMask)||void 0===r?void 0:r.radius,2),amount:bf(null===(n=t.unsharpMask)||void 0===n?void 0:n.amount,2),threshold:bf(null===(o=t.unsharpMask)||void 0===o?void 0:o.threshold,2)};if(("number"!=typeof(a=(a=t.unsharpMask)||{}).radius||isNaN(a.radius)||0!==a.radius||"number"!=typeof a.amount||isNaN(a.amount)||0!==a.amount||"number"!=typeof a.threshold||isNaN(a.threshold)||0!==a.threshold)&&function(e){const t=uf(e.parts);return!(t.scaleFactor>=1)||t.forceUSM||t.transformType===$p.FIT}(e))return Zp;var a;return}(e,t),e.filters=function(e){const t=e.filters||{},r={};xf(t[of.CONTRAST],-100,100)&&(r[of.CONTRAST]=t[of.CONTRAST]);xf(t[of.BRIGHTNESS],-100,100)&&(r[of.BRIGHTNESS]=t[of.BRIGHTNESS]);xf(t[of.SATURATION],-100,100)&&(r[of.SATURATION]=t[of.SATURATION]);xf(t[of.HUE],-180,180)&&(r[of.HUE]=t[of.HUE]);xf(t[of.BLUR],0,100)&&(r[of.BLUR]=t[of.BLUR]);return r}(t)}function xf(e,t,r){return"number"==typeof e&&!isNaN(e)&&0!==e&&e>=t&&e<=r}function Lf(e,t,r,n){const o=function(e){var t;return null!==(t=null==e?void 0:e.isSEOBot)&&void 0!==t&&t}(n),a=_f(t.id),i=function(e,t){const r=/\.([^.]*)$/,n=new RegExp(`(${gf.concat(yf).join("|")})`,"g");if(t&&t.length){let e=t;const o=t.match(r);return o&&pf.includes(o[1])&&(e=t.replace(r,"")),encodeURIComponent(e).replace(n,vf)}const o=e.match(/\/(.*?)$/);return(o?o[1]:e).replace(r,"")}(t.id,t.name),s=o?1:function(e){return Math.min(e.pixelAspectRatio||1,jp)}(r),c=If(t.id),l=c,d=hf(t.id,null==n?void 0:n.hasAnimation,null==n?void 0:n.allowWEBPTransform),u={fileName:i,fileExtension:c,fileType:a,fittingType:e,preferredExtension:l,src:{id:t.id,width:t.width,height:t.height,isCropped:!1},focalPoint:{x:t.focalPoint&&t.focalPoint.x,y:t.focalPoint&&t.focalPoint.y},parts:[],devicePixelRatio:s,quality:0,upscaleMethod:Cf(n),progressive:!0,watermark:"",unsharpMask:{},filters:{},transformed:d};return mf(t.id)&&(u.focalPoint={x:void 0,y:void 0},null==t||delete t.crop),d&&(Pf(u,t,r),Af(u,n)),u}function Ff(e,t,r){const n=Object.assign({},r),o=cf("isMobile");switch(e){case Hp.LEGACY_BG_FIT_AND_TILE:case Hp.LEGACY_BG_FIT_AND_TILE_HORIZONTAL:case Hp.LEGACY_BG_FIT_AND_TILE_VERTICAL:case Hp.LEGACY_BG_NORMAL:const e=o?Wp:Bp,r=o?qp:Vp;n.width=Math.min(e,t.width),n.height=Math.min(r,Math.round(n.width/(t.width/t.height))),n.pixelAspectRatio=1}return n}const Mf=df`fit/w_${"width"},h_${"height"}`,Uf=df`fill/w_${"width"},h_${"height"},al_${"alignment"}`,kf=df`fill/w_${"width"},h_${"height"},fp_${"focalPointX"}_${"focalPointY"}`,Gf=df`crop/x_${"x"},y_${"y"},w_${"width"},h_${"height"}`,jf=df`crop/w_${"width"},h_${"height"},al_${"alignment"}`,Bf=df`fill/w_${"width"},h_${"height"},al_${"alignment"}`,Vf=df`,lg_${"upscaleMethodValue"}`,Wf=df`,q_${"quality"}`,qf=df`,usm_${"radius"}_${"amount"}_${"threshold"}`,Hf=df`,bl`,$f=df`,wm_${"watermark"}`,zf={[of.CONTRAST]:df`,con_${"contrast"}`,[of.BRIGHTNESS]:df`,br_${"brightness"}`,[of.SATURATION]:df`,sat_${"saturation"}`,[of.HUE]:df`,hue_${"hue"}`,[of.BLUR]:df`,blur_${"blur"}`},Yf=df`,enc_auto`;function Xf(e,t,r,n={},o){return hf(t.id,null==n?void 0:n.hasAnimation,null==n?void 0:n.allowWEBPTransform)?function(e){const t=[];e.parts.forEach((e=>{switch(e.transformType){case $p.CROP:t.push(Gf(e));break;case $p.LEGACY_CROP:t.push(jf(e));break;case $p.LEGACY_FILL:let r=Bf(e);e.upscale&&(r+=Vf(e)),t.push(r);break;case $p.FIT:let n=Mf(e);e.upscale&&(n+=Vf(e)),t.push(n);break;case $p.FILL:let o=Uf(e);e.upscale&&(o+=Vf(e)),t.push(o);break;case $p.FILL_FOCAL:let a=kf(e);e.upscale&&(a+=Vf(e)),t.push(a)}}));let r=t.join("/");return e.quality&&(r+=Wf(e)),e.unsharpMask&&(r+=qf(e.unsharpMask)),e.progressive||(r+=Hf(e)),e.watermark&&(r+=$f(e)),e.filters&&(r+=Object.keys(e.filters).map((t=>zf[t](e.filters))).join("")),e.autoEncode&&e.fileType!==af.GIF&&(r+=Yf(e)),`${e.src.id}/${Gp}/${r}/${e.fileName}.${e.preferredExtension}`}(o=o||Lf(e,t,r,n)):t.id}const Jf={[zp.CENTER]:"50% 50%",[zp.TOP_LEFT]:"0% 0%",[zp.TOP_RIGHT]:"100% 0%",[zp.TOP]:"50% 0%",[zp.BOTTOM_LEFT]:"0% 100%",[zp.BOTTOM_RIGHT]:"100% 100%",[zp.BOTTOM]:"50% 100%",[zp.RIGHT]:"100% 50%",[zp.LEFT]:"0% 50%"};Object.entries(Jf).reduce(((e,[t,r])=>(e[r]=t,e)),{}),Hp.TILE,Hp.TILE_HORIZONTAL,Hp.TILE_VERTICAL,Hp.LEGACY_BG_FIT_AND_TILE,Hp.LEGACY_BG_FIT_AND_TILE_HORIZONTAL,Hp.LEGACY_BG_FIT_AND_TILE_VERTICAL,Hp.LEGACY_ORIGINAL_SIZE,Hp.ORIGINAL_SIZE,Hp.LEGACY_BG_NORMAL;function Kf(e,t,r,n){if(function(e,t,r){return r&&t&&!function(e){return!e||!e.trim()||"none"===e.toLowerCase()}(t.id)&&Object.values(Hp).includes(e)}(e,t,r)){const o=Ff(e,t,r);return{uri:Xf(e,t,o,n||{},Lf(e,t,o,n))}}return{uri:""}}const Qf=/^media\//i,Zf="undefined"!=typeof window?window.devicePixelRatio:1,eh=(e,t)=>{const r=t&&t.baseHostURL;return r?`${r}${e}`:(e=>Qf.test(e)?`https://static.wixstatic.com/${e}`:`https://static.wixstatic.com/media/${e}`)(e)};lf(),lf();const th={getScaleToFitImageURL:function(e,t,r,n,o,a){const i=Kf(Hp.SCALE_TO_FIT,{id:e,width:t,height:r,name:a&&a.name},{width:n,height:o,htmlTag:Jp,alignment:zp.CENTER,pixelAspectRatio:Zf},a);return eh(i.uri,a)},getScaleToFillImageURL:function(e,t,r,n,o,a){const i=Kf(Hp.SCALE_TO_FILL,{id:e,width:t,height:r,name:a&&a.name,focalPoint:{x:a&&a.focalPoint&&a.focalPoint.x,y:a&&a.focalPoint&&a.focalPoint.y}},{width:n,height:o,htmlTag:Jp,alignment:zp.CENTER,pixelAspectRatio:Zf},a);return eh(i.uri,a)},getCropImageURL:function(e,t,r,n,o,a,i,s,c,l){const d=Kf(Hp.SCALE_TO_FILL,{id:e,width:t,height:r,name:l&&l.name,crop:{x:n,y:o,width:a,height:i}},{width:s,height:c,htmlTag:Jp,alignment:zp.CENTER,pixelAspectRatio:Zf},l);return eh(d.uri,l)}};function rh(e,t,r){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,r)}var nh=new WeakMap,oh=new WeakMap,ah=new WeakMap,ih=new WeakMap,sh=new WeakMap,ch=new WeakMap,lh=new WeakMap;class dh{constructor(e){let{platformUtils:t,wixSdk:r,bi:n,tpaActionImplementations:o,devMode:a,verbose:i}=e;rh(this,nh,{writable:!0,value:void 0}),rh(this,oh,{writable:!0,value:void 0}),rh(this,ah,{writable:!0,value:void 0}),rh(this,ih,{writable:!0,value:void 0}),rh(this,sh,{writable:!0,value:void 0}),rh(this,ch,{writable:!0,value:void 0}),rh(this,lh,{writable:!0,value:void 0}),kp()(this,nh,this._getSettings({wixSdk:r,bi:n,devMode:a,verbose:i})),kp()(this,oh,this._getUser(r.user)),kp()(this,ah,this._getLocation(r.location,n)),kp()(this,ih,this._getUtils(t)),kp()(this,sh,this._getTimers(r)),kp()(this,ch,(async e=>{let{currentItem:t,action:n}=e;const a=o[n];await a({wixSdk:r,currentItem:t})})),kp()(this,lh,this._getSeo(r))}get settings(){return x()(this,nh)}get user(){return x()(this,oh)}get location(){return x()(this,ah)}get utils(){return x()(this,ih)}get timers(){return x()(this,sh)}get executeTpaAction(){return x()(this,ch)}get seo(){return x()(this,lh)}_getSettings(e){let{wixSdk:{window:{viewMode:t,rendering:{env:r},browserLocale:n},site:{regionalSettings:o=n}},bi:{metaSiteId:a,viewerName:i},devMode:s,verbose:c}=e;return{metaSiteId:a,locale:o,mode:{name:r,dev:s,verbose:c,ssr:"backend"===r,csr:"backend"!==r},env:{name:t,live:"Site"===t,preview:"Preview"===t,livePreview:"Editor"===t,editor:"Preview"===t||"Editor"===t,renderer:i}}}_getUser(e){return{get id(){return e.currentUser.id},get loggedIn(){return e.currentUser.loggedIn},onLogin:e.onLogin}}_getLocation(e,t){let{baseUrl:r,url:n,to:o}=e,{pageId:a}=t;return{pageId:a,pageUrl:n,baseUrl:r,navigateTo:o}}_getUtils(e){let{links:t,mediaItemUtils:r}=e;return{links:t,media:{...r,getScaleToFillImageURL:th.getScaleToFillImageURL}}}_getTimers(e){var t;return{queueMicrotask:(null==(t=e.environment)||null==(t=t.timers)?void 0:t.queueMicrotask)||queueMicrotask}}_getSeo(e){return{renderSEOTags:e.seo.renderSEOTags}}}const uh=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"\u0627\u0644\u0643\u0644"}');var ph=a.t(uh,2);const fh=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"\u0412\u0441\u0438\u0447\u043a\u0438"}');var hh=a.t(fh,2);const mh=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"Tot"}');var gh=a.t(mh,2);const yh=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"V\u0161e"}');var vh=a.t(yh,2);const _h=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"Alle"}');var Ih=a.t(_h,2);const Eh=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"Alle"}');var Th=a.t(Eh,2);const Sh=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"\u038c\u03bb\u03b1"}');var Rh=a.t(Sh,2);const wh=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"All"}');var Oh=a.t(wh,2);const bh=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"Todo"}');var Ch=a.t(bh,2);const Ph=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"Tout"}');var Nh=a.t(Ph,2);const Dh=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"\u05d4\u05db\u05dc"}');var Ah=a.t(Dh,2);const xh=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"\u0938\u092d\u0940"}');var Lh=a.t(xh,2);const Fh=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"\xd6sszes"}');var Mh=a.t(Fh,2);const Uh=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"Semua"}');var kh=a.t(Uh,2);const Gh=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"Tutti"}');var jh=a.t(Gh,2);const Bh=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"\u3059\u3079\u3066"}');var Vh=a.t(Bh,2);const Wh=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"\uc804\uccb4"}');var qh=a.t(Wh,2);const Hh=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"Viskas"}');var $h=a.t(Hh,2);const zh=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"Semua"}');var Yh=a.t(zh,2);const Xh=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"Alle"}');var Jh=a.t(Xh,2);const Kh=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"Alle"}');var Qh=a.t(Kh,2);const Zh=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"Wszystkie"}');var em=a.t(Zh,2);const tm=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"Todos"}');var rm=a.t(tm,2);const nm=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"Toate"}');var om=a.t(nm,2);const am=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"\u0412\u0441\u0435"}');var im=a.t(am,2);const sm=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"V\u0161etky"}');var cm=a.t(sm,2);const lm=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"Vse"}');var dm=a.t(lm,2);const um=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"Alla"}');var pm=a.t(um,2);const fm=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"\u0e17\u0e31\u0e49\u0e07\u0e2b\u0e21\u0e14"}');var hm=a.t(fm,2);const mm=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"Lahat"}');var gm=a.t(mm,2);const ym=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"Hepsi"}');var vm=a.t(ym,2);const _m=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"\u0423\u0441\u0456"}');var Im=a.t(_m,2);const Em=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"T\u1ea5t c\u1ea3"}');var Tm=a.t(Em,2);const Sm=JSON.parse('{"USER_INPUT_FILTER_OPTION_RESET_ALL":"\u6240\u6709"}');const Rm={ar:ph,bg:hh,ca:gh,cs:vh,da:Ih,de:Th,el:Rh,en:Oh,es:Ch,fr:Nh,he:Ah,hi:Lh,hu:Mh,id:kh,it:jh,ja:Vh,ko:qh,lt:$h,ms:Yh,nl:Jh,no:Qh,pl:em,pt:rm,ro:om,ru:im,sk:cm,sl:dm,sv:pm,th:hm,tl:gm,tr:vm,uk:Im,vi:Tm,zh:a.t(Sm,2)},wm=Rm.en,{initAppForPage:Om,createControllers:bm}=function(e){let t,r,{verbose:n=!1,wixDataSchemasForItTests:i,automationsClientCreator:s=E,tpaActionImplementations:l=o}=void 0===e?{}:e;return{initAppForPage:function(e,o,d,u){let p,{bi:f={},monitoring:{createMonitor:h},fedOpsLoggerFactory:m,biLoggerFactory:g,essentials:{httpClient:y,experiments:v,createErrorMonitor:_}}=void 0===u?{}:u;try{const u=new dh({platformUtils:o,wixSdk:d,bi:f,tpaActionImplementations:l,devMode:!1,verbose:n}),{settings:I}=u,{instance:E,appData:{gridAppId:T},url:S}=e;(e=>{try{a.p=e.substr(0,e.lastIndexOf("/")+1)}catch(e){}})(S);const{data:R,window:{warmupData:w,getRouterData:O},location:{baseUrl:b,protocol:C},site:{language:P,currentPage:N}}=d;t=O(),v.enabled("specs.wixDataClient.RouterDataToWarmupCache")&&w.set("routerData",t),p=new Po({fedops:{factory:m,hooks:{start:e=>{let{name:t}=e;return p.log(new xe({category:"interaction start",message:"interaction "+t+" started"}))},end:e=>{let{name:t,duration:r}=e;return p.log(new xe({category:"interaction end",message:"interaction "+t+" ended after "+r+" ms"}))}}},bi:{factory:g},monitor:{factory:h,createErrorMonitor:_},verbose:{factory:()=>({log:function(){var e;return((null==(e=d.telemetry)?void 0:e.console)||console).verbose(...arguments)}})},console:{factory:()=>{var e;return(null==(e=d.telemetry)?void 0:e.console)||console}},platform:u,global:self}),p.log(new Ae("databinding/initAppForPage",Ae.types.START));const D=(e=>{var t;const r=null!=(t=Rm[e])?t:wm;return{t:e=>{var t;return null!=(t=null==r?void 0:r[e])?t:e}}})(P),A=(e=>{let{experiments:t,settings:{env:r}}=e;return{get fes(){return t.enabled("specs.wixDataViewer.EnableFES")},get warmupData(){return r.live},get newCurrentPageIndex(){return t.enabled("specs.wixDataViewer.NewCurrentPageIndex")},get automationsClientV2(){return t.enabled("specs.wixDataClient.AutomationsClientV2")}}})({experiments:v,settings:I}),x=A.fes?new On({httpClient:y,getRequestParams:()=>({instance:E,gridAppId:T})}):new Qn({wixData:R,wixDataSchemas:i||Mp(y,E,T,{baseUrl:(I.env.editor?"https":C)+"://"+c()(b).hostname+"/_api/cloud-data",useApiV2:!0})}),L=new io(w),F=new so(t),M=jl({automationsClientCreator:()=>A.automationsClientV2?(e=>({reportFormEventToAutomationCreator:()=>async(t,r,n)=>{const o=t.detailedEventPayload["form-id"].value,a=Be(t.detailedEventPayload).filter((e=>"form-id"!==e)).reduce(((e,r)=>{const n=r.split(".")[1],{keyName:o,valueType:a,value:i}=t.detailedEventPayload[r];return e[n]={displayName:o,value:i,type:a},e}),{}),i={formId:o,pageId:n,submissionTime:new Date,fields:a,collectionId:r};await e.post("/_serverless/cms-automations/report-cms-form-submission",i)}}))(y):s({httpClient:y}),pageId:N.id});return r=new xl({platform:u,dataFetcher:x,warmupCache:L,staticCache:F,features:A,listenersByEvent:M,logger:p,i18n:D,global:self,loadExpressionFunctions:Ja}),p.log(new Ae("databinding/initAppForPage",Ae.types.END)),Promise.resolve()}catch(e){return p&&p.log(new w("App initialisation failed",{cause:e})),Promise.reject(e)}},createControllers:e=>{if(!e.length)return[];const n=((e,t)=>e.map((e=>{let{compId:r,config:{dataset:{collectionName:n,filter:o,sort:a,includes:i,nested:s,pageSize:c,readWriteType:l,deferred:d,cursor:u}={}}={},type:p,connections:f,livePreviewOptions:{shouldFetchData:h,compsIdsToReset:m=[]}={}}=e;const g={id:r,type:p,collectionId:n,filter:o,sort:a,pageSize:c,readWriteType:l,includes:i,nested:s,deferred:d,connections:f,dataIsInvalidated:h,updatedCompIds:m,cursor:u};return p===mr&&t?((e,t)=>{const{readWriteType:r}=e,{config:{dataset:{collectionName:n,filter:o,sort:a,includes:i,pageSize:s,lowercase:c,seoV2:l}},dynamicUrl:d,userDefinedFilter:u}=t;return{...e,collectionId:n,filter:o,sort:a,includes:i,pageSize:s,readWriteType:r,dynamicPageData:{lowercase:c,dynamicUrl:d,userDefinedFilter:u,seoV2:l}}})(g,t):g})))(e,t),o=e.reduce(((e,t)=>{let{$w:r,compId:n}=t;return e[n]=r.fireEvent,e}),{});return r.initializeDatasets({datasetConfigs:n,firePlatformEvent:e=>o[e]}).map((e=>({...e,pageReady:t=>e.pageReady(al(t))})))}}}()})(),i})()));
//# sourceMappingURL=app.js.map